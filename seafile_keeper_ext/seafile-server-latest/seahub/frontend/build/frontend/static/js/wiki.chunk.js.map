{"version":3,"sources":["components/context-menu/helpers.js","components/context-menu/globalEventListener.js","components/context-menu/context-menu.js","components/index-viewer.js","pages/wiki/side-panel.js","components/wiki-dir-list-view/wiki-dir-list-item.js","components/wiki-dir-list-view/wiki-dir-list-view.js","pages/wiki/main-panel.js","wiki.js","components/dropdown-menu/item-dropdown-menu.js","components/wiki-markdown-viewer.js","components/tree-view/tree-node-view.js","components/tree-view/tree-view.js","components/context-menu/actions.js"],"names":["callIfExists","func","_len","arguments","length","args","Array","_key","apply","hasOwnProp","obj","prop","Object","prototype","hasOwnProperty","call","uniqueId","Math","random","toString","substring","store","canUseDOM","Boolean","window","document","createElement","GlobalEventListener","_this","_classCallCheck","handleShowEvent","event","id","callbacks","show","handleHideEvent","hide","register","showCallback","hideCallback","unregister","this","addEventListener","MENU_SHOW","MENU_HIDE","ContextMenu","_React$Component","_inherits","_super","_createSuper","props","registerHandlers","handleOutsideClick","handleHide","handleKeyNavigation","unregisterHandlers","removeEventListener","handleShow","e","detail","_e$detail$position","position","x","y","_e$detail","currentObject","menuList","setState","isVisible","onShowMenu","state","onHideMenu","menu","contains","target","hideMenu","handleMouseLeave","preventDefault","hideOnLeave","handleContextMenu","keyCode","getMenuPosition","undefined","menuStyles","top","left","_window","innerWidth","innerHeight","rect","getBoundingClientRect","height","width","getRTLMenuPosition","_window2","onMenuItemClick","stopPropagation","operation","Utils","getEventData","onContextMenu","_createClass","key","value","listenId","listener","_this2","wrapper","requestAnimationFrame","setTimeout","_this2$state","_ref","rtl","style","concat","opacity","pointerEvents","_this3","_jsx","role","className","display","ref","children","map","menuItem","index","onClick","React","Component","TreeNode","name","href","parentNode","nodeList","forEach","node","setParent","IndexContentViewer","bindClickEvent","links","querySelectorAll","link","onLinkClick","removeClickEvent","currentPath","getAttribute","getLink","tagName","changeInlineNode","item","url","type","isPublicWiki","data","src","RegExp","serviceURL","repoID","test","indexOf","index2","imagePath","slug","isInternalMarkdownLink","path","getPathFromInternalMarkdownLink","isInternalDirLink","getPathFromInternalDirLink","getRootNode","deserialize","indexContent","changeMarkdownNodes","treeRoot","transSlateToTree","setNodePath","parentNodePath","child","slateNodes","parentTreeNode","treeNodes","slateNode","transParagraph","paragraphNode","treeNode","listNode","addChildren","linkNode","textNode","text","FolderItem","_React$Component2","_super2","toggleExpanded","expanded","renderLink","_ref2","title","_this4","_this5","_jsxs","Fragment","SidePanel","_Component","renderIndexView","marginTop","renderTreeView","treeData","TreeView","isNodeMenuShow","onNodeClick","onNodeCollapse","onNodeExpanded","closeSideBar","Logo","onCloseSidePanel","onCloseSide","isTreeDataLoading","Loading","indexNode","username","permission","siteRoot","gettext","WikiDirListItem","onMouseEnter","highlight","onMouseLeave","onDirentClick","dirent","_this$props","joinPath","iconUrl","getDirentIcon","isDesktop","alt","size","mtime_relative","WikiDirListView","direntList","MainPanel","onMenuClick","onEditClick","open","onMainNavBarClick","renderNavPath","paths","split","nodePath","onSearchedClick","searchPlaceholder","errMessage","isViewingFile","pathExist","isDataLoading","isViewFile","content","isPro","Search","isPublic","placeholder","Notification","Account","WikiMarkdownViewer","markdownContent","isFileLoading","lastModified","latestContributor","isWiki","moment","locale","lang","Wiki","loadSidePanel","initialPath","hasIndex","loadIndexNode","isDir","loadNodeAndParentsByPath","loadWikiData","pythonWrapper","getElementById","removePythonWrapper","fileUrl","encodePath","history","pushState","showDir","seafileAPI","listWikiDir","then","res","tree","addFirstResponseListToNode","dirent_list","root","getNodeByPath","indexPath","getWikiFileContent","catch","isLoadFailed","dirPath","loadDirentList","showFile","filePath","unix","last_modified","fromNow","latest_contributor","hash","location","replaceState","Dirent","filter","toLowerCase","sortDirents","loadTreeNodeByPath","clone","isLoaded","isExpanded","currentNode","addResponseListToNode","isMarkdownFile","getDirName","results","i","object","parent_dir","push","body","removeChild","onConentLinkClick","isWikiInternalMarkdownLink","getPathFromWikiInternalMarkdownLink","isWikiInternalDirLink","getPathFromWikiInternalDirLink","onpopstate","is_dir","slice","getPaths","treeHelper","expandNode","sharedToken","direntPath","w","collapseNode","list","buildTree","homePath","MediaQuery","query","Modal","isOpen","toggle","contentClassName","ReactDom","render","ItemDropdownMenu","isItemMenuShow","unfreezeItem","onDropdownToggleKeyDown","onDropdownToggleClick","toggleOperationMenu","freezeItem","onMenuItemKeyDown","isHandleContextMenuEvent","listenerId","getMenuList","nextProps","toggleClass","ButtonDropdown","DropdownToggle","onKeyDown","DropdownMenu","DropdownItem","divider","Dropdown","tag","tabIndex","defaultProps","contentClass","getTitlesInfo","titlesInfo","titleDom","replace","updateTabTitle","headingList","offsetTop","onScrollHandler","activeTitleIndex","contentScrollTop","markdownContainer","current","scrollTop","titlesLength","originalPath","lastIndexOf","pathNormalize","isInternalFileLink","match","p1","p2","p3","modifyValueBeforeRender","renderMarkdown","isTOCShow","MarkdownViewer","showTOC","scriptSource","mediaUrl","createRef","onScroll","bind","TreeNodeView","isItemFreezed","isShowOperationMenu","isHighlight","onMouseOver","_Utils$getUserPermiss","getUserPermission","isCustomPermission","customPermission","_customPermission$per","canPreview","preview","canModify","modify","onLoadToggle","onNodeDragStart","isIEBrower","canDrag","onNodeDragEnter","isNodeDropShow","onNodeDragMove","onNodeDragLeave","onNodeDrop","onItemMouseDown","button","onItemContextMenu","handleContextClick","getNodeTypeAndIcon","icon","suffix","calculateMenuList","NEW_FOLDER","TextTranslation","NEW_FILE","COPY","MOVE","RENAME","DELETE","OPEN_VIA_CLIENT","userPerm","_Utils$getUserPermiss2","_customPermission$per2","canCreate","create","canDelete","delete","canCopy","copy","renderChildren","paddingLeft","hasChildren","_Utils$getUserPermiss3","_this$props2","_this$getNodeTypeAndI","hlClass","onMouseDown","draggable","onDragStart","onDragEnter","onDragLeave","onDragOver","onDrop","onItemMove","repo","selectedPath","dragStartNodeData","nodeDirent","nodeParentPath","nodeRootPath","JSON","stringify","dataTransfer","effectAllowed","setData","canDrop","persist","isTreeViewDropTipShow","dropEffect","onContainerClick","files","getData","_dragStartNodeData","parse","dropNodeData","isArray","onMoveItems","currentRepoInfo","onItemsMove","includes","destRepo","destDirentPath","direntPaths","some","clientX","touches","pageX","clientY","pageY","posX","posY","showMenuConfig","showMenu","dispatchGlobalEvent","eventName","opts","CustomEvent","createEvent","initCustomEvent","dispatchEvent","assign"],"mappings":"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","file":"static/js/wiki.chunk.js","sourcesContent":["export function callIfExists(func, ...args) {\n  return (typeof func === 'function') && func(...args);\n}\n\nexport function hasOwnProp(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function uniqueId() {\n  return Math.random().toString(36).substring(7);\n}\n\nexport const store = {};\n\nexport const canUseDOM = Boolean(\n  typeof window !== 'undefined' && window.document && window.document.createElement\n);\n","import { MENU_SHOW, MENU_HIDE } from './actions';\nimport { uniqueId, hasOwnProp, canUseDOM } from './helpers';\n\nclass GlobalEventListener {\n\n  constructor() {\n    this.callbacks = {};\n\n    if (canUseDOM) {\n      window.addEventListener(MENU_SHOW, this.handleShowEvent);\n      window.addEventListener(MENU_HIDE, this.handleHideEvent);\n    }\n  }\n\n  handleShowEvent = (event) => {\n    for (const id in this.callbacks) {\n      if (hasOwnProp(this.callbacks, id)) this.callbacks[id].show(event);\n    }\n  }\n\n  handleHideEvent = (event) => {\n    for (const id in this.callbacks) {\n      if (hasOwnProp(this.callbacks, id)) this.callbacks[id].hide(event);\n    }\n  }\n\n  register = (showCallback, hideCallback) => {\n    const id = uniqueId();\n\n    this.callbacks[id] = {\n      show: showCallback,\n      hide: hideCallback\n    };\n\n    return id;\n  }\n\n  unregister = (id) => {\n    if (id && this.callbacks[id]) {\n      delete this.callbacks[id];\n    }\n  }\n}\n\nexport default new GlobalEventListener();\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport listener from './globalEventListener';\nimport { hideMenu } from './actions';\nimport { callIfExists } from './helpers';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  rtl: PropTypes.bool,\n  onMenuItemClick: PropTypes.func.isRequired,\n  onShowMenu: PropTypes.func,\n  onHideMenu: PropTypes.func,\n};\n\nclass ContextMenu extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      x: 0,\n      y: 0,\n      isVisible: false,\n      currentObject: null,\n      menuList: [],\n    };\n  }\n\n  componentDidMount() {\n    this.listenId = listener.register(this.handleShow, this.handleHide);\n  }\n\n  componentDidUpdate () {\n    if (this.state.isVisible) {\n      const wrapper = window.requestAnimationFrame || setTimeout;\n\n      wrapper(() => {\n        const { x, y } = this.state;\n        const { top, left } = this.props.rtl ? this.getRTLMenuPosition(x, y) : this.getMenuPosition(x, y);\n\n        wrapper(() => {\n          if (!this.menu) return;\n          this.menu.style.top = `${top}px`;\n          this.menu.style.left = `${left}px`;\n          this.menu.style.opacity = 1;\n          this.menu.style.pointerEvents = 'auto';\n        });\n      });\n    } else {\n      if (!this.menu) return;\n      this.menu.style.opacity = 0;\n      this.menu.style.pointerEvents = 'none';\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.listenId) {\n      listener.unregister(this.listenId);\n    }\n\n    this.unregisterHandlers();\n  }\n\n  registerHandlers = () => {\n    document.addEventListener('mousedown', this.handleOutsideClick);\n    document.addEventListener('touchstart', this.handleOutsideClick);\n    document.addEventListener('scroll', this.handleHide);\n    document.addEventListener('contextmenu', this.handleHide);\n    document.addEventListener('keydown', this.handleKeyNavigation);\n    window.addEventListener('resize', this.handleHide);\n  }\n\n  unregisterHandlers = () => {\n    document.removeEventListener('mousedown', this.handleOutsideClick);\n    document.removeEventListener('touchstart', this.handleOutsideClick);\n    document.removeEventListener('scroll', this.handleHide);\n    document.removeEventListener('contextmenu', this.handleHide);\n    document.removeEventListener('keydown', this.handleKeyNavigation);\n    window.removeEventListener('resize', this.handleHide);\n  }\n\n  handleShow = (e) => {\n    if (e.detail.id !== this.props.id) return;\n\n    const { x, y } = e.detail.position;\n    const { currentObject, menuList} = e.detail;\n\n    this.setState({ isVisible: true, x, y, currentObject, menuList });\n    this.registerHandlers();\n    callIfExists(this.props.onShowMenu, e);\n  }\n\n  handleHide = (e) => {\n    if (this.state.isVisible && (!e.detail || !e.detail.id || e.detail.id === this.props.id)) {\n      this.unregisterHandlers();\n      this.setState({ isVisible: false});\n      callIfExists(this.props.onHideMenu, e);\n    }\n  }\n\n  handleOutsideClick = (e) => {\n    if (!this.menu.contains(e.target)) hideMenu();\n  }\n\n  handleMouseLeave = (event) => {\n    event.preventDefault();\n\n    if (this.props.hideOnLeave) hideMenu();\n  }\n\n  handleContextMenu = (e) => {\n    this.handleHide(e);\n  }\n\n  handleKeyNavigation = (e) => {\n    if (this.state.isVisible === false) {\n      return;\n    }\n    e.preventDefault();\n    this.hideMenu(e);\n  }\n\n  hideMenu = (e) => {\n    if (e.keyCode === 27 || e.keyCode === 13) { // ECS or enter\n      hideMenu();\n    }\n  }\n\n  getMenuPosition = (x = 0, y = 0) => {\n    let menuStyles = {\n      top: y,\n      left: x\n    };\n\n    if (!this.menu) return menuStyles;\n\n    const { innerWidth, innerHeight } = window;\n    const rect = this.menu.getBoundingClientRect();\n\n    if (y + rect.height > innerHeight) {\n      menuStyles.top -= rect.height;\n    }\n\n    if (x + rect.width > innerWidth) {\n      menuStyles.left -= rect.width;\n    }\n\n    if (menuStyles.top < 0) {\n      menuStyles.top = rect.height < innerHeight ? (innerHeight - rect.height) / 2 : 0;\n    }\n\n    if (menuStyles.left < 0) {\n      menuStyles.left = rect.width < innerWidth ? (innerWidth - rect.width) / 2 : 0;\n    }\n\n    return menuStyles;\n  }\n\n  getRTLMenuPosition = (x = 0, y = 0) => {\n    let menuStyles = {\n      top: y,\n      left: x\n    };\n\n    if (!this.menu) return menuStyles;\n\n    const { innerWidth, innerHeight } = window;\n    const rect = this.menu.getBoundingClientRect();\n\n    // Try to position the menu on the left side of the cursor\n    menuStyles.left = x - rect.width;\n\n    if (y + rect.height > innerHeight) {\n      menuStyles.top -= rect.height;\n    }\n\n    if (menuStyles.left < 0) {\n      menuStyles.left += rect.width;\n    }\n\n    if (menuStyles.top < 0) {\n      menuStyles.top = rect.height < innerHeight ? (innerHeight - rect.height) / 2 : 0;\n    }\n\n    if (menuStyles.left + rect.width > innerWidth) {\n      menuStyles.left = rect.width < innerWidth ? (innerWidth - rect.width) / 2 : 0;\n    }\n\n    return menuStyles;\n  }\n\n\n  onMenuItemClick = (event) => {\n    event.stopPropagation();\n    let operation = Utils.getEventData(event, 'operation');\n    let currentObject = this.state.currentObject;\n    this.props.onMenuItemClick(operation, currentObject, event);\n  }\n\n  onContextMenu = (event) => {\n    event.stopPropagation();\n  }\n\n  render() {\n    const inlineStyle = { position: 'fixed', opacity: 0, pointerEvents: 'none', display: 'block' };\n    return (\n      <div role=\"menu\" className=\"seafile-contextmenu dropdown-menu\" style={inlineStyle} ref={menu => { this.menu = menu; }}>\n        {this.state.menuList.map((menuItem, index) => {\n          if (menuItem === 'Divider') {\n            return <div key={index} className=\"seafile-divider dropdown-divider\"></div>;\n          } else {\n            return (\n              <button\n                key={index}\n                className=\"seafile-contextmenu-item dropdown-item\"\n                data-operation={menuItem.key}\n                onClick={this.onMenuItemClick}\n                onContextMenu={this.onContextMenu}\n              >\n                {menuItem.value}\n              </button>\n            );\n          }\n        })}\n      </div>\n    );\n  }\n}\n\nContextMenu.propTypes = propTypes;\n\nexport default ContextMenu;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { repoID, slug, serviceURL, isPublicWiki } from '../utils/constants';\nimport { Utils } from '../utils/utils';\nimport { deserialize } from '@seafile/seafile-editor';\nimport'../css/index-viewer.css';\n\nconst viewerPropTypes = {\n  indexContent: PropTypes.string.isRequired,\n  onLinkClick: PropTypes.func.isRequired,\n};\n\nclass TreeNode {\n\n  constructor({ name, href, parentNode }) {\n    this.name = name;\n    this.href = href;\n    this.parentNode = parentNode || null;\n    this.children = [];\n  }\n\n  setParent(parentNode) {\n    this.parentNode = parentNode;\n  }\n\n  addChildren(nodeList) {\n    nodeList.forEach((node) => {\n      node.setParent(this);\n    });\n    this.children = nodeList;\n  }\n}\n\nclass IndexContentViewer extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.links = [];\n    this.treeRoot = new TreeNode({ name: '', href: '' });\n    this.state = {\n      currentPath: '',\n    };\n  }\n\n  componentWillMount() {\n    this.getRootNode();\n  }\n\n  componentDidMount() {\n    this.bindClickEvent();\n  }\n\n  componentWillReceiveProps() {\n    this.removeClickEvent();\n  }\n\n  componentDidUpdate() {\n    this.bindClickEvent();\n  }\n\n  componentWillUnmount() {\n    this.removeClickEvent();\n  }\n\n  bindClickEvent = () => {\n    const contentClass = 'wiki-nav-content';\n    this.links = document.querySelectorAll(`.${contentClass} a`);\n    this.links.forEach(link => {\n      link.addEventListener('click', this.onLinkClick);\n    });\n  }\n\n  removeClickEvent = () => {\n    this.links.forEach(link => {\n      link.removeEventListener('click', this.onLinkClick);\n    });\n  }\n\n  onLinkClick = (event) => {\n    event.preventDefault();\n    const currentPath = event.target.getAttribute('data-path');\n    if (currentPath === this.state.currentPath) {\n      return;\n    } else if (currentPath) {\n      this.setState({ currentPath: currentPath });\n    }\n    const link = this.getLink(event.target);\n    if (link) this.props.onLinkClick(link);\n  }\n\n  getLink = (node) => {\n    const tagName = node.tagName;\n    if (!tagName || tagName === 'HTML') return;\n    if (tagName === 'A') {\n      return node.href;\n    } else {\n      return this.getLink(node.parentNode);\n    }\n  }\n\n  changeInlineNode = (item) => {\n    if (item.type == 'link' || item.type === 'image') {\n      let url;\n\n      // change image url\n      if (item.type == 'image' && isPublicWiki) {\n        url = item.data.src;\n        const re = new RegExp(serviceURL + '/lib/' + repoID +'/file.*raw=1');\n        // different repo\n        if (!re.test(url)) {\n          return;\n        }\n        // get image path\n        let index = url.indexOf('/file');\n        let index2 = url.indexOf('?');\n        const imagePath = url.substring(index + 5, index2);\n        // replace url\n        item.data.src = serviceURL + '/view-image-via-public-wiki/?slug=' + slug + '&path=' + imagePath;\n      }\n\n      else if (item.type == 'link') {\n        url = item.data.href;\n        /* eslint-disable */\n        let expression = /((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[\\-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9\\.\\-]+|(?:www\\.|[\\-;:&=\\+\\$,\\w]+@)[A-Za-z0-9\\.\\-]+)((?:\\/[\\+~%\\/\\.\\w\\-_]*)?\\??(?:[\\-\\+=&;%@\\.\\w_]*)#?(?:[\\.\\!\\/\\\\\\w]*))?)/\n        /* eslint-enable */\n        let re = new RegExp(expression);\n\n        // Solving relative paths\n        if (!re.test(url)) {\n          item.data.href = serviceURL + '/published/' + slug + '/' + url;\n        }\n        // change file url\n        else if (Utils.isInternalMarkdownLink(url, repoID)) {\n          let path = Utils.getPathFromInternalMarkdownLink(url, repoID);\n          // replace url\n          item.data.href = serviceURL + '/published/' + slug + path;\n        }\n        // change dir url\n        else if (Utils.isInternalDirLink(url, repoID)) {\n          let path = Utils.getPathFromInternalDirLink(url, repoID);\n          // replace url\n          item.data.href = serviceURL + '/published/' + slug + path;\n        }\n      }\n    }\n\n    return item;\n  }\n\n  getRootNode = () => {\n    let value = deserialize(this.props.indexContent);\n    const newNodes = Utils.changeMarkdownNodes(value, this.changeInlineNode);\n    newNodes.map((node) => {\n      if (node.type === 'unordered_list' || node.type === 'ordered_list') {\n        let treeRoot = this.transSlateToTree(node.children, this.treeRoot);\n        this.setNodePath(treeRoot, '/');\n        this.treeRoot = treeRoot;\n      }\n    });\n  }\n\n  setNodePath = (node, parentNodePath) => {\n    let name = node.name;\n    let path = parentNodePath === '/' ? parentNodePath + name : parentNodePath + '/' + name;\n    node.path = path;\n    if (node.children.length > 0) {\n      node.children.map(child => {\n        this.setNodePath(child, path);\n      });\n    }\n  }\n\n  // slateNodes is list items of an unordered list or ordered list, translate them to treeNode and add to parentTreeNode\n  transSlateToTree = (slateNodes, parentTreeNode) => {\n    let treeNodes = slateNodes.map((slateNode) => {\n      // item has children(unordered list)\n      if (slateNode.children.length === 2 && (slateNode.children[1].type === 'unordered_list' || slateNode.children[1].type === 'ordered_list')) {\n        // slateNode.nodes[0] is paragraph, create TreeNode, set name and href\n        const paragraphNode = slateNode.children[0];\n        const treeNode = this.transParagraph(paragraphNode);\n        // slateNode.nodes[1] is list, set it as TreeNode's children\n        const listNode = slateNode.children[1];\n        // Add sub list items to the tree node\n        return this.transSlateToTree(listNode.children, treeNode);\n      } else {\n        // item doesn't have children list\n        if (slateNode.children[0] && (slateNode.children[0].type === 'paragraph')) {\n          return this.transParagraph(slateNode.children[0]);\n        } else {\n          // list item contain table/code_block/blockqupta\n          return new TreeNode({ name: '', href: '' });\n        }\n      }\n    });\n    parentTreeNode.addChildren(treeNodes);\n    return parentTreeNode;\n  }\n\n  // translate slate_paragraph_node to treeNode\n  transParagraph = (paragraphNode) => {\n    let treeNode;\n    if (paragraphNode.children[1] && paragraphNode.children[1].type === 'link') {\n      // paragraph node is a link node\n      const linkNode = paragraphNode.children[1];\n      const textNode = linkNode.children[0];\n      let name = textNode ? textNode.text : '';\n      treeNode =  new TreeNode({ name: name, href: linkNode.data.href });\n    } else if (paragraphNode.children[0]) {\n      // paragraph first child node is a text node, then get node name\n      const textNode = paragraphNode.children[0];\n      let name = textNode.text ? textNode.text : '';\n      treeNode = new TreeNode({ name: name, href: '' });\n    } else {\n      treeNode = new TreeNode({ name: '', href: '' });\n    }\n    return treeNode;\n  }\n\n  render() {\n    return (\n      <div className=\"mx-4 o-hidden\">\n        <FolderItem node={this.treeRoot} bindClickEvent={this.bindClickEvent} currentPath={this.state.currentPath}/>\n      </div>\n    );\n  }\n}\n\nIndexContentViewer.propTypes = viewerPropTypes;\n\nconst FolderItemPropTypes = {\n  node: PropTypes.object.isRequired,\n  bindClickEvent: PropTypes.func.isRequired,\n  currentPath: PropTypes.string,\n};\n\nclass FolderItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      expanded: false\n    };\n  }\n\n  toggleExpanded = () => {\n    this.setState({ expanded: !this.state.expanded }, () => {\n      if (this.state.expanded) this.props.bindClickEvent();\n    });\n  }\n\n  renderLink = ({ href, name, path }) => {\n    const className = `wiki-nav-content ${path === this.props.currentPath ? 'wiki-nav-content-highlight' : ''}`;\n    if (href && name) {\n      return <div className={className}><a href={href} data-path={path} onClick={this.toggleExpanded} title={name}>{name}</a></div>;\n    } else if (name) {\n      return <div className=\"wiki-nav-content\"><span onClick={this.toggleExpanded} title={name}>{name}</span></div>;\n    } else {\n      return null;\n    }\n  }\n\n  componentDidMount() {\n    if (this.props.node && !this.props.node.parentNode) {\n      this.setState({ expanded: true }, () => {\n        this.props.bindClickEvent();\n      });\n    }\n  }\n\n  render() {\n    const { node } = this.props;\n    if (node.children.length > 0) {\n      return (\n        <React.Fragment>\n          {node.parentNode &&\n            <React.Fragment>\n              <span className=\"switch-btn\" onClick={this.toggleExpanded}>\n                {this.state.expanded ? <i className=\"fa fa-caret-down\"></i> : <i className=\"fa fa-caret-right\"></i>}\n              </span>\n              {this.renderLink(node)}\n            </React.Fragment>\n          }\n          {this.state.expanded && node.children.map((child, index) => {\n            return (\n              <div className=\"pl-4 position-relative\" key={index}>\n                <FolderItem node={child} bindClickEvent={this.props.bindClickEvent} currentPath={this.props.currentPath}/>\n              </div>\n            );\n          })}\n        </React.Fragment>\n      );\n    } else {\n      return this.renderLink(node);\n    }\n  }\n}\n\nFolderItem.propTypes = FolderItemPropTypes;\n\nexport default IndexContentViewer;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext, siteRoot, repoID, slug, username, permission } from '../../utils/constants';\nimport Logo from '../../components/logo';\nimport Loading from '../../components/loading';\nimport TreeView from '../../components/tree-view/tree-view';\nimport IndexContentViewer from '../../components/index-viewer';\n\nconst propTypes = {\n  closeSideBar: PropTypes.bool.isRequired,\n  isTreeDataLoading: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  indexNode: PropTypes.object,\n  indexContent: PropTypes.string.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  onCloseSide: PropTypes.func.isRequired,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onLinkClick: PropTypes.func.isRequired,\n};\n\nclass SidePanel extends Component {\n\n  constructor(props) {\n    super(props);\n    this.isNodeMenuShow = false;\n  }\n\n  renderIndexView = () => {\n    return (\n      <Fragment>\n        <div className=\"wiki-pages-container\">\n          <div style={{marginTop: '2px'}}></div>\n          <IndexContentViewer\n            indexContent={this.props.indexContent}\n            onLinkClick={this.props.onLinkClick}\n          />\n        </div>\n      </Fragment>\n    );\n  }\n\n  renderTreeView = () => {\n    return (\n      <Fragment>\n        <div className=\"wiki-pages-container\">\n          {this.props.treeData && (\n            <TreeView\n              treeData={this.props.treeData}\n              currentPath={this.props.currentPath}\n              isNodeMenuShow={this.isNodeMenuShow}\n              onNodeClick={this.props.onNodeClick}\n              onNodeCollapse={this.props.onNodeCollapse}\n              onNodeExpanded={this.props.onNodeExpanded}\n            />\n          )}\n        </div>\n      </Fragment>\n    );\n  }\n\n  render() {\n    return (\n      <div className={`side-panel wiki-side-panel ${this.props.closeSideBar ? '': 'left-zero'}`}>\n        <div className=\"side-panel-top panel-top\">\n          <Logo onCloseSidePanel={this.props.onCloseSide} />\n        </div>\n        <div id=\"side-nav\" className=\"wiki-side-nav\" role=\"navigation\">\n          {this.props.isTreeDataLoading && <Loading /> }\n          {!this.props.isTreeDataLoading && this.props.indexNode && this.renderIndexView() }\n          {!this.props.isTreeDataLoading && !this.props.indexNode && this.renderTreeView() }\n          {(username && permission) && <div className=\"text-left p-2\"><a href={siteRoot + 'library/' + repoID + '/' + slug + '/'} className=\"text-dark text-decoration-underline\">{gettext('Go to Library')}</a></div>}\n        </div>\n      </div>\n    );\n  }\n}\n\nSidePanel.propTypes = propTypes;\n\nexport default SidePanel;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { siteRoot } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  dirent: PropTypes.object.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n};\n\nclass WikiDirListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      highlight: false,\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({highlight: true});\n  }\n\n  onMouseLeave = () => {\n    this.setState({highlight: false});\n  }\n\n  onContextMenu = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n  }\n\n  onDirentClick = (e) => {\n    e.preventDefault();\n    this.props.onDirentClick(this.props.dirent);\n  }\n\n  render() {\n    let { path, dirent } = this.props;\n    let href = siteRoot + 'published' + Utils.joinPath(path, dirent.name);\n    let iconUrl = Utils.getDirentIcon(dirent);\n\n    const isDesktop = Utils.isDesktop();\n    return isDesktop ? (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onContextMenu={this.onContextMenu}>\n        <td className=\"text-center\">\n          <img src={iconUrl} width=\"24\" alt=\"\" />\n        </td>\n        <td className=\"name\">\n          <a href={href} onClick={this.onDirentClick}>{dirent.name}</a>\n        </td>\n        <td>{dirent.size}</td>\n        <td>{dirent.mtime_relative}</td>\n      </tr>\n    ) : (\n      <tr>\n        <td className=\"text-center\">\n          <img src={iconUrl} width=\"24\" alt=\"\" />\n        </td>\n        <td>\n          <a href={href} onClick={this.onDirentClick}>{dirent.name}</a>\n          <br />\n          <span className=\"item-meta-info\">{dirent.size}</span>\n          <span className=\"item-meta-info\">{dirent.mtime_relative}</span>\n        </td>\n      </tr>\n    );\n  }\n}\n\nWikiDirListItem.propTypes = propTypes;\n\nexport default WikiDirListItem;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport WikiDirListItem from './wiki-dir-list-item';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  direntList: PropTypes.array.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n};\n\nclass WikiDirListView extends React.Component {\n\n  render() {\n    const isDesktop = Utils.isDesktop();\n    return (\n      <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n        <thead>\n          {isDesktop ? (\n            <tr>\n              <th style={{width: '4%'}}></th>\n              <th style={{width: '66%'}}>{gettext('Name')}</th>\n              <th style={{width: '15%'}}>{gettext('Size')}</th>\n              <th style={{width: '15%'}}>{gettext('Last Update')}</th>\n            </tr>\n          ) : (\n            <tr>\n              <th width=\"12%\"></th>\n              <th width=\"88%\"></th>\n            </tr>\n          )}\n        </thead>\n        <tbody>\n          {this.props.direntList.length !== 0 && this.props.direntList.map((dirent, index) => {\n            return (\n              <WikiDirListItem key={index} path={this.props.path} dirent={dirent} onDirentClick={this.props.onDirentClick}/>\n            );\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nWikiDirListView.propTypes = propTypes;\n\nexport default WikiDirListView;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext, repoID, slug, siteRoot, username, isPro } from '../../utils/constants';\nimport WikiMarkdownViewer from '../../components/wiki-markdown-viewer';\nimport WikiDirListView from '../../components/wiki-dir-list-view/wiki-dir-list-view';\nimport Loading from '../../components/loading';\nimport { Utils } from '../../utils/utils';\nimport Search from '../../components/search/search';\nimport Notification from '../../components/common/notification';\nimport Account from '../../components/common/account';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  pathExist: PropTypes.bool.isRequired,\n  isViewFile: PropTypes.bool.isRequired,\n  isDataLoading: PropTypes.bool.isRequired,\n  content: PropTypes.string,\n  permission: PropTypes.string,\n  lastModified: PropTypes.string,\n  latestContributor: PropTypes.string,\n  direntList: PropTypes.array.isRequired,\n  onMenuClick: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n  onMainNavBarClick: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  onLinkClick: PropTypes.func.isRequired,\n};\n\nclass MainPanel extends Component {\n\n  onMenuClick = () => {\n    this.props.onMenuClick();\n  }\n\n  onEditClick = (e) => {\n    e.preventDefault();\n    let url = siteRoot + 'lib/' + repoID + '/file' + this.props.path + '?mode=edit';\n    window.open(url);\n  }\n\n  onMainNavBarClick = (e) => {\n    let path = Utils.getEventData(e, 'path');\n    this.props.onMainNavBarClick(path);\n  }\n\n  renderNavPath = () => {\n    let paths = this.props.path.split('/');\n    let nodePath = '';\n    let pathElem = paths.map((item, index) => {\n      if (item === '') {\n        return;\n      }\n      if (index === (paths.length - 1)) {\n        return (\n          <Fragment key={index}>\n            <span className=\"path-split\">/</span>\n            <span className=\"path-file-name\">{item}</span>\n          </Fragment>\n        );\n      } else {\n        nodePath += '/' + item;\n        return (\n          <Fragment key={index} >\n            <span className=\"path-split\">/</span>\n            <a\n              className=\"path-link\"\n              data-path={nodePath}\n              onClick={this.onMainNavBarClick}>\n              {item}\n            </a>\n          </Fragment>\n        );\n      }\n    });\n    return pathElem;\n  }\n\n\n  render() {\n    let { onSearchedClick, permission } = this.props;\n    let searchPlaceholder = gettext('Search files in this library');\n    const errMessage = (<div className=\"message err-tip\">{gettext('Folder does not exist.')}</div>);\n\n    const isViewingFile = this.props.pathExist && !this.props.isDataLoading && this.props.isViewFile;\n    return (\n      <div className=\"main-panel wiki-main-panel\">\n        <div className=\"main-panel-hide hide\">{this.props.content}</div>\n        <div className={`main-panel-north panel-top ${this.props.permission === 'rw' ? 'border-left-show' : ''}`}>\n          {!username &&\n            <Fragment>\n              <div className=\"cur-view-toolbar\">\n                <span className=\"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle\" title=\"Side Nav Menu\" onClick={this.onMenuClick}></span>\n              </div>\n              <div className=\"common-toolbar\">\n                {isPro && (\n                  <Search isPublic={true} repoID={repoID} onSearchedClick={onSearchedClick} placeholder={searchPlaceholder}/>\n                )}\n              </div>\n            </Fragment>\n          }\n          {username && (\n            <Fragment>\n              <div className=\"cur-view-toolbar\">\n                <span className=\"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle\" title=\"Side Nav Menu\" onClick={this.onMenuClick}></span>\n                {this.props.permission == 'rw' && (\n                  Utils.isDesktop() ?\n                    <button className=\"btn btn-secondary operation-item\" title={gettext('Edit')} onClick={this.onEditClick}>{gettext('Edit')}</button> :\n                    <span className=\"fa fa-pencil-alt mobile-toolbar-icon\" title={gettext('Edit')} onClick={this.onEditClick} style={{'fontSize': '1.1rem'}}></span>\n                )}\n              </div>\n              <div className=\"common-toolbar\">\n                {isPro && (\n                  <Search isPublic={true} repoID={repoID} onSearchedClick={onSearchedClick} placeholder={searchPlaceholder}/>\n                )}\n                <Notification />\n                <Account />\n              </div>\n            </Fragment>\n          )}\n        </div>\n        <div className=\"main-panel-center\">\n          <div className={`cur-view-content ${isViewingFile ? 'o-hidden' : ''}`}>\n            {!this.props.pathExist && errMessage}\n            {this.props.pathExist && this.props.isDataLoading && <Loading />}\n            {isViewingFile && (\n              <WikiMarkdownViewer\n                markdownContent={this.props.content}\n                isFileLoading={this.props.isDataLoading}\n                lastModified = {this.props.lastModified}\n                latestContributor={this.props.latestContributor}\n                onLinkClick={this.props.onLinkClick}\n                isWiki={true}\n                path={this.props.path}\n              />\n            )}\n            {(!this.props.isDataLoading && !this.props.isViewFile) && (\n              <WikiDirListView\n                path={this.props.path}\n                direntList={this.props.direntList}\n                onDirentClick={this.props.onDirentClick}\n              />\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nMainPanel.propTypes = propTypes;\n\nexport default MainPanel;\n","import React, { Component } from 'react';\nimport ReactDom from 'react-dom';\nimport moment from 'moment';\nimport MediaQuery from 'react-responsive';\nimport { Modal } from 'reactstrap';\nimport { slug, siteRoot, initialPath, isDir, sharedToken, hasIndex } from './utils/constants';\nimport { Utils } from './utils/utils';\nimport { seafileAPI } from './utils/seafile-api';\nimport Dirent from './models/dirent';\nimport TreeNode from './components/tree-view/tree-node';\nimport treeHelper from './components/tree-view/tree-helper';\nimport SidePanel from './pages/wiki/side-panel';\nimport MainPanel from './pages/wiki/main-panel';\nimport { lang } from './utils/constants';\n\nimport './css/layout.css';\nimport './css/side-panel.css';\nimport './css/wiki.css';\nimport './css/toolbar.css';\nimport './css/search.css';\n\nmoment.locale(lang);\n\nclass Wiki extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      path: '',\n      pathExist: true,\n      closeSideBar: false,\n      isViewFile: true,\n      isDataLoading: false,\n      direntList: [],\n      content: '',\n      permission: '',\n      lastModified: '',\n      latestContributor: '',\n      isTreeDataLoading: true,\n      treeData: treeHelper.buildTree(),\n      currentNode: null,\n      indexNode: null,\n      indexContent: '',\n    };\n\n    window.onpopstate = this.onpopstate;\n    this.indexPath = '/index.md';\n    this.homePath = '/home.md';\n    this.pythonWrapper = null;\n  }\n\n  componentWillMount() {\n    if (!Utils.isDesktop()) {\n      this.setState({ closeSideBar: true });\n    }\n  }\n\n  componentDidMount() {\n    this.loadSidePanel(initialPath);\n    this.loadWikiData(initialPath);\n\n    this.links = document.querySelectorAll(`#wiki-file-content a`);\n    this.links.forEach(link => link.addEventListener('click', this.onConentLinkClick));\n  }\n\n  componentWillUnmount() {\n    this.links.forEach(link => link.removeEventListener('click', this.onConentLinkClick));\n  }\n\n  loadSidePanel = (initialPath) => {\n    if (hasIndex) {\n      this.loadIndexNode();\n      return;\n    }\n\n    // load dir list\n    initialPath = isDir === 'None' ? '/' : initialPath;\n    this.loadNodeAndParentsByPath(initialPath);\n  }\n\n  loadWikiData = (initialPath) => {\n    this.pythonWrapper = document.getElementById('wiki-file-content');\n    if (isDir === 'False') {\n      // this.showFile(initialPath);\n      this.setState({path: initialPath});\n      return;\n    }\n\n    // if it is a file list, remove the template content provided by python\n    this.removePythonWrapper();\n\n    if (isDir === 'True') {\n      this.showDir(initialPath);\n      return;\n    }\n    \n    if (isDir === 'None' && initialPath === '/home.md') {\n      this.showDir('/');\n      return;\n    }\n\n    if (isDir === 'None') {\n      this.setState({pathExist: false});\n      let fileUrl = siteRoot + 'published/' + slug + Utils.encodePath(initialPath);\n      window.history.pushState({url: fileUrl, path: initialPath}, initialPath, fileUrl);\n    }\n  }\n\n  loadIndexNode = () => {\n    seafileAPI.listWikiDir(slug, '/').then(res => {\n      let tree = this.state.treeData;\n      this.addFirstResponseListToNode(res.data.dirent_list, tree.root);\n      let indexNode = tree.getNodeByPath(this.indexPath);\n      seafileAPI.getWikiFileContent(slug, indexNode.path).then(res => {\n        this.setState({\n          treeData: tree,\n          indexNode: indexNode,\n          indexContent: res.data.content,\n          isTreeDataLoading: false,\n        });\n      });\n    }).catch(() => {\n      this.setState({isLoadFailed: true});\n    });\n  }\n\n  showDir = (dirPath) => {\n    this.removePythonWrapper();\n    this.loadDirentList(dirPath);\n\n    // update location url\n    let fileUrl = siteRoot + 'published/' + slug + Utils.encodePath(dirPath);\n    window.history.pushState({url: fileUrl, path: dirPath}, dirPath, fileUrl);\n  }\n\n  showFile = (filePath) => {\n    this.setState({\n      isDataLoading: true,\n      isViewFile: true,\n      path: filePath,\n    });\n    \n    this.removePythonWrapper();\n    seafileAPI.getWikiFileContent(slug, filePath).then(res => {\n      let data = res.data;\n      this.setState({\n        isDataLoading: false,\n        content: data.content,\n        permission: data.permission,\n        lastModified: moment.unix(data.last_modified).fromNow(),\n        latestContributor: data.latest_contributor,\n      });\n    });\n\n    const hash = window.location.hash;\n    let fileUrl = siteRoot + 'published/' + slug + Utils.encodePath(filePath) + hash;\n    if (filePath === '/home.md') {\n      window.history.replaceState({url: fileUrl, path: filePath}, filePath, fileUrl);\n    } else {\n      window.history.pushState({url: fileUrl, path: filePath}, filePath, fileUrl);\n    }\n  }\n\n  loadDirentList = (dirPath) => {\n    this.setState({isDataLoading: true});\n    seafileAPI.listWikiDir(slug, dirPath).then(res => {\n      let direntList = res.data.dirent_list.map(item => {\n        let dirent = new Dirent(item);\n        return dirent;\n      });\n      if (dirPath === '/') {\n        direntList = direntList.filter(item => {\n          if (item.type === 'dir') {\n            let name = item.name.toLowerCase();\n            return name !== 'drafts' && name !== 'images' && name !== 'downloads';\n          }\n          return true;\n        });\n      }\n      direntList = Utils.sortDirents(direntList, 'name', 'asc');\n      this.setState({\n        path: dirPath,\n        isViewFile: false,\n        direntList: direntList,\n        isDataLoading: false,\n      });\n    }).catch(() => {\n      this.setState({isLoadFailed: true});\n    });\n  }\n\n  loadTreeNodeByPath = (path) => {\n    let tree = this.state.treeData.clone();\n    let node = tree.getNodeByPath(path);\n    if (!node.isLoaded) {\n      seafileAPI.listWikiDir(slug, node.path).then(res => {\n        this.addResponseListToNode(res.data.dirent_list, node);\n        let parentNode = tree.getNodeByPath(node.parentNode.path);\n        parentNode.isExpanded = true;\n        this.setState({\n          treeData: tree,\n          currentNode: node\n        });\n      });\n    } else {\n      let parentNode = tree.getNodeByPath(node.parentNode.path);\n      parentNode.isExpanded = true;\n      this.setState({treeData: tree, currentNode: node}); //tree\n    }\n  }\n\n  loadNodeAndParentsByPath = (path) => {\n    let tree = this.state.treeData.clone();\n    if (Utils.isMarkdownFile(path)) {\n      path = Utils.getDirName(path);\n    }\n    seafileAPI.listWikiDir(slug, path, true).then(res => {\n      let direntList = res.data.dirent_list;\n      let results = {};\n      for (let i = 0; i < direntList.length; i++) {\n        let object = direntList[i];\n        let key = object.parent_dir;\n        if (!results[key]) {\n          results[key] = [];\n        }\n        results[key].push(object);\n      }\n      for (let key in results) {\n        let node = tree.getNodeByPath(key);\n        if (!node.isLoaded && node.path === '/') {\n          this.addFirstResponseListToNode(results[key], node);\n        } else if (!node.isLoaded) {\n          this.addResponseListToNode(results[key], node);\n        }\n      }\n      this.setState({\n        isTreeDataLoading: false,\n        treeData: tree\n      });\n    }).catch(() => {\n      this.setState({isLoadFailed: true});\n    });\n  }\n\n  removePythonWrapper = () => {\n    if (this.pythonWrapper)  {\n      document.body.removeChild(this.pythonWrapper);\n      this.pythonWrapper = null;\n    }\n  }\n\n  onConentLinkClick = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    let link = '';\n    if (event.target.tagName !== 'A') {\n      let target = event.target.parentNode;\n      while (target.tagName !== 'A') {\n        target = target.parentNode;\n      }\n      link = target.href;\n    } else {\n      link = event.target.href;\n    }\n    this.onLinkClick(link);\n  }\n\n  onLinkClick = (link) => {\n    const url = link;\n    if (Utils.isWikiInternalMarkdownLink(url, slug)) {\n      let path = Utils.getPathFromWikiInternalMarkdownLink(url, slug);\n      this.showFile(path);\n    } else if (Utils.isWikiInternalDirLink(url, slug)) {\n      let path = Utils.getPathFromWikiInternalDirLink(url, slug);\n      this.showDir(path);\n    } else {\n      window.location.href = url;\n    }\n    if (!this.state.closeSideBar) {\n      this.setState({ closeSideBar: true });\n    }\n  }\n\n  onpopstate = (event) => {\n    if (event.state && event.state.path) {\n      let path = event.state.path;\n      if (Utils.isMarkdownFile(path)) {\n        this.showFile(path);\n      } else {\n        this.loadDirentList(path);\n        this.setState({\n          path: path,\n          isViewFile: false\n        });\n      }\n    }\n  }\n\n  onSearchedClick = (item) => {\n    let path = item.is_dir ? item.path.slice(0, item.path.length - 1) : item.path;\n    if (this.state.currentPath === path) {\n      return;\n    }\n\n    // load sidePanel\n    let index = -1;\n    let paths = Utils.getPaths(path);\n    for (let i = 0; i < paths.length; i++) {\n      let node = this.state.treeData.getNodeByPath(node);\n      if (!node) {\n        index = i;\n        break;\n      }\n    }\n    if (index === -1) { // all the data has been loaded already.\n      let tree = this.state.treeData.clone();\n      let node = tree.getNodeByPath(item.path);\n      treeHelper.expandNode(node);\n      this.setState({treeData: tree});\n    } else {\n      this.loadNodeAndParentsByPath(path);\n    }\n\n    // load mainPanel\n    if (item.is_dir) {\n      this.showDir(path);\n    } else {\n      if (Utils.isMarkdownFile(path)) {\n        this.showFile(path);\n      } else {\n        let url = siteRoot + 'd/' + sharedToken + '/files/?p=' + Utils.encodePath(path);\n        let newWindow = window.open('about:blank');\n        newWindow.location.href = url;\n      }\n    }\n  }\n\n  onMenuClick = () => {\n    this.setState({closeSideBar: !this.state.closeSideBar});\n  }\n\n  onMainNavBarClick = (nodePath) => {\n    let tree = this.state.treeData.clone();\n    let node = tree.getNodeByPath(nodePath);\n    tree.expandNode(node);\n    this.setState({treeData: tree, currentNode: node});\n    this.showDir(node.path);\n  }\n\n  onDirentClick = (dirent) => {\n    let direntPath = Utils.joinPath(this.state.path, dirent.name);\n    if (dirent.isDir()) {  // is dir\n      this.loadTreeNodeByPath(direntPath);\n      this.showDir(direntPath);\n    } else {  // is file\n      if (Utils.isMarkdownFile(direntPath)) {\n        this.showFile(direntPath);\n      } else {\n        const w=window.open('about:blank');\n        const url = siteRoot + 'd/' + sharedToken + '/files/?p=' + Utils.encodePath(direntPath);\n        w.location.href = url;\n      }\n    }\n  }\n\n  onCloseSide = () => {\n    this.setState({closeSideBar: !this.state.closeSideBar});\n  }\n\n  onNodeClick = (node) => {\n    if (!this.state.pathExist) {\n      this.setState({pathExist: true});\n    }\n\n    if (node.object.isDir()) {\n      if (!node.isLoaded) {\n        let tree = this.state.treeData.clone();\n        node = tree.getNodeByPath(node.path);\n        seafileAPI.listWikiDir(slug, node.path).then(res => {\n          this.addResponseListToNode(res.data.dirent_list, node);\n          tree.collapseNode(node);\n          this.setState({treeData: tree});\n        });\n      }\n      if (node.path === this.state.path) {\n        if (node.isExpanded) {\n          let tree = treeHelper.collapseNode(this.state.treeData, node);\n          this.setState({treeData: tree});\n        } else {\n          let tree = this.state.treeData.clone();\n          node = tree.getNodeByPath(node.path);\n          tree.expandNode(node);\n          this.setState({treeData: tree});\n        }\n      }\n    }\n\n    if (node.path === this.state.path ) {\n      return;\n    }\n\n    if (node.object.isDir()) {  // isDir\n      this.showDir(node.path);\n    } else {\n      if (Utils.isMarkdownFile(node.path)) {\n        if (node.path !== this.state.path) {\n          this.showFile(node.path);\n        }\n        this.onCloseSide();\n      } else {\n        const w = window.open('about:blank');\n        const url = siteRoot + 'd/' + sharedToken + '/files/?p=' + Utils.encodePath(node.path);\n        w.location.href = url;\n      }\n    }\n  }\n\n  onNodeCollapse = (node) => {\n    let tree = treeHelper.collapseNode(this.state.treeData, node);\n    this.setState({treeData: tree});\n  }\n\n  onNodeExpanded = (node) => {\n    let tree = this.state.treeData.clone();\n    node = tree.getNodeByPath(node.path);\n    if (!node.isLoaded) {\n      seafileAPI.listWikiDir(slug, node.path).then(res => {\n        this.addResponseListToNode(res.data.dirent_list, node);\n        this.setState({treeData: tree});\n      });\n    } else {\n      tree.expandNode(node);\n      this.setState({treeData: tree});\n    }\n  }\n\n  addFirstResponseListToNode = (list, node) => {\n    node.isLoaded = true;\n    node.isExpanded = true;\n    let direntList = list.map(item => {\n      return new Dirent(item);\n    });\n    direntList = direntList.filter(item => {\n      if (item.type === 'dir') {\n        let name = item.name.toLowerCase();\n        return name !== 'drafts' && name !== 'images' && name !== 'downloads';\n      }\n      return true;\n    });\n    direntList = Utils.sortDirents(direntList, 'name', 'asc');\n\n    let nodeList = direntList.map(object => {\n      return new TreeNode({object});\n    });\n    node.addChildren(nodeList);\n  }\n\n  addResponseListToNode = (list, node) => {\n    node.isLoaded = true;\n    node.isExpanded = true;\n    let direntList = list.map(item => {\n      return new Dirent(item);\n    });\n    direntList = Utils.sortDirents(direntList, 'name', 'asc');\n\n    let nodeList = direntList.map(object => {\n      return new TreeNode({object});\n    });\n    node.addChildren(nodeList);\n  }\n\n  render() {\n    return (\n      <div id=\"main\" className=\"wiki-main\">\n        <SidePanel\n          isTreeDataLoading={this.state.isTreeDataLoading}\n          closeSideBar={this.state.closeSideBar}\n          currentPath={this.state.path}\n          treeData={this.state.treeData}\n          indexNode={this.state.indexNode}\n          indexContent={this.state.indexContent}\n          onCloseSide={this.onCloseSide}\n          onNodeClick={this.onNodeClick}\n          onNodeCollapse={this.onNodeCollapse}\n          onNodeExpanded={this.onNodeExpanded}\n          onLinkClick={this.onLinkClick}\n        />\n        <MainPanel\n          path={this.state.path}\n          pathExist={this.state.pathExist}\n          isViewFile={this.state.isViewFile}\n          isDataLoading={this.state.isDataLoading}\n          content={this.state.content}\n          permission={this.state.permission}\n          lastModified={this.state.lastModified}\n          latestContributor={this.state.latestContributor}\n          direntList={this.state.direntList}\n          onLinkClick={this.onLinkClick}\n          onMenuClick={this.onMenuClick}\n          onSearchedClick={this.onSearchedClick}\n          onMainNavBarClick={this.onMainNavBarClick}\n          onDirentClick={this.onDirentClick}\n        />\n        <MediaQuery query=\"(max-width: 767.8px)\">\n          <Modal isOpen={!this.state.closeSideBar} toggle={this.onCloseSide} contentClassName=\"d-none\"></Modal>\n        </MediaQuery>\n      </div>\n    );\n  }\n}\n\nReactDom.render(<Wiki />, document.getElementById('wrapper'));\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport listener from '../context-menu/globalEventListener';\nimport { Dropdown, ButtonDropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  tagName: PropTypes.string,\n  item: PropTypes.object.isRequired,\n  toggleClass: PropTypes.string,\n  isHandleContextMenuEvent: PropTypes.bool,\n  getMenuList: PropTypes.func.isRequired,\n  onMenuItemClick: PropTypes.func.isRequired,\n  freezeItem: PropTypes.func,\n  unfreezeItem: PropTypes.func,\n};\n\nclass ItemDropdownMenu extends React.Component {\n\n  static defaultProps = {\n    isHandleContextMenuEvent: true,\n    toggleClass: 'sf2-icon-caret-down'\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      menuList: [],\n      isItemMenuShow: false,\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.isHandleContextMenuEvent) {\n      this.listenerId = listener.register(this.onShowMenu, this.onHideMenu);\n    }\n    let { item } = this.props;\n    let menuList = this.props.getMenuList(item);\n    this.setState({menuList: menuList});\n  }\n\n  componentWillReceiveProps(nextProps) {  // for toolbar item operation\n    let { item } = nextProps;\n    if (item.name !== this.props.item.name) {\n      let menuList = this.props.getMenuList(item);\n      this.setState({menuList: menuList});\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.props.isHandleContextMenuEvent && this.listenerId) {\n      listener.unregister(this.listenerId);\n    }\n  }\n\n  onShowMenu = () => {\n    // nothing todo\n  }\n\n  onHideMenu = () => {\n    if (this.state.isItemMenuShow) {\n      this.setState({isItemMenuShow: false});\n      if (typeof(this.props.unfreezeItem) === 'function') {\n        this.props.unfreezeItem();\n      }\n    }\n  }\n\n  onDropdownToggleKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.onDropdownToggleClick(e);\n    }\n  }\n\n  onDropdownToggleClick = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.toggleOperationMenu();\n  }\n\n  toggleOperationMenu = () => {\n    this.setState(\n      {isItemMenuShow: !this.state.isItemMenuShow},\n      () => {\n        if (this.state.isItemMenuShow && typeof(this.props.freezeItem) === 'function') {\n          this.props.freezeItem();\n        } else if (!this.state.isItemMenuShow && typeof(this.props.unfreezeItem) === 'function') {\n          this.props.unfreezeItem();\n        }\n      }\n    );\n  }\n\n  onMenuItemKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.onMenuItemClick(e);\n    }\n  }\n\n  onMenuItemClick = (event) => {\n    let operation = Utils.getEventData(event, 'toggle');\n    let item = this.props.item;\n    this.props.onMenuItemClick(operation, event, item);\n  }\n\n  render() {\n    let menuList = this.state.menuList;\n    let { toggleClass, tagName } = this.props;\n    toggleClass = 'sf-dropdown-toggle ' + toggleClass;\n\n    if (!menuList.length) {\n      return '';\n    }\n\n    if (tagName && tagName === 'button') {\n      return (\n        <ButtonDropdown isOpen={this.state.isItemMenuShow} toggle={this.onDropdownToggleClick}>\n          <DropdownToggle\n            className={toggleClass}\n            data-toggle=\"dropdown\"\n            title={gettext('More Operations')}\n            aria-label={gettext('More Operations')}\n            aria-expanded={this.state.isItemMenuShow}\n            onKeyDown={this.onDropdownToggleKeyDown}\n            // onClick={this.onDropdownToggleClick}\n          >\n          </DropdownToggle>\n          <DropdownMenu>\n            {menuList.map((menuItem, index) => {\n              if (menuItem === 'Divider') {\n                return <DropdownItem key={index} divider />;\n              } else {\n                return (\n                  <DropdownItem key={index} data-toggle={menuItem.key} onClick={this.onMenuItemClick} onKeyDown={this.onMenuItemKeyDown}>{menuItem.value}</DropdownItem>\n                );\n              }\n            })}\n          </DropdownMenu>\n        </ButtonDropdown>\n      );\n    }\n\n    return (\n      <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.onDropdownToggleClick} className=\"vam\">\n        <DropdownToggle\n          tag={tagName || 'i'}\n          role=\"button\"\n          tabIndex=\"0\"\n          className={toggleClass}\n          title={gettext('More Operations')}\n          data-toggle=\"dropdown\"\n          aria-expanded={this.state.isItemMenuShow}\n          aria-label={gettext('More Operations')}\n          onKeyDown={this.onDropdownToggleKeyDown}\n          // onClick={this.onDropdownToggleClick}\n        />\n        <DropdownMenu>\n          {menuList.map((menuItem, index) => {\n            if (menuItem === 'Divider') {\n              return <DropdownItem key={index} divider />;\n            } else {\n              return (\n                <DropdownItem key={index} data-toggle={menuItem.key} onClick={this.onMenuItemClick} onKeyDown={this.onMenuItemKeyDown}>{menuItem.value}</DropdownItem>\n              );\n            }\n          })}\n        </DropdownMenu>\n      </Dropdown>\n    );\n  }\n}\n\nItemDropdownMenu.propTypes = propTypes;\n\nexport default ItemDropdownMenu;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { MarkdownViewer } from '@seafile/seafile-editor';\nimport { gettext, repoID, slug, serviceURL, isPublicWiki, sharedToken, mediaUrl } from '../utils/constants';\nimport Loading from './loading';\nimport { Utils } from '../utils/utils';\n\nconst propTypes = {\n  children: PropTypes.object,\n  isFileLoading: PropTypes.bool.isRequired,\n  markdownContent: PropTypes.string.isRequired,\n  latestContributor: PropTypes.string.isRequired,\n  lastModified: PropTypes.string.isRequired,\n  onLinkClick: PropTypes.func.isRequired,\n  isWiki: PropTypes.bool,\n  isTOCShow: PropTypes.bool,\n  // for dir-column-file component(import repoID is undefined)\n  repoID: PropTypes.string,\n  path: PropTypes.string,\n};\n\nconst contentClass = 'wiki-page-content';\n\nclass WikiMarkdownViewer extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      activeTitleIndex: 0,\n    };\n    this.markdownContainer = React.createRef();\n    this.links = [];\n    this.titlesInfo = [];\n  }\n\n  componentDidMount() {\n    // Bind event when first loaded\n    this.links = document.querySelectorAll(`.${contentClass} a`);\n    this.links.forEach(link => {\n      link.addEventListener('click', this.onLinkClick);\n    });\n\n    this.getTitlesInfo();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.markdownContent === nextProps.markdownContent) {\n      return;\n    }\n    // Unbound event when updating\n    this.links.forEach(link => {\n      link.removeEventListener('click', this.onLinkClick);\n    });\n  }\n\n  componentDidUpdate() {\n    // Update completed, rebind event\n    this.links = document.querySelectorAll(`.${contentClass} a`);\n    this.links.forEach(link => {\n      link.addEventListener('click', this.onLinkClick);\n    });\n    if (this.titlesInfo.length === 0) {\n      this.getTitlesInfo();\n    }\n  }\n\n  componentWillUnmount() {\n    // Unbound events when the component is destroyed\n    this.links.forEach(link => {\n      link.removeEventListener('click', this.onLinkClick);\n    });\n  }\n\n  getTitlesInfo = () => {\n    let titlesInfo = [];\n    const titleDom = document.querySelectorAll('h1[id^=\"user-content\"]')[0];\n    if (titleDom) {\n      const id = titleDom.getAttribute('id');\n      let content = id && id.replace('user-content-', '');\n      content = content ? `${content} - ${slug}` : slug;\n      Utils.updateTabTitle(content);\n    }\n    let headingList = document.querySelectorAll('h2[id^=\"user-content\"], h3[id^=\"user-content\"]');\n    for (let i = 0; i < headingList.length; i++) {\n      titlesInfo.push(headingList[i].offsetTop);\n    }\n    this.titlesInfo = titlesInfo;\n  }\n\n  onLinkClick = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    let link = '';\n    if (event.target.tagName !== 'A') {\n      let target = event.target.parentNode;\n      while (target.tagName !== 'A') {\n        target = target.parentNode;\n      }\n      link = target.href;\n    } else {\n      link = event.target.href;\n    }\n    this.props.onLinkClick(link);\n  }\n\n  onScrollHandler = () => {\n    const contentScrollTop = this.markdownContainer.current.scrollTop + 180;\n    let titlesLength = this.titlesInfo.length;\n    let activeTitleIndex;\n    if (contentScrollTop <= this.titlesInfo[0]) {\n      activeTitleIndex = 0;\n      this.setState({activeTitleIndex: activeTitleIndex});\n      return;\n    }\n    if (contentScrollTop > this.titlesInfo[titlesLength - 1]) {\n      activeTitleIndex = this.titlesInfo.length - 1;\n      this.setState({activeTitleIndex: activeTitleIndex});\n      return;\n    }\n    for (let i = 0; i < titlesLength; i++) {\n      if (contentScrollTop > this.titlesInfo[i]) {\n        continue;\n      } else {\n        activeTitleIndex = i - 1;\n        break;\n      }\n    }\n    this.setState({activeTitleIndex: activeTitleIndex});\n  }\n\n  changeInlineNode = (item) => {\n    let url, imagePath;\n\n    if (item.type == 'image' && isPublicWiki) { // change image url\n      url = item.data.src;\n      const re = new RegExp(serviceURL + '/lib/' + repoID +'/file.*raw=1');\n      // different repo\n      if (re.test(url)) {\n        // get image path\n        let index = url.indexOf('/file');\n        let index2 = url.indexOf('?');\n        imagePath = url.substring(index + 5, index2);\n      } else if (/^\\.\\.\\/*/.test(url) || /^\\.\\/*/.test(url)) {\n        const path = this.props.path;\n        const originalPath = path.slice(0, path.lastIndexOf('/')) + '/' + url;\n        imagePath = Utils.pathNormalize(originalPath);\n      } else {\n        return;\n      }\n      item.data.src = serviceURL + '/view-image-via-public-wiki/?slug=' + slug + '&path=' + imagePath;\n    } else if (item.type == 'link') { // change link url\n      url = item.data.href;\n      if (Utils.isInternalFileLink(url, repoID)) { // change file url\n        if (Utils.isInternalMarkdownLink(url, repoID)) {\n          let path = Utils.getPathFromInternalMarkdownLink(url, repoID);\n          // replace url\n          item.data.href = serviceURL + '/published/' + slug + path;\n        } else {\n          item.data.href = url.replace(/(.*)lib\\/([-0-9a-f]{36})\\/file(.*)/g, (match, p1, p2, p3) => {\n            return `${p1}d/${sharedToken}/files/?p=${p3}&dl=1`;\n          });\n        }\n      } else if (Utils.isInternalDirLink(url, repoID)) { // change dir url\n        let path = Utils.getPathFromInternalDirLink(url, repoID);\n        // replace url\n        item.data.href = serviceURL + '/published/' + slug + path;\n      }\n    }\n\n    return item;\n  }\n\n  modifyValueBeforeRender = (value) => {\n    let newNodes = Utils.changeMarkdownNodes(value, this.changeInlineNode);\n    return newNodes;\n  }\n\n  renderMarkdown = () => {\n    let isTOCShow = true;\n    if (this.props.isTOCShow === false) {\n      isTOCShow = false;\n    }\n    if (this.props.isWiki) {\n      return (\n        <MarkdownViewer\n          showTOC={isTOCShow}\n          scriptSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n          markdownContent={this.props.markdownContent}\n          activeTitleIndex={this.state.activeTitleIndex}\n          modifyValueBeforeRender={this.modifyValueBeforeRender}\n        />\n      );\n    }\n\n    return (\n      <MarkdownViewer\n        showTOC={isTOCShow}\n        scriptSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n        markdownContent={this.props.markdownContent}\n        activeTitleIndex={this.state.activeTitleIndex}\n      />\n    );\n  }\n\n  render() {\n    if (this.props.isFileLoading) {\n      return <Loading />;\n    }\n    // In dir-column-file repoID is one of props, width is 100%; In wiki-viewer repoID is not props, width isn't 100%\n    let contentClassName = `${this.props.repoID ? contentClass + ' w-100' : contentClass}`;\n    return (\n      <div ref={this.markdownContainer} className=\"wiki-page-container\" onScroll={this.onScrollHandler.bind(this)}>\n        <div className={contentClassName}>\n          {this.props.children}\n          {this.renderMarkdown()}\n          <p id=\"wiki-page-last-modified\">{gettext('Last modified by')} {this.props.latestContributor}, <span>{this.props.lastModified}</span></p>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst defaultProps = {\n  isWiki: false,\n};\n\nWikiMarkdownViewer.propTypes = propTypes;\nMarkdownViewer.defaultProps = defaultProps;\n\nexport default WikiMarkdownViewer;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { permission } from '../../utils/constants';\nimport TextTranslation from '../../utils/text-translation';\nimport ItemDropdownMenu from '../dropdown-menu/item-dropdown-menu';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  userPerm: PropTypes.string,\n  node: PropTypes.object.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  paddingLeft: PropTypes.number.isRequired,\n  isNodeMenuShow: PropTypes.bool.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeDragStart: PropTypes.func.isRequired,\n  freezeItem: PropTypes.func.isRequired,\n  unfreezeItem: PropTypes.func.isRequired,\n  onMenuItemClick: PropTypes.func,\n  onNodeDragMove: PropTypes.func,\n  onNodeDrop: PropTypes.func,\n  handleContextClick: PropTypes.func.isRequired,\n  onNodeDragEnter: PropTypes.func.isRequired,\n  onNodeDragLeave:PropTypes.func.isRequired,\n};\n\nclass TreeNodeView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isHighlight: false,\n      isShowOperationMenu: false,\n      isNodeDropShow: false,\n    };\n    const { userPerm } = props;\n    this.canDrag = userPerm === 'rw';\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (isCustomPermission) {\n      const { modify } = customPermission.permission;\n      this.canDrag = modify;\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (!nextProps.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: false,\n        isHighlight: false,\n      });\n    }\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: true,\n        isHighlight: true,\n      });\n    }\n  }\n\n  onMouseOver = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: true,\n        isHighlight: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: false,\n        isHighlight: false,\n      });\n    }\n  }\n\n  onNodeClick = () => {\n    const { node } = this.props;\n    const { object } = node;\n    if (object.isDir()) {\n      this.props.onNodeClick(this.props.node);\n      return;\n    }\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(object.permission);\n    if (isCustomPermission) {\n      const { preview: canPreview, modify: canModify } = customPermission.permission;\n      if (!canPreview && !canModify) return;\n    } \n    this.props.onNodeClick(this.props.node);\n  }\n\n  onLoadToggle = (e) => {\n    e.stopPropagation();\n    let { node } = this.props;\n    if (node.isExpanded) {\n      this.props.onNodeCollapse(node);\n    } else {\n      this.props.onNodeExpanded(node);\n    }\n  }\n\n  onNodeDragStart = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.props.onNodeDragStart(e, this.props.node);\n  }\n\n  onNodeDragEnter = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    if (this.props.node.object.type === 'dir') {\n      this.setState({isNodeDropShow: true});\n    }\n    this.props.onNodeDragEnter(e, this.props.node);\n  }\n\n  onNodeDragMove = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.props.onNodeDragMove(e);\n  }\n\n  onNodeDragLeave = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.setState({isNodeDropShow: false});\n    this.props.onNodeDragLeave(e, this.props.node);\n  }\n\n  onNodeDrop = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    e.stopPropagation();\n    this.setState({isNodeDropShow: false});\n    this.props.onNodeDrop(e, this.props.node);\n  }\n\n  unfreezeItem = () => {\n    this.setState({isShowOperationMenu: false});\n    this.props.unfreezeItem();\n  }\n\n  onMenuItemClick = (operation, event, node) => {\n    this.props.onMenuItemClick(operation, node);\n  }\n\n  onItemMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  onItemContextMenu = (event) => {\n    this.handleContextClick(event);\n  }\n\n  handleContextClick = (event) => {\n    this.props.handleContextClick(event, this.props.node);\n    this.setState({isShowOperationMenu: false});\n  }\n\n  getNodeTypeAndIcon = () => {\n    let { node } = this.props;\n    let icon = '';\n    let type = '';\n    if (node.object.type === 'dir') {\n      icon = <i className=\"far fa-folder\"></i>;\n      type = 'dir';\n    } else {\n      let index = node.object.name.lastIndexOf('.');\n      if (index === -1) {\n        icon = <i className=\"far fa-file\"></i>;\n        type = 'file';\n      } else {\n        let suffix = node.object.name.slice(index).toLowerCase();\n        if (suffix === '.png' || suffix === '.jpg' || suffix === '.jpeg' || suffix === '.gif' || suffix === '.bmp') {\n          icon = <i className=\"far fa-image\"></i>;\n          type = 'image';\n        }\n        else if (suffix === '.md' || suffix === '.markdown') {\n          icon = <i className=\"far fa-file-alt\"></i>;\n          type = 'file';\n        }\n        else {\n          icon = <i className=\"far fa-file\"></i>;\n          type = 'file';\n        }\n      }\n    }\n    return {icon, type};\n  }\n\n  calculateMenuList = (node) => {\n    let { NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE, OPEN_VIA_CLIENT} =  TextTranslation;\n\n    let menuList = [RENAME, DELETE, COPY, MOVE, OPEN_VIA_CLIENT];\n    if (node.object.type === 'dir') {\n      menuList = [NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE];\n    }\n\n    const { userPerm } = this.props;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (!isCustomPermission) {\n      return menuList;\n    }\n\n    menuList = [];\n    const { create: canCreate, modify: canModify, delete: canDelete, copy: canCopy } = customPermission.permission;\n    if (node.object.type === 'dir') {\n      canCreate && menuList.push(NEW_FOLDER, NEW_FILE);\n    }\n\n    canCopy && menuList.push(COPY);\n    canModify && menuList.push(MOVE, RENAME);\n    canDelete && menuList.push(DELETE);\n\n    if (node.object.type !== 'dir') { \n      menuList.push(OPEN_VIA_CLIENT);\n    }\n\n    return menuList;\n  }\n\n  renderChildren = () => {\n    let { node, paddingLeft } = this.props;\n    if (!node.hasChildren()) {\n      return '';\n    }\n    return (\n      <div className=\"children\" style={{paddingLeft: paddingLeft}}>\n        {node.children.map(item => {\n          return (\n            <TreeNodeView\n              key={item.path}\n              node={item}\n              paddingLeft={paddingLeft}\n              userPerm={this.props.userPerm}\n              currentPath={this.props.currentPath}\n              isNodeMenuShow={this.props.isNodeMenuShow}\n              isItemFreezed={this.props.isItemFreezed}\n              onNodeClick={this.props.onNodeClick}\n              onNodeCollapse={this.props.onNodeCollapse}\n              onNodeExpanded={this.props.onNodeExpanded}\n              freezeItem={this.props.freezeItem}\n              onMenuItemClick={this.props.onMenuItemClick}\n              unfreezeItem={this.unfreezeItem}\n              onNodeDragStart={this.props.onNodeDragStart}\n              onNodeDragMove={this.props.onNodeDragMove}\n              onNodeDrop={this.props.onNodeDrop}\n              onNodeDragEnter={this.props.onNodeDragEnter}\n              onNodeDragLeave={this.props.onNodeDragLeave}\n              handleContextClick={this.props.handleContextClick}\n            />\n          );\n        })}\n      </div>\n    );\n  }\n\n  render() {\n    let { currentPath, node, isNodeMenuShow, userPerm } = this.props;\n    let { type, icon } = this.getNodeTypeAndIcon();\n    let hlClass = this.state.isHighlight ? 'tree-node-inner-hover ' : '';\n    if (node.path === currentPath) {\n      hlClass = 'tree-node-hight-light';\n    }\n\n    const { isCustomPermission } = Utils.getUserPermission(userPerm)\n    return (\n      <div className=\"tree-node\">\n        <div\n          type={type}\n          className={`tree-node-inner text-nowrap ${hlClass} ${node.path === '/'? 'hide': ''} ${this.state.isNodeDropShow ? 'tree-node-drop' : ''}`}\n          title={node.object.name}\n          onMouseEnter={this.onMouseEnter}\n          onMouseOver={this.onMouseOver}\n          onMouseLeave={this.onMouseLeave}\n          onMouseDown={this.onItemMouseDown}\n          onContextMenu={this.onItemContextMenu}\n          onClick={this.onNodeClick}\n        >\n          <div className=\"tree-node-text\" draggable={this.canDrag} onDragStart={this.onNodeDragStart} onDragEnter={this.onNodeDragEnter} onDragLeave={this.onNodeDragLeave} onDragOver={this.onNodeDragMove} onDrop={this.onNodeDrop}>{node.object.name}</div>\n          <div className=\"left-icon\">\n            {type === 'dir' && (!node.isLoaded ||  (node.isLoaded && node.hasChildren())) && (\n              <i\n                className={`folder-toggle-icon fa ${node.isExpanded ? 'fa-caret-down' : 'fa-caret-right'}`}\n                onMouseDown={e => e.stopPropagation()}\n                onClick={this.onLoadToggle}\n              ></i>\n            )}\n            <i className=\"tree-node-icon\">{icon}</i>\n          </div>\n          {isNodeMenuShow && (\n            <div className=\"right-icon\">\n              {((userPerm === 'rw' || permission || isCustomPermission) && this.state.isShowOperationMenu) && (\n                <ItemDropdownMenu\n                  item={this.props.node}\n                  toggleClass={'fas fa-ellipsis-v'}\n                  getMenuList={this.calculateMenuList}\n                  onMenuItemClick={this.onMenuItemClick}\n                  freezeItem={this.props.freezeItem}\n                  unfreezeItem={this.unfreezeItem}\n                />\n              )}\n            </div>\n          )}\n        </div>\n        {node.isExpanded && this.renderChildren()}\n      </div>\n    );\n  }\n}\n\nTreeNodeView.propTypes = propTypes;\n\nexport default TreeNodeView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport TextTranslation from '../../utils/text-translation';\nimport TreeNodeView from './tree-node-view';\nimport ContextMenu from '../context-menu/context-menu';\nimport { hideMenu, showMenu } from '../context-menu/actions';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  userPerm: PropTypes.string,\n  isNodeMenuShow: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  onMenuItemClick: PropTypes.func,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func,\n  currentRepoInfo: PropTypes.object,\n  selectedDirentList: PropTypes.array,\n  onItemsMove: PropTypes.func,\n};\n\nconst PADDING_LEFT = 20;\n\nclass TreeView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n      isTreeViewDropTipShow: false,\n    };\n    const { userPerm } = props;\n    this.canDrop = userPerm === 'rw';\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (isCustomPermission) {\n      const { modify } = customPermission.permission;\n      this.canDrop = modify;\n    }\n  }\n\n  onItemMove = (repo, dirent, selectedPath, currentPath) => {\n    this.props.onItemMove(repo, dirent, selectedPath, currentPath);\n  }\n\n  onNodeDragStart = (e, node) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    let dragStartNodeData = {nodeDirent: node.object, nodeParentPath: node.parentNode.path, nodeRootPath: node.path};\n    dragStartNodeData = JSON.stringify(dragStartNodeData);\n\n    e.dataTransfer.effectAllowed = 'move';\n    e.dataTransfer.setData('applicaiton/drag-item-info', dragStartNodeData);\n  }\n\n  onNodeDragEnter = (e, node) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    e.persist();\n    if (e.target.className === 'tree-view tree ') {\n      this.setState({\n        isTreeViewDropTipShow: true,\n      });\n    }\n  }\n\n  onNodeDragMove = (e) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }\n\n  onNodeDragLeave = (e, node) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    if (e.target.className === 'tree-view tree tree-view-drop') {\n      this.setState({\n        isTreeViewDropTipShow: false,\n      });\n    }\n  }\n\n  onContainerClick = (event) => {\n    hideMenu();\n  }\n\n  onNodeClick = (node) => {\n    hideMenu();\n    this.props.onNodeClick(node);\n  }\n\n  onNodeDrop = (e, node) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    let dragStartNodeData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartNodeData = JSON.parse(dragStartNodeData);\n\n    let {nodeDirent, nodeParentPath, nodeRootPath} = dragStartNodeData;\n    let dropNodeData = node;\n\n    if (Array.isArray(dragStartNodeData)) { //move items\n      if (!dropNodeData) { //move items to root\n        if (dragStartNodeData[0].nodeParentPath === '/') {\n          this.setState({isTreeViewDropTipShow: false});\n          return;\n        }\n        this.props.onItemsMove(this.props.currentRepoInfo, '/');\n        this.setState({isTreeViewDropTipShow: false});\n        return;\n      }\n      this.onMoveItems(dragStartNodeData, dropNodeData, this.props.currentRepoInfo, dropNodeData.path);\n      return;\n    }\n\n    if (!dropNodeData) {\n      if (nodeParentPath === '/') {\n        this.setState({isTreeViewDropTipShow: false});\n        return;\n      }\n      this.onItemMove(this.props.currentRepoInfo, nodeDirent, '/', nodeParentPath);\n      this.setState({isTreeViewDropTipShow: false});\n      return;\n    }\n\n    if (dropNodeData.object.type !== 'dir') {\n      return;\n    }\n\n    if (nodeParentPath === dropNodeData.path) {\n      return;\n    }\n\n    // copy the dirent to itself. eg: A/B -> A/B\n    if (nodeParentPath === dropNodeData.parentNode.path) {\n      if (dropNodeData.object.name === nodeDirent.name) {\n        return;\n      }\n    }\n\n    // copy the dirent to it's child. eg: A/B -> A/B/C\n    if (dropNodeData.object.type === 'dir' && nodeDirent.type === 'dir') {\n      if (dropNodeData.parentNode.path !== nodeParentPath) {\n        let paths = Utils.getPaths(dropNodeData.path);\n        if (paths.includes(nodeRootPath)) {\n          return;\n        }\n      }\n    }\n\n    this.onItemMove(this.props.currentRepoInfo, nodeDirent, dropNodeData.path, nodeParentPath);\n  }\n\n  onMoveItems = (dragStartNodeData, dropNodeData, destRepo, destDirentPath) => {\n    let direntPaths = [];\n    let paths = Utils.getPaths(destDirentPath);\n    dragStartNodeData.forEach(dirent => {\n      let path = dirent.nodeRootPath;\n      direntPaths.push(path);\n    });\n\n    if (dropNodeData.object.type !== 'dir') {\n      return;\n    }\n\n    // move dirents to one of them. eg: A/B, A/C -> A/B\n    if (direntPaths.some(direntPath => { return direntPath === destDirentPath;})) {\n      return;\n    }\n\n    // move dirents to current path\n    if (dragStartNodeData[0].nodeParentPath && dragStartNodeData[0].nodeParentPath === dropNodeData.path ) {\n      return;\n    }\n\n    // move dirents to one of their child. eg: A/B, A/D -> A/B/C\n    let isChildPath = direntPaths.some(direntPath => {\n      return paths.includes(direntPath);\n    });\n    if (isChildPath) {\n      return;\n    }\n\n    this.props.onItemsMove(destRepo, destDirentPath);\n  }\n\n  freezeItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  unfreezeItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  onMenuItemClick = (operation, node) => {\n    this.props.onMenuItemClick(operation, node);\n    hideMenu();\n  }\n\n  onMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  onContextMenu = (event) => {\n    event.preventDefault();\n\n    let currentRepoInfo = this.props.currentRepoInfo;\n    if (currentRepoInfo.permission !== 'admin' && currentRepoInfo.permission !== 'rw') {\n      return '';\n    }\n    this.handleContextClick(event);\n  }\n\n  handleContextClick = (event, node) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    if (!this.props.isNodeMenuShow) {\n      return;\n    }\n\n    let x = event.clientX || (event.touches && event.touches[0].pageX);\n    let y = event.clientY || (event.touches && event.touches[0].pageY);\n\n    if (this.props.posX) {\n      x -= this.props.posX;\n    }\n    if (this.props.posY) {\n      y -= this.props.posY;\n    }\n\n    hideMenu();\n\n    let menuList = this.getMenuList(node);\n\n    let showMenuConfig = {\n      id: 'tree-node-contextmenu',\n      position: { x, y },\n      target: event.target,\n      currentObject: node,\n      menuList: menuList,\n    };\n\n    showMenu(showMenuConfig);\n  }\n\n  getMenuList = (node) => {\n    let menuList = [];\n\n    let { NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE, OPEN_VIA_CLIENT } = TextTranslation;\n\n    if (!node) {\n      return [NEW_FOLDER, NEW_FILE];\n    }\n\n    if (node.object.type === 'dir') {\n      menuList = [NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE];\n    } else {\n      menuList = [RENAME, DELETE, COPY, MOVE, OPEN_VIA_CLIENT];\n    }\n\n    const { userPerm } = this.props;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (!isCustomPermission) {\n      return menuList;\n    }\n\n    menuList = [];\n\n    const { create: canCreate, modify: canModify, delete: canDelete, copy: canCopy } = customPermission.permission;\n    if (!node) {\n      canCreate && menuList.push(NEW_FOLDER, NEW_FILE);\n      return menuList;\n    }\n\n    if (node.object.type === 'dir') {\n      canCreate && menuList.push(NEW_FOLDER, NEW_FILE);\n    }\n\n    canCopy && menuList.push(COPY);\n    canModify && menuList.push(MOVE, RENAME);\n    canDelete && menuList.push(DELETE);\n\n    if (node.object.type !== 'dir') { \n      menuList.push(OPEN_VIA_CLIENT);\n    }\n\n    return menuList;\n  }\n\n  onShowMenu = () => {\n    this.freezeItem();\n  }\n\n  onHideMenu = () => {\n    this.unfreezeItem();\n  }\n\n  render() {\n    return (\n      <div\n        className={`tree-view tree ${(this.state.isTreeViewDropTipShow && this.canDrop) ? 'tree-view-drop' : ''}`}\n        onDrop={this.onNodeDrop}\n        onDragEnter={this.onNodeDragEnter}\n        onDragLeave={this.onNodeDragLeave}\n        onMouseDown={this.onMouseDown}\n        onContextMenu={this.onContextMenu}\n        onClick={this.onContainerClick}\n      >\n        <TreeNodeView\n          userPerm={this.props.userPerm}\n          node={this.props.treeData.root}\n          currentPath={this.props.currentPath}\n          paddingLeft={PADDING_LEFT}\n          isNodeMenuShow={this.props.isNodeMenuShow}\n          isItemFreezed={this.state.isItemFreezed}\n          onNodeClick={this.onNodeClick}\n          onMenuItemClick={this.props.onMenuItemClick}\n          onNodeExpanded={this.props.onNodeExpanded}\n          onNodeCollapse={this.props.onNodeCollapse}\n          onNodeDragStart={this.onNodeDragStart}\n          freezeItem={this.freezeItem}\n          unfreezeItem={this.unfreezeItem}\n          onNodeDragMove={this.onNodeDragMove}\n          onNodeDrop={this.onNodeDrop}\n          onNodeDragEnter={this.onNodeDragEnter}\n          onNodeDragLeave={this.onNodeDragLeave}\n          handleContextClick={this.handleContextClick}\n        />\n        <ContextMenu\n          id={'tree-node-contextmenu'}\n          onMenuItemClick={this.onMenuItemClick}\n          onHideMenu={this.onHideMenu}\n          onShowMenu={this.onShowMenu}\n        />\n      </div>\n    );\n  }\n}\n\nTreeView.propTypes = propTypes;\n\nexport default TreeView;\n","import assign from 'object-assign';\n\nimport { store } from './helpers';\n\nexport const MENU_SHOW = 'REACT_CONTEXTMENU_SHOW';\nexport const MENU_HIDE = 'REACT_CONTEXTMENU_HIDE';\n\n\nexport function dispatchGlobalEvent(eventName, opts, target = window) {\n  // Compatibale with IE\n  // @see http://stackoverflow.com/questions/26596123/internet-explorer-9-10-11-event-constructor-doesnt-work\n  let event;\n\n  if (typeof window.CustomEvent === 'function') {\n    event = new window.CustomEvent(eventName, { detail: opts });\n  } else {\n    event = document.createEvent('CustomEvent');\n    event.initCustomEvent(eventName, false, true, opts);\n  }\n\n  if (target) {\n    target.dispatchEvent(event);\n    assign(store, opts);\n  }\n}\n\nexport function showMenu(opts = {}, target) {\n  dispatchGlobalEvent(MENU_SHOW, assign({}, opts, { type: MENU_SHOW }), target);\n}\n\nexport function hideMenu(opts = {}, target) {\n  dispatchGlobalEvent(MENU_HIDE, assign({}, opts, { type: MENU_HIDE }), target);\n}\n"],"sourceRoot":""}