(this["webpackJsonpseahub-frontend"]=this["webpackJsonpseahub-frontend"]||[]).push([[17],{1584:function(e,t,a){a(52),e.exports=a(1715)},1585:function(e,t,a){},1715:function(e,t,a){"use strict";a.r(t);var i=a(6),s=a(7),n=a(9),c=a(8),r=a(2),o=a.n(r),l=a(23),b=a.n(l),j=a(17),d=a(13),h=a.n(d),m=a(5),u=a(1),g=a(10),p=a(15),O=a(38),f=a(20),x=a(50),D=a(324),v=a(4),P=a(214),w=a.n(P),C=a(11),L=a(0),y=function(e){Object(n.a)(a,e);var t=Object(c.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).handleInputChange=function(e){s.setState({inputValue:e})},s.formSubmit=function(){var e=s.state.inputValue.map((function(e,t){return e.value})).join(","),t=s.props,a=t.repoID,i=t.commitID;s.setState({submitBtnDisabled:!0}),g.b.updateRepoCommitLabels(a,i,e).then((function(e){s.props.updateCommitLabels(e.data.revisionTags.map((function(e,t){return e.tag}))),s.props.toggleDialog(),C.a.success(Object(u.jb)("Successfully edited labels."))})).catch((function(e){var t=m.a.getErrorMsg(e);s.setState({formErrorMsg:t,submitBtnDisabled:!1})}))},s.state={inputValue:s.props.commitLabels.map((function(e,t){return{label:e,value:e}})),submitBtnDisabled:!1},s}return Object(s.a)(a,[{key:"render",value:function(){var e=this.state.formErrorMsg;return Object(L.jsxs)(v.x,{isOpen:!0,centered:!0,toggle:this.props.toggleDialog,children:[Object(L.jsx)(v.A,{toggle:this.props.toggleDialog,children:Object(u.jb)("Edit labels")}),Object(L.jsx)(v.y,{children:Object(L.jsxs)(o.a.Fragment,{children:[Object(L.jsx)(w.a,{defaultValue:this.props.commitLabels.map((function(e,t){return{label:e,value:e}})),isMulti:!0,onChange:this.handleInputChange,placeholder:""}),e&&Object(L.jsx)("p",{className:"error m-0 mt-2",children:e})]})}),Object(L.jsx)(v.z,{children:Object(L.jsx)("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:Object(u.jb)("Submit")})})]})}}]),a}(o.a.Component),M=(a(107),a(116),a(1585),window.app.pageOptions),N=M.repoID,S=M.repoName,I=M.userPerm,k=M.showLabel,_=function(e){Object(n.a)(a,e);var t=Object(c.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).getItems=function(e){g.b.getRepoHistory(N,e,s.state.perPage).then((function(t){s.setState({isLoading:!1,currentPage:e,items:t.data.data,hasNextPage:t.data.more})})).catch((function(e){s.setState({isLoading:!1,errorMsg:m.a.getErrorMsg(e,!0)})}))},s.resetPerPage=function(e){s.setState({perPage:e},(function(){s.getItems(1)}))},s.onSearchedClick=function(e){if(!0===e.is_dir){var t=u.hc+"library/"+e.repo_id+"/"+e.repo_name+e.path;Object(j.c)(t,{repalce:!0})}else{var a=u.hc+"lib/"+e.repo_id+"/file"+m.a.encodePath(e.path);window.open("about:blank").location.href=a}},s.goBack=function(e){e.preventDefault(),window.history.back()},s.state={isLoading:!0,errorMsg:"",currentPage:1,perPage:25,hasNextPage:!1,items:[]},s}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,a=this.state,i=a.currentPage,s=a.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getItems(e.state.currentPage)}))}},{key:"render",value:function(){return Object(L.jsx)(o.a.Fragment,{children:Object(L.jsxs)("div",{className:"h-100 d-flex flex-column",children:[Object(L.jsxs)("div",{className:"top-header d-flex justify-content-between",children:[Object(L.jsx)("a",{href:u.hc,children:Object(L.jsx)("img",{src:u.Hb+u.Cb,height:u.Bb,width:u.Db,title:u.ic,alt:"logo"})}),Object(L.jsx)(x.a,{onSearchedClick:this.onSearchedClick})]}),Object(L.jsx)("div",{className:"flex-auto container-fluid pt-4 pb-6 o-auto",children:Object(L.jsx)("div",{className:"row",children:Object(L.jsxs)("div",{className:"col-md-10 offset-md-1",children:[Object(L.jsx)("h2",{dangerouslySetInnerHTML:{__html:m.a.generateDialogTitle(Object(u.jb)("{placeholder} Modification History"),S)}}),Object(L.jsx)("a",{href:"#",className:"go-back",title:Object(u.jb)("Back"),onClick:this.goBack,children:Object(L.jsx)("span",{className:"fas fa-chevron-left"})}),"rw"==I&&Object(L.jsx)("p",{className:"tip",children:Object(u.jb)("Tip: a snapshot will be generated after modification, which records the library state after the modification.")}),Object(L.jsx)(B,{isLoading:this.state.isLoading,errorMsg:this.state.errorMsg,items:this.state.items,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getListByPage:this.getItems})]})})})]})})}}]),a}(o.a.Component),B=function(e){Object(n.a)(a,e);var t=Object(c.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).getPreviousPage=function(){s.props.getListByPage(s.props.currentPage-1)},s.getNextPage=function(){s.props.getListByPage(s.props.currentPage+1)},s.theadData=k?[{width:"43%",text:Object(u.jb)("Description")},{width:"12%",text:Object(u.jb)("Time")},{width:"9%",text:Object(u.jb)("Modifier")},{width:"12%",text:"".concat(Object(u.jb)("Device")," / ").concat(Object(u.jb)("Version"))},{width:"12%",text:Object(u.jb)("Labels")},{width:"12%",text:""}]:[{width:"43%",text:Object(u.jb)("Description")},{width:"15%",text:Object(u.jb)("Time")},{width:"15%",text:Object(u.jb)("Modifier")},{width:"15%",text:"".concat(Object(u.jb)("Device")," / ").concat(Object(u.jb)("Version"))},{width:"12%",text:""}],s}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.isLoading,a=e.errorMsg,i=e.items,s=e.curPerPage,n=e.currentPage,c=e.hasNextPage;return t?Object(L.jsx)(p.a,{}):a?Object(L.jsx)("p",{className:"error mt-6 text-center",children:a}):Object(L.jsxs)(o.a.Fragment,{children:[Object(L.jsxs)("table",{className:"table-hover",children:[Object(L.jsx)("thead",{children:Object(L.jsx)("tr",{children:this.theadData.map((function(e,t){return Object(L.jsx)("th",{width:e.width,children:e.text},t)}))})}),Object(L.jsx)("tbody",{children:i.map((function(e,t){return e.isFirstCommit=1==n&&0==t,e.showDetails=c||t!=i.length-1,Object(L.jsx)(E,{item:e},t)}))})]}),Object(L.jsx)(O.a,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:n,hasNextPage:c,curPerPage:s,resetPerPage:this.props.resetPerPage})]})}}]),a}(o.a.Component),E=function(e){Object(n.a)(a,e);var t=Object(c.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).handleMouseOver=function(){s.setState({isIconShown:!0})},s.handleMouseOut=function(){s.setState({isIconShown:!1})},s.showCommitDetails=function(e){e.preventDefault(),s.setState({isCommitDetailsDialogOpen:!s.state.isCommitDetailsDialogOpen})},s.toggleCommitDetailsDialog=function(){s.setState({isCommitDetailsDialogOpen:!s.state.isCommitDetailsDialogOpen})},s.editLabel=function(){s.setState({isCommitLabelUpdateDialogOpen:!s.state.isCommitLabelUpdateDialogOpen})},s.toggleLabelEditDialog=function(){s.setState({isCommitLabelUpdateDialogOpen:!s.state.isCommitLabelUpdateDialogOpen})},s.updateLabels=function(e){s.setState({labels:e})},s.state={labels:s.props.item.tags,isIconShown:!1,isCommitLabelUpdateDialogOpen:!1,isCommitDetailsDialogOpen:!1},s}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.item,t=this.state,a=t.isIconShown,i=t.isCommitLabelUpdateDialogOpen,s=t.isCommitDetailsDialogOpen,n=t.labels,c="";return c=e.email?e.second_parent_id?Object(u.jb)("None"):Object(L.jsx)("a",{href:"".concat(u.hc,"profile/").concat(encodeURIComponent(e.email),"/"),children:e.name}):Object(u.jb)("Unknown"),Object(L.jsxs)(o.a.Fragment,{children:[Object(L.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[Object(L.jsxs)("td",{children:[e.description,e.showDetails&&Object(L.jsx)("a",{href:"#",className:"details",onClick:this.showCommitDetails,children:Object(u.jb)("Details")})]}),Object(L.jsx)("td",{title:h()(e.time).format("LLLL"),children:h()(e.time).format("YYYY-MM-DD")}),Object(L.jsx)("td",{children:c}),Object(L.jsx)("td",{children:e.client_version?"".concat(e.device_name," / ").concat(e.client_version):"API / --"}),k&&Object(L.jsxs)("td",{children:[n.map((function(e,t){return Object(L.jsx)("span",{className:"commit-label",children:e},t)})),"rw"==I&&Object(L.jsx)("span",{className:"attr-action-icon fa fa-pencil-alt ".concat(a?"":"invisible"),title:Object(u.jb)("Edit"),onClick:this.editLabel})]}),Object(L.jsx)("td",{children:"rw"==I&&(e.isFirstCommit?Object(L.jsx)("span",{className:a?"":"invisible",children:Object(u.jb)("Current Version")}):Object(L.jsx)("a",{href:"".concat(u.hc,"repo/").concat(N,"/snapshot/?commit_id=").concat(e.commit_id),className:a?"":"invisible",children:Object(u.jb)("View Snapshot")}))})]}),s&&Object(L.jsx)(f.a,{children:Object(L.jsx)(D.a,{repoID:N,commitID:e.commit_id,commitTime:e.time,toggleDialog:this.toggleCommitDetailsDialog})}),i&&Object(L.jsx)(f.a,{children:Object(L.jsx)(y,{repoID:N,commitID:e.commit_id,commitLabels:n,updateCommitLabels:this.updateLabels,toggleDialog:this.toggleLabelEditDialog})})]})}}]),a}(o.a.Component);b.a.render(Object(L.jsx)(_,{}),document.getElementById("wrapper"))},324:function(e,t,a){"use strict";var i=a(6),s=a(7),n=a(9),c=a(8),r=a(2),o=a.n(r),l=a(4),b=a(13),j=a.n(b),d=a(1),h=a(10),m=a(5),u=a(15),g=(a(529),a(0)),p=function(e){Object(n.a)(a,e);var t=Object(c.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).state={isLoading:!0,errorMsg:""},s}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.repoID,i=t.commitID;h.b.getCommitDetails(a,i).then((function(t){e.setState({isLoading:!1,errorMsg:"",commitDetails:t.data})})).catch((function(t){var a=m.a.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:a})}))}},{key:"render",value:function(){var e=this.props,t=e.toggleDialog;e.commitTime;return Object(g.jsxs)(l.x,{isOpen:!0,centered:!0,toggle:t,children:[Object(g.jsx)(l.A,{toggle:t,children:Object(d.jb)("Modification Details")}),Object(g.jsxs)(l.y,{children:[Object(g.jsx)("p",{className:"small",children:j()(this.props.commitTime).format("YYYY-MM-DD HH:mm:ss")}),Object(g.jsx)(O,{data:this.state})]})]})}}]),a}(o.a.Component),O=function(e){Object(n.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).renderDetails=function(e){for(var t=[{type:"new",title:Object(d.jb)("New files")},{type:"removed",title:Object(d.jb)("Deleted files")},{type:"renamed",title:Object(d.jb)("Renamed or Moved files")},{type:"modified",title:Object(d.jb)("Modified files")},{type:"newdir",title:Object(d.jb)("New directories")},{type:"deldir",title:Object(d.jb)("Deleted directories")}],a=!0,i=0,s=t.length;i<s;i++)if(e[t[i].type].length){a=!1;break}return a?Object(g.jsx)("p",{children:e.cmt_desc}):Object(g.jsx)(o.a.Fragment,{children:t.map((function(t,a){if(e[t.type].length)return Object(g.jsxs)(o.a.Fragment,{children:[Object(g.jsx)("h6",{children:t.title}),Object(g.jsx)("ul",{children:e[t.type].map((function(e,t){return Object(g.jsx)("li",{dangerouslySetInnerHTML:{__html:e},className:"commit-detail-item"},t)}))})]},a)}))})},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,a=e.errorMsg,i=e.commitDetails;return t?Object(g.jsx)(u.a,{}):a?Object(g.jsx)("p",{className:"error mt-4 text-center",children:a}):this.renderDetails(i)}}]),a}(o.a.Component);t.a=p},529:function(e,t,a){}},[[1584,1,0]]]);
//# sourceMappingURL=repoHistory.chunk.js.map