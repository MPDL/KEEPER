{"version":3,"sources":["components/dialog/confirm-restore-repo.js","repo-snapshot.js"],"names":["ConfirmRestoreRepo","props","action","setState","btnDisabled","restoreRepo","state","this","toggle","formActionURL","csrfToken","centered","isOpen","gettext","color","onClick","disabled","Component","window","app","pageOptions","repoID","repoName","canRestoreRepo","commitID","commitTime","commitDesc","commitRelativeTime","showAuthor","authorAvatarURL","authorName","authorNickName","RepoSnapshot","toggleDialog","isConfirmDialogOpen","onSearchedClick","selectedItem","is_dir","url","siteRoot","repo_id","repo_name","path","navigate","repalce","Utils","encodePath","open","location","href","goBack","e","preventDefault","history","back","renderFolder","folderPath","folderItems","isLoading","seafileAPI","listCommitDir","then","res","data","dirent_list","catch","error","errorMsg","getErrorMsg","clickFolderPath","renderPath","pathList","split","Fragment","bind","map","item","index","length","slice","join","revertRepo","toaster","success","danger","className","src","mediaUrl","logoPath","height","logoHeight","width","logoWidth","title","siteTitle","alt","generateDialogTitle","role","aria-label","encodeURIComponent","dangerouslySetInnerHTML","__html","React","Content","theadData","text","FolderItem","handleMouseOver","isIconShown","handleMouseOut","restoreItem","joinPath","name","type","revertFolder","revertFile","onMouseOver","onMouseOut","onFocus","getFolderIconUrl","getFileIconUrl","obj_id","target","bytesToSize","size","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/repoSnapshot.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  restoreRepo: PropTypes.func.isRequired,\n  toggle: PropTypes.func.isRequired\n};\n\nclass ConfirmRestoreRepo extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      btnDisabled: false\n    };\n  }\n\n  action = () => {\n    this.setState({\n      btnDisabled: true\n    });\n    this.props.restoreRepo();\n  }\n\n  render() {\n    const {formActionURL, csrfToken, toggle} = this.props;\n    return (\n      <Modal centered={true} isOpen={true} toggle={toggle}>\n        <ModalHeader toggle={toggle}>{gettext('Restore Library')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Are you sure you want to restore this library?')}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.action} disabled={this.state.btnDisabled}>{gettext('Restore')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nConfirmRestoreRepo.propTypes = propTypes;\n\nexport default ConfirmRestoreRepo;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { navigate } from '@reach/router';\nimport { Utils } from './utils/utils';\nimport { gettext, siteRoot, mediaUrl, logoPath, logoWidth, logoHeight, siteTitle } from './utils/constants';\nimport { seafileAPI } from './utils/seafile-api';\nimport Loading from './components/loading';\nimport ModalPortal from './components/modal-portal';\nimport toaster from './components/toast';\nimport CommonToolbar from './components/toolbar/common-toolbar';\nimport ConfirmRestoreRepo from './components/dialog/confirm-restore-repo';\n\nimport './css/toolbar.css';\nimport './css/search.css';\n\nimport './css/repo-snapshot.css';\n\nconst {\n  repoID, repoName, canRestoreRepo,\n  commitID, commitTime, commitDesc, commitRelativeTime,\n  showAuthor, authorAvatarURL, authorName, authorNickName\n} = window.app.pageOptions;\n\nclass RepoSnapshot extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errorMsg: '',\n      folderPath: '/',\n      folderItems: [],\n      isConfirmDialogOpen: false\n    };\n  }\n\n  componentDidMount() {\n    this.renderFolder(this.state.folderPath);\n  }\n\n  toggleDialog = () => {\n    this.setState({\n      isConfirmDialogOpen: !this.state.isConfirmDialogOpen\n    });\n  }\n\n  onSearchedClick = (selectedItem) => {\n    if (selectedItem.is_dir === true) {\n      let url = siteRoot + 'library/' + selectedItem.repo_id + '/' + selectedItem.repo_name + selectedItem.path;\n      navigate(url, {repalce: true});\n    } else {\n      let url = siteRoot + 'lib/' + selectedItem.repo_id + '/file' + Utils.encodePath(selectedItem.path);\n      let newWindow = window.open('about:blank');\n      newWindow.location.href = url;\n    }\n  }\n\n  goBack = (e) => {\n    e.preventDefault();\n    window.history.back();\n  }\n\n  renderFolder = (folderPath) => {\n    this.setState({\n      folderPath: folderPath,\n      folderItems: [],\n      isLoading: true\n    });\n\n    seafileAPI.listCommitDir(repoID, commitID, folderPath).then((res) => {\n      this.setState({\n        isLoading: false,\n        folderItems: res.data.dirent_list\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  clickFolderPath = (folderPath, e) => {\n    e.preventDefault();\n    this.renderFolder(folderPath);\n  }\n\n  renderPath = () => {\n    const path = this.state.folderPath;\n    const pathList = path.split('/');\n\n    if (path == '/') {\n      return repoName;\n    }\n\n    return (\n      <React.Fragment>\n        <a href=\"#\" onClick={this.clickFolderPath.bind(this, '/')}>{repoName}</a>\n        <span> / </span>\n        {pathList.map((item, index) => {\n          if (index > 0 && index != pathList.length - 1) {\n            return (\n              <React.Fragment key={index}>\n                <a href=\"#\" onClick={this.clickFolderPath.bind(this, pathList.slice(0, index+1).join('/'))}>{pathList[index]}</a>\n                <span> / </span>\n              </React.Fragment>\n            );\n          }\n        }\n        )}\n        {pathList[pathList.length - 1]}\n      </React.Fragment>\n    );\n  }\n\n  restoreRepo = () => {\n    seafileAPI.revertRepo(repoID, commitID).then((res) => {\n      this.toggleDialog();\n      toaster.success(gettext('Successfully restored the library.'));\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.toggleDialog();\n      toaster.danger(errorMsg);\n    });\n  }\n\n  render() {\n    const { isConfirmDialogOpen, folderPath } = this.state;\n\n    return (\n      <React.Fragment>\n        <div className=\"h-100 d-flex flex-column\">\n          <div className=\"top-header d-flex justify-content-between\">\n            <a href={siteRoot}>\n              <img src={mediaUrl + logoPath} height={logoHeight} width={logoWidth} title={siteTitle} alt=\"logo\" />\n            </a>\n            <CommonToolbar onSearchedClick={this.onSearchedClick} />\n          </div>\n          <div className=\"flex-auto container-fluid pt-4 pb-6 o-auto\">\n            <div className=\"row\">\n              <div className=\"col-md-10 offset-md-1\">\n                <h2>\n                  <span>{Utils.generateDialogTitle(gettext('{placeholder} Snapshot'), repoName)}</span>\n                  <span className=\"heading-commit-time ml-1\">({commitTime})</span>\n                </h2>\n                <a href=\"#\" className=\"go-back\" title={gettext('Back')} role=\"button\" aria-label={gettext('Back')} onClick={this.goBack}>\n                  <span className=\"fas fa-chevron-left\"></span>\n                </a>\n                {folderPath == '/' && (\n                  <div className=\"d-flex mb-2 align-items-center\">\n                    <p className=\"m-0\">{commitDesc}</p>\n                    <div className=\"ml-4 border-left pl-4 d-flex align-items-center\">\n                      {showAuthor ? (\n                        <React.Fragment>\n                          <img src={authorAvatarURL} width=\"20\" height=\"20\" alt=\"\" className=\"rounded mr-1\" />\n                          <a href={`${siteRoot}profile/${encodeURIComponent(authorName)}/`}>{authorNickName}</a>\n                        </React.Fragment>\n                      ) : <span>{gettext('Unknown')}</span>}\n                      <p className=\"m-0 ml-2\" dangerouslySetInnerHTML={{__html: commitRelativeTime}}></p>\n                    </div>\n                  </div>\n                )}\n                <div className=\"d-flex justify-content-between align-items-center op-bar\">\n                  <p className=\"m-0\">{gettext('Current path: ')}{this.renderPath()}</p>\n                  {(folderPath == '/' && canRestoreRepo) &&\n                  <button className=\"btn btn-secondary op-bar-btn\" onClick={this.toggleDialog}>{gettext('Restore')}</button>\n                  }\n                </div>\n                <Content\n                  data={this.state}\n                  renderFolder={this.renderFolder}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n        {isConfirmDialogOpen &&\n        <ModalPortal>\n          <ConfirmRestoreRepo\n            restoreRepo={this.restoreRepo}\n            toggle={this.toggleDialog}\n          />\n        </ModalPortal>\n        }\n      </React.Fragment>\n    );\n  }\n}\n\nclass Content extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.theadData = [\n      {width: '5%', text: ''},\n      {width: '55%', text: gettext('Name')},\n      {width: '20%', text: gettext('Size')},\n      {width: '20%', text: ''}\n    ];\n  }\n\n  render() {\n    const { isLoading, errorMsg, folderPath, folderItems } = this.props.data;\n\n    if (isLoading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error mt-6 text-center\">{errorMsg}</p>;\n    }\n\n    return (\n      <table className=\"table-hover\">\n        <thead>\n          <tr>\n            {this.theadData.map((item, index) => {\n              return <th key={index} width={item.width}>{item.text}</th>;\n            })}\n          </tr>\n        </thead>\n        <tbody>\n          {folderItems.map((item, index) => {\n            return <FolderItem\n              key={index}\n              item={item}\n              folderPath={folderPath}\n              renderFolder={this.props.renderFolder}\n            />;\n          })\n          }\n        </tbody>\n      </table>\n    );\n  }\n}\n\nclass FolderItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isIconShown: false\n    };\n  }\n\n  handleMouseOver = () => {\n    this.setState({isIconShown: true});\n  }\n\n  handleMouseOut = () => {\n    this.setState({isIconShown: false});\n  }\n\n  restoreItem = (e) => {\n    e.preventDefault();\n\n    const item = this.props.item;\n    const path = Utils.joinPath(this.props.folderPath, item.name);\n    const request = item.type == 'dir' ?\n      seafileAPI.revertFolder(repoID, path, commitID):\n      seafileAPI.revertFile(repoID, path, commitID);\n    request.then((res) => {\n      toaster.success(gettext('Successfully restored 1 item.'));\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n    });\n  }\n\n  renderFolder = (e) => {\n    e.preventDefault();\n\n    const item = this.props.item;\n    const { folderPath } = this.props;\n    this.props.renderFolder(Utils.joinPath(folderPath, item.name));\n  }\n\n  render() {\n    const item = this.props.item;\n    const { isIconShown } = this.state;\n    const { folderPath } = this.props;\n\n    return item.type == 'dir' ? (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td className=\"text-center\"><img src={Utils.getFolderIconUrl()} alt={gettext('Directory')} width=\"24\" /></td>\n        <td><a href=\"#\" onClick={this.renderFolder}>{item.name}</a></td>\n        <td></td>\n        <td>\n          <a href=\"#\" className={`action-icon sf2-icon-reply ${isIconShown ? '': 'invisible'}`} onClick={this.restoreItem} title={gettext('Restore')} aria-label={gettext('Restore')} role=\"button\"></a>\n        </td>\n      </tr>\n    ) : (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td className=\"text-center\"><img src={Utils.getFileIconUrl(item.name)} alt={gettext('File')} width=\"24\" /></td>\n        <td><a href={`${siteRoot}repo/${repoID}/snapshot/files/?obj_id=${item.obj_id}&commit_id=${commitID}&p=${encodeURIComponent(Utils.joinPath(folderPath, item.name))}`} target=\"_blank\">{item.name}</a></td>\n        <td>{Utils.bytesToSize(item.size)}</td>\n        <td>\n          <a href=\"#\" className={`action-icon sf2-icon-reply ${isIconShown ? '': 'invisible'}`} onClick={this.restoreItem} title={gettext('Restore')} aria-label={gettext('Restore')} role=\"button\"></a>\n          <a href={`${siteRoot}repo/${repoID}/${item.obj_id}/download/?file_name=${encodeURIComponent(item.name)}&p=${encodeURIComponent(Utils.joinPath(folderPath, item.name))}`} className={`action-icon sf2-icon-download ${isIconShown ? '': 'invisible'}`} title={gettext('Download')}></a>\n        </td>\n      </tr>\n    );\n  }\n}\n\nReactDOM.render(\n  <RepoSnapshot />,\n  document.getElementById('wrapper')\n);\n"],"sourceRoot":""}