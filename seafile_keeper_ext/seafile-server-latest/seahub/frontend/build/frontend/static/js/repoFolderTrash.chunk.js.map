{"version":3,"sources":["components/dialog/clean-trash.js","repo-folder-trash.js"],"names":["CleanTrash","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","handleInputChange","value","setState","inputValue","formSubmit","state","repoID","submitBtnDisabled","seafileAPI","deleteRepoTrash","then","res","toaster","success","gettext","refreshTrash","toggleDialog","catch","error","errorMsg","Utils","getErrorMsg","formErrorMsg","options","label","_createClass","key","this","_jsxs","Modal","isOpen","centered","toggle","children","_jsx","ModalHeader","ModalBody","React","Fragment","Select","defaultValue","autoFocus","onChange","placeholder","className","ModalFooter","disabled","onClick","Component","_window$app$pageOptio","window","app","pageOptions","repoFolderName","path","enableClean","RepoFolderTrash","getItems","scanStat","getRepoFolderTrash","_res$data","data","more","scan_stat","length","isLoading","items","concat","getMore","onSearchedClick","selectedItem","is_dir","url","siteRoot","repo_id","repo_name","navigate","repalce","encodePath","open","location","href","goBack","e","preventDefault","history","back","cleanTrash","toggleCleanTrashDialog","isCleanTrashDialogOpen","showFolder","renderFolder","commitID","baseDir","folderPath","folderItems","listCommitDir","substr","dirent_list","response","status","clickRoot","clickFolderPath","_this$state","renderFolderPath","pathList","split","map","item","index","bind","_assertThisInitialized","slice","join","_jsx2","_this$state2","src","mediaUrl","logoPath","height","logoHeight","width","logoWidth","title","siteTitle","alt","CommonToolbar","generateDialogTitle","role","_defineProperty","Content","ModalPortal","_React$Component2","_super2","_this2","theadData","text","_this3","_this$props$data","FolderItem","Item","Loading","_React$Component3","_super3","_this4","handleMouseOver","isIconShown","handleMouseOut","restoreItem","commit_id","parent_dir","obj_name","restoreFolder","restoreFile","restored","error_msg","danger","joinPath","_this$state3","onMouseOver","onMouseOut","onFocus","getFolderIconUrl","moment","deleted_time","format","getFileIconUrl","obj_id","encodeURIComponent","target","bytesToSize","size","_React$Component4","_super4","_this5","_this5$props","name","_this$props","type","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/repoFolderTrash.chunk.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport Select from 'react-select/lib/Creatable';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  refreshTrash: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass CleanTrash extends React.Component {\n  constructor(props) {\n    super(props);\n    this.options = [\n      {label: gettext('3 days ago'), value: 3},\n      {label: gettext('1 week ago'), value: 7},\n      {label: gettext('1 month ago'), value: 30},\n      {label: gettext('all'), value: 0}\n    ];\n    this.state = {\n      inputValue: this.options[0],\n      submitBtnDisabled: false\n    };\n  }\n\n  handleInputChange = (value) => {\n    this.setState({\n      inputValue: value\n    });\n  }\n\n  formSubmit = () => {\n    const inputValue = this.state.inputValue;\n    const { repoID } = this.props;\n\n    this.setState({\n      submitBtnDisabled: true\n    });\n\n    seafileAPI.deleteRepoTrash(repoID, inputValue.value).then((res) => {\n      toaster.success(gettext('Clean succeeded.'));\n      this.props.refreshTrash();\n      this.props.toggleDialog();\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        formErrorMsg: errorMsg,\n        submitBtnDisabled: false\n      });\n    });\n  }\n\n  render() {\n    const { formErrorMsg } = this.state;\n    return (\n      <Modal isOpen={true} centered={true} toggle={this.props.toggleDialog}>\n        <ModalHeader toggle={this.props.toggleDialog}>{gettext('Clean')}</ModalHeader>\n        <ModalBody>\n          <React.Fragment>\n            <p>{gettext('Clear files in trash and history：')}</p>\n            <Select\n              defaultValue={this.options[0]}\n              options={this.options}\n              autoFocus={false}\n              onChange={this.handleInputChange}\n              placeholder=''\n            />\n            {formErrorMsg && <p className=\"error m-0 mt-2\">{formErrorMsg}</p>}\n          </React.Fragment>\n        </ModalBody>\n        <ModalFooter>\n          <button className=\"btn btn-primary\" disabled={this.state.submitBtnDisabled} onClick={this.formSubmit}>{gettext('Submit')}</button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCleanTrash.propTypes = propTypes;\n\nexport default CleanTrash;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { navigate } from '@reach/router';\nimport moment from 'moment';\nimport { Utils } from './utils/utils';\nimport { gettext, siteRoot, mediaUrl, logoPath, logoWidth, logoHeight, siteTitle } from './utils/constants';\nimport { seafileAPI } from './utils/seafile-api';\nimport Loading from './components/loading';\nimport ModalPortal from './components/modal-portal';\nimport toaster from './components/toast';\nimport CommonToolbar from './components/toolbar/common-toolbar';\nimport CleanTrash from './components/dialog/clean-trash';\n\nimport './css/toolbar.css';\nimport './css/search.css';\n\nimport './css/repo-folder-trash.css';\n\nconst {\n  repoID,\n  repoFolderName,\n  path,\n  enableClean\n} = window.app.pageOptions;\n\nclass RepoFolderTrash extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errorMsg: '',\n      items: [],\n      scanStat: null,\n      more: false,\n      isCleanTrashDialogOpen: false\n    };\n  }\n\n  componentDidMount() {\n    this.getItems();\n  }\n\n  getItems = (scanStat) => {\n    seafileAPI.getRepoFolderTrash(repoID, path, scanStat).then((res) => {\n      const { data, more, scan_stat } = res.data;\n      if (!data.length && more) {\n        this.getItems(scan_stat);\n      } else {\n        this.setState({\n          isLoading: false,\n          items: this.state.items.concat(data),\n          more: more,\n          scanStat: scan_stat\n        });\n      }\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  getMore = () => {\n    this.setState({\n      isLoading: true\n    });\n    this.getItems(this.state.scanStat);\n  }\n\n  onSearchedClick = (selectedItem) => {\n    if (selectedItem.is_dir === true) {\n      let url = siteRoot + 'library/' + selectedItem.repo_id + '/' + selectedItem.repo_name + selectedItem.path;\n      navigate(url, {repalce: true});\n    } else {\n      let url = siteRoot + 'lib/' + selectedItem.repo_id + '/file' + Utils.encodePath(selectedItem.path);\n      let newWindow = window.open('about:blank');\n      newWindow.location.href = url;\n    }\n  }\n\n  goBack = (e) => {\n    e.preventDefault();\n    window.history.back();\n  }\n\n  cleanTrash = () => {\n    this.toggleCleanTrashDialog();\n  }\n\n  toggleCleanTrashDialog = () => {\n    this.setState({\n      isCleanTrashDialogOpen: !this.state.isCleanTrashDialogOpen\n    });\n  }\n\n  refreshTrash = () => {\n    this.setState({\n      isLoading: true,\n      errorMsg: '',\n      items: [],\n      scanStat: null,\n      more: false,\n      showFolder: false\n    });\n    this.getItems();\n  }\n\n  renderFolder = (commitID, baseDir, folderPath) => {\n    this.setState({\n      showFolder: true,\n      commitID: commitID,\n      baseDir: baseDir,\n      folderPath: folderPath,\n      folderItems: [],\n      isLoading: true\n    });\n\n    seafileAPI.listCommitDir(repoID, commitID, `${baseDir.substr(0, baseDir.length - 1)}${folderPath}`).then((res) => {\n      this.setState({\n        isLoading: false,\n        folderItems: res.data.dirent_list\n      });\n    }).catch((error) => {\n      if (error.response) {\n        if (error.response.status == 403) {\n          this.setState({\n            isLoading: false,\n            errorMsg: gettext('Permission denied')\n          });\n        } else {\n          this.setState({\n            isLoading: false,\n            errorMsg: gettext('Error')\n          });\n        }\n      } else {\n        this.setState({\n          isLoading: false,\n          errorMsg: gettext('Please check the network.')\n        });\n      }\n    });\n  }\n\n  clickRoot = (e) => {\n    e.preventDefault();\n    this.refreshTrash();\n  }\n\n  clickFolderPath = (folderPath, e) => {\n    e.preventDefault();\n    const { commitID, baseDir } = this.state;\n    this.renderFolder(commitID, baseDir, folderPath);\n  }\n\n  renderFolderPath = () => {\n    const pathList = this.state.folderPath.split('/');\n    return (\n      <React.Fragment>\n        <a href=\"#\" onClick={this.clickRoot}>{repoFolderName}</a>\n        <span> / </span>\n        {pathList.map((item, index) => {\n          if (index > 0 && index != pathList.length - 1) {\n            return (\n              <React.Fragment key={index}>\n                <a href=\"#\" onClick={this.clickFolderPath.bind(this, pathList.slice(0, index+1).join('/'))}>{pathList[index]}</a>\n                <span> / </span>\n              </React.Fragment>\n            );\n          }\n        }\n        )}\n        {pathList[pathList.length - 1]}\n      </React.Fragment>\n    );\n  }\n\n  render() {\n    const { isCleanTrashDialogOpen, showFolder } = this.state;\n\n    return (\n      <React.Fragment>\n        <div className=\"h-100 d-flex flex-column\">\n          <div className=\"top-header d-flex justify-content-between\">\n            <a href={siteRoot}>\n              <img src={mediaUrl + logoPath} height={logoHeight} width={logoWidth} title={siteTitle} alt=\"logo\" />\n            </a>\n            <CommonToolbar onSearchedClick={this.onSearchedClick} />\n          </div>\n          <div className=\"flex-auto container-fluid pt-4 pb-6 o-auto\">\n            <div className=\"row\">\n              <div className=\"col-md-10 offset-md-1\">\n                <h2>{Utils.generateDialogTitle(gettext('{placeholder} Trash'), repoFolderName)}</h2>\n                <a href=\"#\" className=\"go-back\" title={gettext('Back')} onClick={this.goBack} role=\"button\" role={gettext('Back')}>\n                  <span className=\"fas fa-chevron-left\"></span>\n                </a>\n                <div className=\"d-flex justify-content-between align-items-center op-bar\">\n                  <p className=\"m-0\">{gettext('Current path: ')}{showFolder ? this.renderFolderPath() : repoFolderName}</p>\n                  {(path == '/' && enableClean && !showFolder) &&\n                  <button className=\"btn btn-secondary clean\" onClick={this.cleanTrash}>{gettext('Clean')}</button>\n                  }\n                </div>\n                <Content\n                  data={this.state}\n                  getMore={this.getMore}\n                  renderFolder={this.renderFolder}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n        {isCleanTrashDialogOpen &&\n        <ModalPortal>\n          <CleanTrash\n            repoID={repoID}\n            refreshTrash={this.refreshTrash}\n            toggleDialog={this.toggleCleanTrashDialog}\n          />\n        </ModalPortal>\n        }\n      </React.Fragment>\n    );\n  }\n}\n\nclass Content extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.theadData = [\n      {width: '5%', text: ''},\n      {width: '45%', text: gettext('Name')},\n      {width: '20%', text: gettext('Delete Time')},\n      {width: '15%', text: gettext('Size')},\n      {width: '15%', text: ''}\n    ];\n  }\n\n  render() {\n    const { isLoading, errorMsg, items, more, showFolder, commitID, baseDir, folderPath, folderItems } = this.props.data;\n\n    return (\n      <React.Fragment>\n        <table className=\"table-hover\">\n          <thead>\n            <tr>\n              {this.theadData.map((item, index) => {\n                return <th key={index} width={item.width}>{item.text}</th>;\n              })}\n            </tr>\n          </thead>\n          <tbody>\n            {showFolder ?\n              folderItems.map((item, index) => {\n                return <FolderItem\n                  key={index}\n                  item={item}\n                  commitID={commitID}\n                  baseDir={baseDir}\n                  folderPath={folderPath}\n                  renderFolder={this.props.renderFolder}\n                />;\n              }) :\n              items.map((item, index) => {\n                return <Item\n                  key={index}\n                  item={item}\n                  renderFolder={this.props.renderFolder}\n                />;\n              })}\n          </tbody>\n        </table>\n        {isLoading && <Loading />}\n        {errorMsg && <p className=\"error mt-6 text-center\">{errorMsg}</p>}\n        {(more && !isLoading && !showFolder) && (\n          <button className=\"btn btn-block more mt-6\" onClick={this.props.getMore}>{gettext('More')}</button>\n        )}\n      </React.Fragment>\n    );\n  }\n}\n\nclass Item extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      restored: false,\n      isIconShown: false\n    };\n  }\n\n  handleMouseOver = () => {\n    this.setState({isIconShown: true});\n  }\n\n  handleMouseOut = () => {\n    this.setState({isIconShown: false});\n  }\n\n  restoreItem = (e) => {\n    e.preventDefault();\n\n    const item = this.props.item;\n    const { commit_id, parent_dir, obj_name } = item;\n    const path = parent_dir + obj_name;\n    const request = item.is_dir ?\n      seafileAPI.restoreFolder(repoID, commit_id, path) :\n      seafileAPI.restoreFile(repoID, commit_id, path);\n    request.then((res) => {\n      this.setState({\n        restored: true\n      });\n      toaster.success(gettext('Successfully restored 1 item.'));\n    }).catch((error) => {\n      let errorMsg = '';\n      if (error.response) {\n        errorMsg = error.response.data.error_msg || gettext('Error');\n      } else {\n        errorMsg = gettext('Please check the network.');\n      }\n      toaster.danger(errorMsg);\n    });\n  }\n\n  renderFolder = (e) => {\n    e.preventDefault();\n    const item = this.props.item;\n    this.props.renderFolder(item.commit_id, item.parent_dir, Utils.joinPath('/', item.obj_name));\n  }\n\n  render() {\n    const item = this.props.item;\n    const { restored, isIconShown } = this.state;\n\n    if (restored) {\n      return null;\n    }\n\n    return item.is_dir ? (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td className=\"text-center\"><img src={Utils.getFolderIconUrl()} alt={gettext('Directory')} width=\"24\" /></td>\n        <td><a href=\"#\" onClick={this.renderFolder}>{item.obj_name}</a></td>\n        <td title={moment(item.deleted_time).format('LLLL')}>{moment(item.deleted_time).format('YYYY-MM-DD')}</td>\n        <td></td>\n        <td>\n          <a href=\"#\" className={isIconShown ? '': 'invisible'} onClick={this.restoreItem} role=\"button\">{gettext('Restore')}</a>\n        </td>\n      </tr>\n    ) : (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td className=\"text-center\"><img src={Utils.getFileIconUrl(item.obj_name)} alt={gettext('File')} width=\"24\" /></td>\n        <td><a href={`${siteRoot}repo/${repoID}/trash/files/?obj_id=${item.obj_id}&commit_id=${item.commit_id}&base=${encodeURIComponent(item.parent_dir)}&p=${encodeURIComponent('/' + item.obj_name)}`} target=\"_blank\">{item.obj_name}</a></td>\n        <td title={moment(item.deleted_time).format('LLLL')}>{moment(item.deleted_time).format('YYYY-MM-DD')}</td>\n        <td>{Utils.bytesToSize(item.size)}</td>\n        <td>\n          <a href=\"#\" className={isIconShown ? '': 'invisible'} onClick={this.restoreItem} role=\"button\">{gettext('Restore')}</a>\n        </td>\n      </tr>\n    );\n  }\n}\n\nclass FolderItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isIconShown: false\n    };\n  }\n\n  handleMouseOver = () => {\n    this.setState({isIconShown: true});\n  }\n\n  handleMouseOut = () => {\n    this.setState({isIconShown: false});\n  }\n\n  renderFolder = (e) => {\n    e.preventDefault();\n\n    const item = this.props.item;\n    const { commitID, baseDir, folderPath } = this.props;\n    this.props.renderFolder(commitID, baseDir, Utils.joinPath(folderPath, item.name));\n  }\n\n  render() {\n    const item = this.props.item;\n    const { isIconShown } = this.state;\n    const { commitID, baseDir, folderPath } = this.props;\n\n    return item.type == 'dir' ? (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\n        <td className=\"text-center\"><img src={Utils.getFolderIconUrl()} alt={gettext('Directory')} width=\"24\" /></td>\n        <td><a href=\"#\" onClick={this.renderFolder}>{item.name}</a></td>\n        <td></td>\n        <td></td>\n        <td></td>\n      </tr>\n    ) : (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\n        <td className=\"text-center\"><img src={Utils.getFileIconUrl(item.name)} alt={gettext('File')} width=\"24\" /></td>\n        <td><a href={`${siteRoot}repo/${repoID}/trash/files/?obj_id=${item.obj_id}&commit_id=${commitID}&base=${encodeURIComponent(baseDir)}&p=${encodeURIComponent(Utils.joinPath(folderPath, item.name))}`} target=\"_blank\">{item.name}</a></td>\n        <td></td>\n        <td>{Utils.bytesToSize(item.size)}</td>\n        <td></td>\n      </tr>\n    );\n  }\n}\n\nReactDOM.render(\n  <RepoFolderTrash />,\n  document.getElementById('wrapper')\n);\n"],"sourceRoot":""}