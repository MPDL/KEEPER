(this["webpackJsonpseahub-frontend"]=this["webpackJsonpseahub-frontend"]||[]).push([[38],{1784:function(e,t,n){n(71),e.exports=n(1785)},1785:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n(5),c=n(7),o=n(6),i=n(2),s=n.n(i),u=n(28),f=n.n(u),b=n(8),d=n(1),h=n(206),j=n(166),p=n(19),O=(n(560),n(0)),l=window.app.pageOptions,g=l.repoID,m=l.filePath,v=l.err,x=l.commitID,w=l.fileType,k=l.fileName,L=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){return Object(O.jsx)(h.a,{content:Object(O.jsx)(y,{})})}}]),n}(s.a.Component),y=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).setIframeHeight=function(e){var t=e.currentTarget;t.height=t.contentDocument.body.scrollHeight},r.state={isLoading:!v,errorMsg:""},r}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;if(!v){!function t(){b.b.queryOfficeFileConvertStatus(g,x,m,w.toLowerCase()).then((function(n){switch(n.data.status){case"QUEUED":case"PROCESSING":e.setState({isLoading:!0}),setTimeout(t,2e3);break;case"ERROR":e.setState({isLoading:!1,errorMsg:Object(d.pb)("Document convertion failed.")});break;case"DONE":e.setState({isLoading:!1,errorMsg:""})}})).catch((function(t){t.response?e.setState({isLoading:!1,errorMsg:Object(d.pb)("Document convertion failed.")}):e.setState({isLoading:!1,errorMsg:Object(d.pb)("Please check the network.")})}))}()}}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.errorMsg;return v?Object(O.jsx)(j.a,{}):t?Object(O.jsx)(p.a,{}):n?Object(O.jsx)(j.a,{errorMsg:n}):Object(O.jsx)("div",{className:"file-view-content flex-1 spreadsheet-file-view",children:Object(O.jsx)("iframe",{id:"spreadsheet-container",title:k,src:"".concat(d.qc,"office-convert/static/").concat(g,"/").concat(x).concat(encodeURIComponent(m),"/index.html"),onLoad:this.setIframeHeight})})}}]),n}(s.a.Component);f.a.render(Object(O.jsx)(L,{}),document.getElementById("wrapper"))},560:function(e,t,n){}},[[1784,1,0]]]);
//# sourceMappingURL=viewFileSpreadsheet.chunk.js.map