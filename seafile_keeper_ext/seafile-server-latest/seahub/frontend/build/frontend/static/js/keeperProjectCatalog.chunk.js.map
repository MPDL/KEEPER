{"version":3,"sources":["components/dialog/keeper-catalog-facet-dialog.js","keeper-project-catalog.js"],"names":["KeeperCatalogFacetDialog","props","getTerms","termsChecked","state","termEntries","values","termsSorted","Object","keys","sort","a","b","aLen","length","bLen","localeCompare","filter","t","includes","toggle","toggleDialog","setOrder","e","setState","order","target","value","isSubmitBtnActive","inputSearchTerm","searchTerm","handleCheckboxChange","name","indexOf","addToTermsChecked","addToTerms","handleApply","applyFacet","handleCleanAll","isTermInScope","term","cscope","catalogScope","some","getTermFragment","inputField","idx","className","type","checked","isChecked","onChange","getOrderFragment","o","label","check","gettext","facet","errorMsg","terms","this","unshift","dialogTitle","hasCatalogSearchTerm","termsCatalogSearchTermFiltered","isOpen","charAt","toUpperCase","slice","style","width","height","placeholder","map","toLowerCase","color","onClick","disabled","React","Component","window","app","pageOptions","defaultFacet","repoID","repoName","userPerm","KeeperProjectCatalog","doResetFacets","facets","author","year","institute","director","calculateScopeFromFacets","fs","scope","Set","f","tc","add","Array","from","updateFacets","newFs","reset","fkey","oldFs","getItems","page","resetScope","setHasTermsChecked","st","keeperAPI","getProjectCatalog","perPage","then","res","d","data","isLoading","currentPage","items","hasNextPage","more","isAccessDenied","is_access_denied","catch","error","Utils","getErrorMsg","resetPerPage","_chk","hasTermsChecked","cleanAllFacets","onSearchedClick","selectedItem","is_dir","url","siteRoot","repo_id","repo_name","path","navigate","repalce","encodePath","open","location","href","toggleAuthorFacetDialog","isAuthorFacetDialogOpen","toggleYearFacetDialog","isYearFacetDialogOpen","toggleInstituteFacetDialog","isInstituteFacetDialogOpen","toggleDirectorFacetDialog","isDirectorFacetDialogOpen","getFacetFragment","fontWeight","urlParams","URL","searchParams","parseInt","get","script","document","createElement","src","id","async","body","appendChild","hasSearchTerm","Boolean","trim","mediaUrl","logoPath","logoHeight","logoWidth","title","siteTitle","alt","fontSize","gotoPreviousPage","gotoNextPage","curPerPage","Content","item","index","Item","toggleDescription","descExpanded","toTitleCase","txt","replace","substr","getAuthors","authors","j","tauthor","tauthors","split","i","push","affs","join","getDirectors","str","dirs","s","instituteFragment","ins","showExpandDesc","description","is_certified","landing_page_url","catalog_id","substring","maxDescLength","owner","Footer","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/keeperProjectCatalog.chunk.js","sourcesContent":["import React, { Fragment } from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  Alert,\n  Button,\n  Form,\n  FormGroup,\n  Input,\n  Label,\n  Modal,\n  ModalBody,\n  ModalFooter,\n  ModalHeader,\n} from \"reactstrap\";\nimport { gettext } from \"../../utils/constants\";\n\nconst propTypes = {\n  toggleDialog: PropTypes.func.isRequired,\n  name: PropTypes.string.isRequired,\n  values: PropTypes.object.isRequired,\n  catalogScope: PropTypes.arrayOf(PropTypes.number).isRequired,\n  applyFacet: PropTypes.func.isRequired,\n};\n\nconst maxTerms = 30;\n\nclass KeeperCatalogFacetDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    const facet = this.props.values;\n    this.state = {\n      errorMsg: \"\",\n      searchTerm: \"\",\n      isSubmitBtnActive: false,\n      order: facet.order || \"asc\",\n      termsChecked: [...facet.termsChecked] || [],\n    };\n    this.state.terms = this.getTerms();\n  }\n\n  getTerms = () => {\n    const { termsChecked } = this.state;\n    const { termEntries } = this.props.values;\n    // sort terms by amount of entries, desc, and than name, asc\n    let termsSorted = Object.keys(termEntries).sort((a, b) => {\n      let aLen = termEntries[a].length;\n      let bLen = termEntries[b].length;\n      if (aLen == bLen) {\n        return a.localeCompare(b);\n      }\n      return bLen - aLen;\n    });\n    if (termsSorted.length > 0 && termsChecked.length > 0) {\n      termsSorted = termsSorted.filter((t) => !termsChecked.includes(t));\n    }\n    return termsSorted;\n  };\n\n  toggle = () => {\n    this.props.toggleDialog();\n  };\n\n  setOrder = (e) => {\n    this.setState({\n      order: e.target.value,\n      isSubmitBtnActive: true,\n    });\n  };\n\n  inputSearchTerm = (e) => {\n    this.setState({ searchTerm: e.target.value });\n  };\n\n  addToTermsChecked(name) {\n    this.state.termsChecked.unshift(name);\n    this.setState(\n      {\n        termsChecked: this.state.termsChecked,\n      },\n      () => {\n        this.setState({ terms: this.getTerms() });\n      }\n    );\n  }\n\n  addToTerms(name) {\n    let { termsChecked } = this.state;\n    termsChecked = termsChecked.filter((t) => t !== name);\n    this.setState(\n      {\n        termsChecked: termsChecked,\n      },\n      () => {\n        this.setState({ terms: this.getTerms() });\n      }\n    );\n  }\n\n  isChecked(name) {\n    return this.state.termsChecked.indexOf(name) != -1;\n  }\n\n  handleCheckboxChange = (e) => {\n    const name = e.target.name;\n    if (this.state.termsChecked.indexOf(name) == -1) {\n      this.addToTermsChecked(name);\n    } else {\n      this.addToTerms(name);\n    }\n    this.setState({ isSubmitBtnActive: true, searchTerm: \"\" });\n  };\n\n  handleApply = () => {\n    this.props.applyFacet(\n      this.props.name,\n      this.state.termsChecked,\n      this.state.order\n    );\n    this.toggle();\n  };\n\n  handleCleanAll = () => {\n    this.props.applyFacet(this.props.name, [], \"asc\");\n    this.toggle();\n  };\n\n  isTermInScope = (term) => {\n    const cscope = this.props.catalogScope || [];\n    if (cscope.length == 0) return true;\n    const tscope = this.props.values.termEntries[term];\n    return tscope.some((e) => cscope.includes(e));\n  };\n\n  getTermFragment = (inputField, idx) => {\n    let { termEntries } = this.props.values;\n    // if (!this.isTermInScope(inputField))\n    //   return\n    return (\n      <Fragment key={`${inputField}~${idx}`}>\n        <FormGroup className=\"ml-5 mb-0\">\n          <Label>\n            <Input\n              type=\"checkbox\"\n              name={inputField}\n              checked={this.isChecked(inputField)}\n              onChange={this.handleCheckboxChange}\n            />\n            {inputField + \" (\" + termEntries[inputField].length + \")\"}\n          </Label>\n        </FormGroup>\n      </Fragment>\n    );\n  };\n\n  getOrderFragment = (o, label) => {\n    return (\n      <FormGroup check>\n        <Label check>\n          <Input\n            type=\"radio\"\n            name=\"order\"\n            value={o}\n            checked={this.state.order == o}\n            onChange={this.setOrder}\n            className=\"mr-1\"\n          />\n          {gettext(label)}\n        </Label>\n      </FormGroup>\n    );\n  };\n\n  render() {\n    const { dialogTitle, name, hasCatalogSearchTerm } = this.props;\n    const { errorMsg, searchTerm, termsChecked, terms, isSubmitBtnActive } =\n      this.state;\n\n    let termsCatalogSearchTermFiltered = hasCatalogSearchTerm\n      ? terms.filter((term) => this.isTermInScope(term))\n      : terms;\n\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>\n          {gettext(\n            \"Select \" + name.charAt(0).toUpperCase() + name.slice(1) + \"(s)\"\n          )}\n        </ModalHeader>\n        <ModalBody>\n          <Form>\n            {this.getOrderFragment(\"asc\", \"Ascending\")}\n            {this.getOrderFragment(\"desc\", \"Descending\")}\n            <FormGroup className=\"mt-3\">\n              <Input\n                style={{ width: \"60%\", height: \"60%\" }}\n                placeholder={gettext(\"Search\")}\n                value={searchTerm}\n                onChange={this.inputSearchTerm}\n              />\n            </FormGroup>\n            {termsChecked.map((term, idx) => this.getTermFragment(term, idx))}\n            {termsCatalogSearchTermFiltered\n              .filter(\n                (term) =>\n                  typeof searchTerm === \"undefined\" ||\n                  searchTerm === null ||\n                  (term &&\n                    term.toLowerCase().includes(searchTerm.toLowerCase()))\n              )\n              .map(\n                (term, idx) =>\n                  idx + termsChecked.length < maxTerms &&\n                  this.getTermFragment(term, idx)\n              )}\n            {termsCatalogSearchTermFiltered.length + termsChecked.length >=\n              maxTerms && <div className=\"ml-1\">...</div>}\n          </Form>\n          {errorMsg && <Alert color=\"danger\">{errorMsg}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button\n            color=\"primary\"\n            className=\"w-9\"\n            onClick={this.handleApply}\n            disabled={!isSubmitBtnActive}\n          >\n            {gettext(\"Apply\")}\n          </Button>\n          <Button\n            className=\"ml-4\"\n            color=\"primary\"\n            onClick={this.handleCleanAll}\n          >\n            {gettext(\"Reset\")}\n          </Button>\n          <Button className=\"ml-4\" color=\"secondary\" onClick={this.toggle}>\n            {gettext(\"Cancel\")}\n          </Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nKeeperCatalogFacetDialog.propTypes = propTypes;\n\nexport default KeeperCatalogFacetDialog;\n","import React, { Fragment } from \"react\";\nimport { Form, FormGroup, Input } from \"reactstrap\";\nimport ReactDOM from \"react-dom\";\nimport { navigate } from \"@reach/router\";\nimport { Utils } from \"./utils/utils\";\nimport {\n  gettext,\n  logoHeight,\n  logoPath,\n  logoWidth,\n  mediaUrl,\n  siteRoot,\n  siteTitle,\n} from \"./utils/constants\";\nimport { keeperAPI } from \"./utils/seafile-api\";\nimport Loading from \"./components/loading\";\nimport Paginator from \"./components/paginator\";\nimport CommonToolbar from \"./components/toolbar/common-toolbar\";\nimport KeeperCatalogFacetDialog from \"./components/dialog/keeper-catalog-facet-dialog\";\n\nimport \"./css/toolbar.css\";\nimport \"./css/search.css\";\n\nimport \"./css/keeper-project-catalog.css\";\n\nconst { repoID, repoName, userPerm } = window.app.pageOptions;\n\nconst maxDescLength = 500;\n\nconst defaultFacet = {\n  order: \"asc\",\n  termEntries: {},\n  termsChecked: [],\n};\n\nclass KeeperProjectCatalog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errorMsg: \"\",\n      currentPage: 1,\n      perPage: 25,\n      hasNextPage: false,\n      items: [],\n      catalogScope: [],\n      searchTerm: \"\",\n      isAuthorFacetDialogOpen: false,\n      isYearFacetDialogOpen: false,\n      isInstituteFacetDialogOpen: false,\n      isDirectorFacetDialogOpen: false,\n      hasTermsChecked: false,\n    };\n    this.doResetFacets();\n  }\n\n  componentDidMount() {\n    let urlParams = new URL(window.location).searchParams;\n    const { currentPage, perPage } = this.state;\n    this.setState(\n      {\n        perPage: parseInt(urlParams.get(\"per_page\") || perPage),\n        currentPage: parseInt(urlParams.get(\"page\") || currentPage),\n      },\n      () => {\n        this.getItems(this.state.currentPage, true);\n      }\n    );\n    const script = document.createElement(\"script\");\n    script.src =\n      \"https://static.zdassets.com/ekr/snippet.js?key=32977f9b-455d-428b-8dd5-f4c65aad0daa\";\n    script.id = \"ze-snippet\";\n    script.async = true;\n    document.body.appendChild(script);\n  }\n\n  doResetFacets = () => {\n    this.state.facets = {\n      author: { ...defaultFacet },\n      year: { ...defaultFacet },\n      institute: { ...defaultFacet },\n      director: { ...defaultFacet },\n    };\n  };\n\n  calculateScopeFromFacets = () => {\n    let fs = this.state.facets;\n    // intersection\n    let scope = new Set();\n    for (let fkey of Object.keys(fs)) {\n      let f = fs[fkey];\n      if (\"termsChecked\" in f && f.termsChecked.length > 0) {\n        for (let tc of f.termsChecked) {\n          for (let e of f.termEntries[tc]) scope.add(e);\n        }\n      }\n    }\n    return Array.from(scope);\n  };\n\n  updateFacets = (newFs, reset) => {\n    let f = {};\n    for (let fkey of Object.keys(newFs)) {\n      let oldFs = this.state.facets[fkey].termEntries;\n      f[fkey] = {\n        ...this.state.facets[fkey],\n        // newer override oldFs if it is already initialized from DB\n        // TODO: check case: somebody changed catalog during the current search session\n        // check timestamp of latest\n        termEntries:\n          Object.keys(oldFs).length == 0 ? newFs[fkey].termEntries : oldFs,\n        termsChecked: newFs[fkey].termsChecked,\n      };\n    }\n    //    console.log(f)\n    return f;\n  };\n\n  getItems = (page, resetScope) => {\n    // this.setState({isLoading: true})\n    this.setHasTermsChecked();\n    let st = this.state;\n    let fs = this.state.facets;\n    let scope = resetScope ? [] : this.calculateScopeFromFacets();\n    keeperAPI\n      .getProjectCatalog(\n        page,\n        st.perPage,\n        fs.author,\n        fs.year,\n        fs.institute,\n        fs.director,\n        scope,\n        st.searchTerm\n      )\n      .then((res) => {\n        let d = res.data;\n        //console.log(d.items);\n        this.setState({\n          isLoading: false,\n          currentPage: page,\n          items: d.items,\n          hasNextPage: d.more,\n          catalogScope: d.scope,\n          facets: this.updateFacets(d.facets),\n          isAccessDenied: \"is_access_denied\" in d && d.is_access_denied,\n        });\n      })\n      .catch((error) => {\n        this.setState({\n          isLoading: false,\n          errorMsg: Utils.getErrorMsg(error, true), // true: show login tip if 403\n        });\n      });\n  };\n\n  resetPerPage = (perPage) => {\n    this.setState(\n      {\n        perPage: perPage,\n      },\n      () => {\n        this.getItems(1, false);\n      }\n    );\n  };\n\n  _chk = (f) => {\n    return f && \"termsChecked\" in f && f.termsChecked.length > 0;\n  };\n\n  setHasTermsChecked = () => {\n    let fs = this.state.facets;\n    this.setState({\n      hasTermsChecked:\n        this._chk(fs.author) ||\n        this._chk(fs.year) ||\n        this._chk(fs.director) ||\n        this._chk(fs.institute),\n    });\n  };\n\n  applyFacet = (fkey, termsChecked, order) => {\n    this.setState(\n      {\n        facets: {\n          ...this.state.facets,\n          [fkey]: {\n            ...this.state.facets[fkey],\n            termsChecked: termsChecked,\n            order: order,\n          },\n        },\n      },\n      () => {\n        this.getItems(1, termsChecked && termsChecked.length == 0);\n      }\n    );\n  };\n\n  cleanAllFacets = () => {\n    this.doResetFacets();\n    this.getItems(1, true);\n  };\n\n  onSearchedClick = (selectedItem) => {\n    if (selectedItem.is_dir === true) {\n      let url =\n        siteRoot +\n        \"library/\" +\n        selectedItem.repo_id +\n        \"/\" +\n        selectedItem.repo_name +\n        selectedItem.path;\n      navigate(url, { repalce: true });\n    } else {\n      let url =\n        siteRoot +\n        \"lib/\" +\n        selectedItem.repo_id +\n        \"/file\" +\n        Utils.encodePath(selectedItem.path);\n      let newWindow = window.open(\"about:blank\");\n      newWindow.location.href = url;\n    }\n  };\n\n  toggleAuthorFacetDialog = () => {\n    this.setState({\n      isAuthorFacetDialogOpen: !this.state.isAuthorFacetDialogOpen,\n    });\n  };\n\n  toggleYearFacetDialog = () => {\n    this.setState({ isYearFacetDialogOpen: !this.state.isYearFacetDialogOpen });\n  };\n\n  toggleInstituteFacetDialog = () => {\n    this.setState({\n      isInstituteFacetDialogOpen: !this.state.isInstituteFacetDialogOpen,\n    });\n  };\n\n  toggleDirectorFacetDialog = () => {\n    this.setState({\n      isDirectorFacetDialogOpen: !this.state.isDirectorFacetDialogOpen,\n    });\n  };\n\n  inputSearchTerm = (e) => {\n    this.setState({ searchTerm: e.target.value }, () => {\n      this.getItems(1, true);\n    });\n  };\n\n  getFacetFragment = (fkey) => {\n    let f = this.state.facets[fkey];\n    return (\n      <Fragment>\n        <a href=\"#\" style={{ color: \"#575859\", fontWeight: \"lighter\" }}>\n          {gettext(fkey.charAt(0).toUpperCase() + fkey.slice(1))}\n        </a>\n        {f.termsChecked.length > 0 && (\n          <i\n            className={\n              \"ml-1 fa fa-arrow-\" + (f.order == \"desc\" ? \"up\" : \"down\")\n            }\n          />\n        )}\n        <ul>\n          {f.termsChecked.map(\n            (t, idx) =>\n              t in f.termEntries && (\n                <Fragment key={`${t}~${idx}`}>\n                  <li className=\"ml-5 mb-0\">\n                    {t +\n                      (t in f.termEntries\n                        ? \" (\" + f.termEntries[t].length + \")\"\n                        : \"\")}\n                  </li>\n                </Fragment>\n              )\n          )}\n        </ul>\n      </Fragment>\n    );\n  };\n\n  render() {\n    const {\n      isAuthorFacetDialogOpen,\n      isYearFacetDialogOpen,\n      isInstituteFacetDialogOpen,\n      isDirectorFacetDialogOpen,\n      facets,\n      searchTerm,\n    } = this.state;\n    const hasSearchTerm = Boolean(searchTerm && searchTerm.trim() != \"\");\n    return (\n      <Fragment>\n        <div className=\"h-100 d-flex flex-column\">\n          <div className=\"top-header d-flex justify-content-between\">\n            <a href={siteRoot}>\n              <img\n                src={mediaUrl + logoPath}\n                height={logoHeight}\n                width={logoWidth}\n                title={siteTitle}\n                alt=\"logo\"\n              />\n            </a>\n            <CommonToolbar onSearchedClick={this.onSearchedClick} />\n          </div>\n          <div className=\"flex-auto container-fluid pt-4 pb-6 o-auto\">\n            <div className=\"row\">\n              {this.state.isAccessDenied ? (\n                <h3 className=\"offset-md-2 col-md-8 mt-9 text-center error\">\n                  {gettext(\n                    \"Sie sind leider nicht berechtigt den Projektkatalog zu öffnen. Bitte wenden Sie sich an den Keeper Support.\"\n                  )}\n                </h3>\n              ) : (\n                <div className=\"col-md-8 offset-md-2\">\n                  <h3 className=\"d-flex offset-md-3\" id=\"header\">\n                    {gettext(\n                      \"The KEEPER Project Catalog of the Max Planck Society\"\n                    )}\n                  </h3>\n                  <div className=\"row\">\n                    <div id=\"facet\" className=\"col-md-3\">\n                      <h3\n                        style={{\n                          color: \"#57a5b8\",\n                          fontSize: \"1.75em\",\n                          fontWeight: 500,\n                        }}\n                      >\n                        {gettext(\"Show Projects\")} (\n                        {this.state.catalogScope.length})\n                      </h3>\n                      <div onClick={this.toggleAuthorFacetDialog}>\n                        {this.getFacetFragment(\"author\")}\n                      </div>\n                      <div onClick={this.toggleYearFacetDialog}>\n                        {this.getFacetFragment(\"year\")}\n                      </div>\n                      <div onClick={this.toggleInstituteFacetDialog}>\n                        {this.getFacetFragment(\"institute\")}\n                      </div>\n                      <div onClick={this.toggleDirectorFacetDialog}>\n                        {this.getFacetFragment(\"director\")}\n                      </div>\n                      {this.state.hasTermsChecked && (\n                        <div className=\"mt-1\">\n                          <a href=\"#\" onClick={this.cleanAllFacets}>\n                            {gettext(\"Reset all\")}\n                          </a>\n                        </div>\n                      )}\n                    </div>\n                    <div className=\"col-md-9\">\n                      <Form>\n                        <FormGroup>\n                          <Input\n                            type=\"search\"\n                            style={{ height: \"60%\" }}\n                            placeholder={gettext(\"Search\") + \"...\"}\n                            value={this.state.searchTerm}\n                            onChange={this.inputSearchTerm}\n                          />\n                        </FormGroup>\n                      </Form>\n                      <Content\n                        isLoading={this.state.isLoading}\n                        errorMsg={this.state.errorMsg}\n                        items={this.state.items}\n                      />\n                    </div>\n                  </div>\n                  <div className=\"row justify-content-center\">\n                    <Paginator\n                      gotoPreviousPage={() => {\n                        this.getItems(this.state.currentPage - 1, false);\n                      }}\n                      gotoNextPage={() => {\n                        this.getItems(this.state.currentPage + 1, false);\n                      }}\n                      currentPage={this.state.currentPage}\n                      hasNextPage={this.state.hasNextPage}\n                      curPerPage={this.state.perPage}\n                      resetPerPage={this.resetPerPage}\n                    />\n                  </div>\n                  <Footer />\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n        {isAuthorFacetDialogOpen && (\n          <KeeperCatalogFacetDialog\n            name={\"author\"}\n            values={facets.author}\n            hasCatalogSearchTerm={hasSearchTerm}\n            catalogScope={this.state.catalogScope}\n            toggleDialog={this.toggleAuthorFacetDialog}\n            applyFacet={this.applyFacet}\n          />\n        )}\n        {isYearFacetDialogOpen && (\n          <KeeperCatalogFacetDialog\n            name={\"year\"}\n            values={facets.year}\n            hasCatalogSearchTerm={hasSearchTerm}\n            catalogScope={this.state.catalogScope}\n            toggleDialog={this.toggleYearFacetDialog}\n            applyFacet={this.applyFacet}\n          />\n        )}\n        {isInstituteFacetDialogOpen && (\n          <KeeperCatalogFacetDialog\n            name={\"institute\"}\n            values={facets.institute}\n            hasCatalogSearchTerm={hasSearchTerm}\n            catalogScope={this.state.catalogScope}\n            toggleDialog={this.toggleInstituteFacetDialog}\n            applyFacet={this.applyFacet}\n          />\n        )}\n        {isDirectorFacetDialogOpen && (\n          <KeeperCatalogFacetDialog\n            name={\"director\"}\n            values={facets.director}\n            hasCatalogSearchTerm={hasSearchTerm}\n            catalogScope={this.state.catalogScope}\n            toggleDialog={this.toggleDirectorFacetDialog}\n            applyFacet={this.applyFacet}\n          />\n        )}\n      </Fragment>\n    );\n  }\n}\n\nclass Content extends React.Component {\n  render() {\n    const { isLoading, errorMsg, items } = this.props;\n\n    if (isLoading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error mt-6 text-center\">{errorMsg}</p>;\n    }\n\n    return (\n      <Fragment>\n        {items.map((item, index) => {\n          return <Item key={index} item={item} />;\n        })}\n      </Fragment>\n    );\n  }\n}\n\nclass Item extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      descExpanded: false,\n    };\n  }\n\n  toggleDescription = () => {\n    this.setState({ descExpanded: !this.state.descExpanded });\n  };\n\n  toTitleCase = (txt) => {\n    let str = txt.replace(/([^\\W_]+[^\\s-]*) */g, (t) => {\n      return t.charAt(0).toUpperCase() + t.substr(1).toLowerCase();\n    });\n    return str;\n  };\n\n  getAuthors = (item) => {\n    let author = [];\n    if (\"authors\" in item && item.authors.length > 0) {\n      let authors = item.authors;\n      for (let j = 0; j < authors.length; j++) {\n        let tauthor = \"\";\n        let tauthors = this.toTitleCase(authors[j].name).split(\", \");\n        for (let i = 0; i < tauthors.length; i++) {\n          if (i == 0 && tauthors[i].trim().length) {\n            tauthor += tauthors[i] + \", \";\n          } else if (tauthors[i].trim().length > 1)\n            tauthor += tauthors[i].trim().charAt(0) + \"., \";\n        }\n        tauthor = tauthor.trim().slice(0, -1);\n        if (j >= 5) tauthor = \"et al.\";\n        author.push(tauthor);\n        if (j >= 5) break;\n        if (\"affs\" in authors[j])\n          author.push(this.toTitleCase(authors[j].affs.join(\", \")));\n      }\n    }\n    return author.join(\"; \");\n  };\n\n  //TODO\n  getDirectors = (str) => {\n    let dirs = str\n      .split(\"|\")\n      .map((s) => s.trim())\n      .filter((s) => s.length > 0);\n    if (dirs.length > 0) {\n      return dirs.join(\"; \");\n    }\n    return null;\n  };\n\n  instituteFragment = (ins) => {\n    const split = ins\n      .split(\";\")\n      .map((s) => s.trim())\n      .filter((s) => s.length > 0);\n    if (!(split && split.length && split.length > 0)) return;\n\n    const dirs = split.length >= 3 ? this.getDirectors(split[2]) : null;\n    return (\n      <Fragment>\n        {split[0] && <p>{gettext(\"Institute\") + \": \" + split[0]}</p>}\n        {split[1] && <p>{gettext(\"Department\") + \": \" + split[1]}</p>}\n        {/*{dirs &&*/}\n        {/*  <p>{gettext(\"Directors or PIs\") + \": \" + dirs}</p>*/}\n        {/*}*/}\n      </Fragment>\n    );\n  };\n\n  render() {\n    const item = this.props.item;\n    let showExpandDesc =\n      item.description && item.description.length > maxDescLength;\n    return (\n      <Fragment>\n        <div className=\"item-block\" id={item.repo_id}>\n          <div className=\"row\">\n            <div className=\"col-md-1\">\n              {item.is_certified && <img src=\"/media/custom/certified.png\" />}\n            </div>\n            <div className=\"col-md-11\">\n              <h3>\n                {item.landing_page_url ? (\n                  <a href={\"/landing-page/libs/\" + item.repo_id + \"/\"}>\n                    {item.title}\n                  </a>\n                ) : (\n                  item.title ||\n                  gettext(\"Project archive no.\") + \": \" + item.catalog_id\n                )}\n              </h3>\n              {item.description && (\n                <p>\n                  {showExpandDesc\n                    ? !this.state.descExpanded\n                      ? item.description.substring(0, maxDescLength - 4) + \"...\"\n                      : item.description\n                    : item.description}\n                  {showExpandDesc && (\n                    <i\n                      onClick={this.toggleDescription}\n                      className={\n                        \"keeper-icon-triangle-\" +\n                        (this.state.descExpanded ? \"up\" : \"down\")\n                      }\n                    />\n                  )}\n                </p>\n              )}\n              {item.authors && <p>{this.getAuthors(item)}</p>}\n              {item.year && <p>{gettext(\"Year\") + \": \" + item.year}</p>}\n              {item.institute && this.instituteFragment(item.institute)}\n              {item.owner && (\n                <p>{gettext(\"Contact\") + \": \" + item.owner.toLowerCase()}</p>\n              )}\n              {item.landing_page_url && (\n                <p>\n                  <a href={\"/landing-page/libs/\" + item.repo_id + \"/\"}>\n                    {gettext(\"Landing Page\")}\n                  </a>\n                </p>\n              )}\n              {/*{JSON.stringify(item)}*/}\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nclass Footer extends React.Component {\n  render() {\n    return (\n      <Fragment>\n        <div id=\"lg_footer\">\n          <div className=\"container\">\n            <div id=\"keeper-links\" className=\"row\">\n              <div className=\"col-md-3\">\n                <h4>Be informed</h4>\n                <a\n                  href=\"https://keeper.mpdl.mpg.de/f/d17ecbb967/\"\n                  target=\"_blank\"\n                >\n                  About Keeper\n                </a>\n                <br />\n                <a\n                  href=\"https://keeper.mpdl.mpg.de/f/1b0bfceac2/\"\n                  target=\"_blank\"\n                >\n                  Cared Data Commitment\n                </a>\n                <br />\n                <a href=\"/project-catalog\" target=\"_blank\">\n                  Project Catalog\n                </a>\n                <br />\n              </div>\n              <div className=\"col-md-3\">\n                <h4>Get the desktop sync client</h4>\n                <a href=\"/download_client_program/\" target=\"_blank\">\n                  Download the Keeper client for Windows, Linux and Mac\n                </a>\n              </div>\n              <div className=\"col-md-3\">\n                <h4>Find help</h4>\n                <a href=\"mailto:keeper@mpdl.mpg.de\">\n                  Contact Keeper Support\n                </a>{\" \"}\n                <br />\n                <a\n                  href=\"https://mpdl.zendesk.com/hc/en-us/categories/360001234340-Keeper\"\n                  target=\"_blank\"\n                >\n                  Help / Knowledge Base\n                </a>\n              </div>\n              <div className=\"col-md-3\">\n                <h4>Check terms</h4>\n                <a\n                  href=\"https://keeper.mpdl.mpg.de/f/f62758e53c/\"\n                  target=\"_blank\"\n                >\n                  Terms of Services\n                </a>{\" \"}\n                <br />\n                <a\n                  href=\"https://keeper.mpdl.mpg.de/f/17e4e9d648/\"\n                  target=\"_blank\"\n                >\n                  Disclaimer\n                </a>\n                <br />\n                <a\n                  href=\"https://keeper.mpdl.mpg.de/f/bf2c8a977f70428587eb/\"\n                  target=\"_blank\"\n                >\n                  Privacy Policy\n                </a>\n              </div>\n            </div>\n            <div id=\"seafile-credits\" className=\"row\">\n              <div className=\"col-md-12 text-center\">\n                <div>\n                  <a href=\"https://www.seafile.com/en/home/\" target=\"_blank\">\n                    The software behind Keeper{\" \"}\n                    <img\n                      id=\"seafile-logo\"\n                      src=\"/media/custom/seafile_logo_footer.png\"\n                      height=\"35\"\n                    />\n                    © 2022 Seafile\n                  </a>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nReactDOM.render(<KeeperProjectCatalog />, document.getElementById(\"wrapper\"));\n"],"sourceRoot":""}