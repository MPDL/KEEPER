{"version":3,"sources":["components/dialog/keeper-catalog-facet-dialog.js","keeper-project-catalog.js"],"names":["KeeperCatalogFacetDialog","props","getTerms","termsChecked","state","termEntries","values","termsSorted","Object","keys","sort","a","b","aLen","length","bLen","localeCompare","filter","t","includes","toggle","toggleDialog","setOrder","e","setState","order","target","value","isSubmitBtnActive","inputSearchTerm","searchTerm","handleCheckboxChange","name","indexOf","addToTermsChecked","addToTerms","handleApply","applyFacet","handleCleanAll","isTermInScope","term","cscope","catalogScope","some","getTermFragment","inputField","idx","className","type","checked","isChecked","onChange","getOrderFragment","o","label","check","gettext","facet","errorMsg","terms","this","unshift","dialogTitle","hasCatalogSearchTerm","termsCatalogSearchTermFiltered","isOpen","charAt","toUpperCase","slice","style","width","height","placeholder","map","toLowerCase","color","onClick","disabled","React","Component","window","app","pageOptions","defaultFacet","repoID","repoName","userPerm","KeeperProjectCatalog","doResetFacets","facets","author","year","institute","director","calculateScopeFromFacets","fs","scope","Set","f","tc","add","Array","from","updateFacets","newFs","reset","fkey","oldFs","getItems","page","resetScope","setHasTermsChecked","st","keeperAPI","getProjectCatalog","perPage","then","res","d","data","isLoading","currentPage","items","hasNextPage","more","isAccessDenied","is_access_denied","catch","error","Utils","getErrorMsg","resetPerPage","_chk","hasTermsChecked","cleanAllFacets","onSearchedClick","selectedItem","is_dir","url","siteRoot","repo_id","repo_name","path","navigate","repalce","encodePath","open","location","href","toggleAuthorFacetDialog","isAuthorFacetDialogOpen","toggleYearFacetDialog","isYearFacetDialogOpen","toggleInstituteFacetDialog","isInstituteFacetDialogOpen","toggleDirectorFacetDialog","isDirectorFacetDialogOpen","getFacetFragment","fontWeight","urlParams","URL","searchParams","parseInt","get","script","document","createElement","src","id","async","body","appendChild","hasSearchTerm","Boolean","trim","mediaUrl","logoPath","logoHeight","logoWidth","title","siteTitle","alt","fontSize","gotoPreviousPage","gotoNextPage","curPerPage","Content","item","index","Item","toggleDescription","descExpanded","toTitleCase","txt","replace","substr","getAuthors","authors","j","tauthor","tauthors","split","i","push","affs","join","getDirectors","str","dirs","s","instituteFragment","ins","showExpandDesc","description","is_certified","landing_page_url","catalog_id","substring","maxDescLength","owner","Footer","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/keeperProjectCatalog.chunk.js","sourcesContent":["import React, {Fragment} from 'react';\nimport PropTypes from 'prop-types';\nimport {Alert, Button, Form, FormGroup, Input, Label, Modal, ModalBody, ModalFooter, ModalHeader} from 'reactstrap';\nimport {gettext} from '../../utils/constants';\n\nconst propTypes = {\n  toggleDialog: PropTypes.func.isRequired,\n  name: PropTypes.string.isRequired,\n  values: PropTypes.object.isRequired,\n  catalogScope: PropTypes.arrayOf(PropTypes.number).isRequired,\n  applyFacet: PropTypes.func.isRequired,\n};\n\nconst maxTerms = 30;\n\nclass KeeperCatalogFacetDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    const facet = this.props.values;\n    this.state = {\n      errorMsg: '',\n      searchTerm: '',\n      isSubmitBtnActive: false,\n      order: facet.order || 'asc',\n      termsChecked: [...facet.termsChecked] || [],\n    };\n    this.state.terms = this.getTerms();\n  }\n\n\n  getTerms = () => {\n    const { termsChecked } = this.state;\n    const { termEntries } = this.props.values;\n    // sort terms by amount of entries, desc, and than name, asc\n    let termsSorted = Object.keys(termEntries)\n      .sort((a, b) => {\n        let aLen = termEntries[a].length;\n        let bLen = termEntries[b].length;\n        if (aLen == bLen) {\n          return a.localeCompare(b);\n        }\n        return bLen - aLen;\n      });\n    if (termsSorted.length > 0 && termsChecked.length > 0) {\n      termsSorted = termsSorted.filter(t => !termsChecked.includes(t));\n    }\n    return termsSorted;\n  }\n\n  toggle = () => {\n    this.props.toggleDialog();\n  }\n\n  setOrder = (e) => {\n    this.setState({\n      order: e.target.value,\n      isSubmitBtnActive: true\n    });\n  }\n\n  inputSearchTerm = (e) => {\n    this.setState({searchTerm: e.target.value});\n  }\n\n  addToTermsChecked(name) {\n    this.state.termsChecked.unshift(name);\n    this.setState({\n      termsChecked: this.state.termsChecked,\n    }, () => {\n      this.setState({terms: this.getTerms()});\n    });\n  }\n\n  addToTerms(name) {\n    let {termsChecked} = this.state;\n    termsChecked = termsChecked.filter(t => t !== name);\n    this.setState({\n      termsChecked: termsChecked,\n    }, () => {\n      this.setState({terms: this.getTerms()});\n    });\n  }\n\n  isChecked(name) {\n    return this.state.termsChecked.indexOf(name) != -1;\n  }\n\n  handleCheckboxChange = (e) => {\n    const name = e.target.name;\n    if (this.state.termsChecked.indexOf(name) == -1) {\n      this.addToTermsChecked(name);\n    } else {\n      this.addToTerms(name);\n    }\n    this.setState({isSubmitBtnActive: true, searchTerm: \"\"});\n  }\n\n\n  handleApply = () => {\n    this.props.applyFacet(this.props.name, this.state.termsChecked, this.state.order);\n    this.toggle();\n  }\n\n  handleCleanAll = () => {\n    this.props.applyFacet(this.props.name, [], \"asc\");\n    this.toggle();\n  }\n\n  isTermInScope = (term) => {\n    const cscope = this.props.catalogScope || [];\n    if (cscope.length == 0)\n      return true;\n    const tscope = this.props.values.termEntries[term];\n    return tscope.some(e => cscope.includes(e));\n  }\n\n  getTermFragment = (inputField, idx) => {\n    let { termEntries } = this.props.values;\n    // if (!this.isTermInScope(inputField))\n    //   return\n    return (\n      <Fragment key={`${inputField}~${idx}`}>\n        <FormGroup className=\"ml-5 mb-0\">\n          <Label>\n            <Input type=\"checkbox\" name={inputField} checked={this.isChecked(inputField)}\n              onChange={this.handleCheckboxChange}/>\n            {inputField + \" (\" + termEntries[inputField].length + \")\"}\n          </Label>\n        </FormGroup>\n      </Fragment>\n    );\n  }\n\n  getOrderFragment = (o, label) => {\n    return (\n      <FormGroup check>\n        <Label check>\n          <Input type=\"radio\" name=\"order\" value={o} checked={this.state.order == o} onChange={this.setOrder} className=\"mr-1\"/>\n          {gettext(label)}\n        </Label>\n      </FormGroup>\n    );\n  }\n\n  render() {\n    const { dialogTitle, name, hasCatalogSearchTerm } = this.props;\n    const { errorMsg, searchTerm, termsChecked, terms, isSubmitBtnActive } = this.state;\n    \n    let termsCatalogSearchTermFiltered = hasCatalogSearchTerm ? terms.filter((term) => this.isTermInScope(term)) : terms;\n\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext(\"Select \" + name.charAt(0).toUpperCase() + name.slice(1) + \"(s)\")}</ModalHeader>\n        <ModalBody>\n          <Form>\n            {this.getOrderFragment(\"asc\", \"Ascending\")}\n            {this.getOrderFragment(\"desc\", \"Descending\")}\n            <FormGroup className=\"mt-3\">\n              <Input style={{width: \"60%\", height: \"60%\"}} placeholder={gettext('Search')} value={searchTerm} onChange={this.inputSearchTerm}/>\n            </FormGroup>\n            {termsChecked\n              .map((term, idx) => (\n                this.getTermFragment(term, idx)\n              ))}\n            {termsCatalogSearchTermFiltered\n              .filter((term) =>\n                (typeof searchTerm === \"undefined\" || searchTerm === null) ||\n                  (term && term.toLowerCase().includes(searchTerm.toLowerCase()))\n              )\n              .map((term, idx) => (\n                idx + termsChecked.length < maxTerms && this.getTermFragment(term, idx)\n              ))}\n            {termsCatalogSearchTermFiltered.length + termsChecked.length >= maxTerms &&\n              <div className=\"ml-1\">...</div>\n            }\n          </Form>\n          {errorMsg && <Alert color=\"danger\">{errorMsg}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"primary\" className=\"w-9\" onClick={this.handleApply} disabled={!isSubmitBtnActive}>{gettext('Apply')}</Button>\n          <Button className=\"ml-4\"  color=\"primary\" onClick={this.handleCleanAll}>{gettext('Reset')}</Button>\n          <Button className=\"ml-4\" color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nKeeperCatalogFacetDialog.propTypes = propTypes;\n\nexport default KeeperCatalogFacetDialog;\n","import React, {Fragment} from 'react';\nimport {Form, FormGroup, Input} from 'reactstrap';\nimport ReactDOM from 'react-dom';\nimport {navigate} from '@reach/router';\nimport {Utils} from './utils/utils';\nimport {gettext, logoHeight, logoPath, logoWidth, mediaUrl, siteRoot, siteTitle} from './utils/constants';\nimport {keeperAPI} from './utils/seafile-api';\nimport Loading from './components/loading';\nimport Paginator from './components/paginator';\nimport CommonToolbar from './components/toolbar/common-toolbar';\nimport KeeperCatalogFacetDialog from './components/dialog/keeper-catalog-facet-dialog';\n\nimport './css/toolbar.css';\nimport './css/search.css';\n\nimport './css/keeper-project-catalog.css';\n\nconst { \n  repoID,\n  repoName,\n  userPerm\n} = window.app.pageOptions;\n\nconst maxDescLength = 500;\n\nconst defaultFacet = {\n  order: 'asc',\n  termEntries: {},\n  termsChecked: [],\n};\n\nclass KeeperProjectCatalog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errorMsg: '',\n      currentPage: 1,\n      perPage: 25,\n      hasNextPage: false,\n      items: [],\n      catalogScope: [],\n      searchTerm: '',\n      isAuthorFacetDialogOpen: false,\n      isYearFacetDialogOpen: false,\n      isInstituteFacetDialogOpen: false,\n      isDirectorFacetDialogOpen: false,\n      hasTermsChecked: false,\n    };\n    this.doResetFacets();\n  }\n\n  componentDidMount() {\n    let urlParams = (new URL(window.location)).searchParams;\n    const {\n      currentPage, perPage\n    } = this.state;\n    this.setState({\n      perPage: parseInt(urlParams.get('per_page') || perPage),\n      currentPage: parseInt(urlParams.get('page') || currentPage)\n    }, () => {\n      this.getItems(this.state.currentPage, true);\n    });\n    const script = document.createElement('script');\n    script.src =\n      'https://static.zdassets.com/ekr/snippet.js?key=32977f9b-455d-428b-8dd5-f4c65aad0daa';\n    script.id = 'ze-snippet';\n    script.async = true;\n    document.body.appendChild(script);\n  }\n\n  doResetFacets = () => {\n    this.state.facets = {\n      author: {...defaultFacet},\n      year: {...defaultFacet},\n      institute: {...defaultFacet},\n      director: {...defaultFacet},\n    };\n  }\n\n  calculateScopeFromFacets = () => {\n    let fs = this.state.facets;\n    // intersection\n    let scope = new Set();\n    for (let fkey of Object.keys(fs)) {\n      let f = fs[fkey];\n      if (\"termsChecked\" in f && f.termsChecked.length > 0) {\n        for (let tc of f.termsChecked) {\n          for (let e of f.termEntries[tc])\n            scope.add(e);\n        }\n      }\n    }\n    return Array.from(scope);\n  }\n\n  updateFacets = (newFs, reset) => {\n    let f = {};\n    for (let fkey of Object.keys(newFs) ) {\n      let oldFs = this.state.facets[fkey].termEntries;\n      f[fkey] = {\n        ...this.state.facets[fkey],\n        // newer override oldFs if it is already initialized from DB\n        // TODO: check case: somebody chanhed catalog during the current search session\n        // check timestamp of latest\n        termEntries: Object.keys(oldFs).length == 0 ? newFs[fkey].termEntries : oldFs,\n        termsChecked: newFs[fkey].termsChecked,\n      };\n    }\n    //    console.log(f)\n    return f;\n  }\n\n  getItems = (page, resetScope) => {\n    // this.setState({isLoading: true})\n    this.setHasTermsChecked();\n    let st = this.state;\n    let fs = this.state.facets;\n    let scope =\n        resetScope ? [] : this.calculateScopeFromFacets();\n    keeperAPI.getProjectCatalog(page, st.perPage,\n      fs.author, fs.year, fs.institute, fs.director,\n      scope,\n      st.searchTerm\n    ).then((res) => {\n      let d = res.data;\n      //console.log(d.items);\n      this.setState({\n        isLoading: false,\n        currentPage: page,\n        items: d.items,\n        hasNextPage: d.more,\n        catalogScope: d.scope,\n        facets: this.updateFacets(d.facets),\n        isAccessDenied: \"is_access_denied\" in d && d.is_access_denied,\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  resetPerPage = (perPage) => {\n    this.setState({\n      perPage: perPage\n    }, () => {\n      this.getItems(1, false);\n    });\n  }\n\n  _chk = f => {\n    return f && \"termsChecked\" in f && f.termsChecked.length > 0;\n  }\n\n  setHasTermsChecked = () => {\n    let fs = this.state.facets;\n    this.setState({\n      hasTermsChecked: this._chk(fs.author) || this._chk(fs.year) || this._chk(fs.director) || this._chk(fs.institute)\n    });\n  }\n\n  applyFacet = (fkey, termsChecked, order) => {\n    this.setState({\n      facets: {\n        ...this.state.facets,\n        [fkey]: {\n          ...this.state.facets[fkey],\n          termsChecked: termsChecked,\n          order: order,\n        }},\n    }, () => {\n      this.getItems(1, termsChecked && termsChecked.length == 0);\n    });\n  }\n\n  cleanAllFacets = () => {\n    this.doResetFacets();\n    this.getItems(1, true);\n  }\n\n  onSearchedClick = selectedItem => {\n    if (selectedItem.is_dir === true) {\n      let url = siteRoot + 'library/' + selectedItem.repo_id + '/' + selectedItem.repo_name + selectedItem.path;\n      navigate(url, {repalce: true});\n    } else {\n      let url = siteRoot + 'lib/' + selectedItem.repo_id + '/file' + Utils.encodePath(selectedItem.path);\n      let newWindow = window.open('about:blank');\n      newWindow.location.href = url;\n    }\n  }\n\n  toggleAuthorFacetDialog = () => {\n    this.setState({isAuthorFacetDialogOpen: !this.state.isAuthorFacetDialogOpen});\n  }\n\n  toggleYearFacetDialog = () => {\n    this.setState({isYearFacetDialogOpen: !this.state.isYearFacetDialogOpen});\n  }\n\n  toggleInstituteFacetDialog = () => {\n    this.setState({isInstituteFacetDialogOpen: !this.state.isInstituteFacetDialogOpen});\n  }\n\n  toggleDirectorFacetDialog = () => {\n    this.setState({isDirectorFacetDialogOpen: !this.state.isDirectorFacetDialogOpen});\n  }\n\n  inputSearchTerm = e => {\n    this.setState({searchTerm: e.target.value},\n      () => {\n        this.getItems(1, true);\n      });\n  }\n\n  getFacetFragment = fkey => {\n    let f = this.state.facets[fkey];\n    return (\n      <Fragment>\n        <a href=\"#\" style={{color: \"#575859\", fontWeight: \"lighter\"}}>{gettext(fkey.charAt(0).toUpperCase() + fkey.slice(1))}</a>\n        {f.termsChecked.length > 0 &&\n        <i className={\"ml-1 fa fa-arrow-\" + (f.order == \"desc\" ? \"up\" : \"down\")}/>\n        }\n        <ul>\n          {f.termsChecked.map((t, idx) =>  (\n            t in f.termEntries &&\n            <Fragment key={`${t}~${idx}`}>\n              <li className=\"ml-5 mb-0\">{t +\n                          (t in f.termEntries ? \" (\" + f.termEntries[t].length + \")\" : \"\")\n              }</li>\n            </Fragment>\n          ))}\n        </ul>\n      </Fragment>\n    );\n  }\n\n  render() {\n    const {isAuthorFacetDialogOpen, isYearFacetDialogOpen, isInstituteFacetDialogOpen, isDirectorFacetDialogOpen,\n      facets, searchTerm} = this.state;\n    const hasSearchTerm = Boolean(searchTerm && searchTerm.trim() != \"\");\n    return (\n      <Fragment>\n        <div className=\"h-100 d-flex flex-column\">\n          <div className=\"top-header d-flex justify-content-between\">\n            <a href={siteRoot}>\n              <img src={mediaUrl + logoPath} height={logoHeight} width={logoWidth} title={siteTitle} alt=\"logo\" />\n            </a>\n            <CommonToolbar onSearchedClick={this.onSearchedClick} />\n          </div>\n          <div className=\"flex-auto container-fluid pt-4 pb-6 o-auto\">\n            <div className=\"row\">\n              {this.state.isAccessDenied\n                ? <h3 className=\"offset-md-2 col-md-8 mt-9 text-center error\">\n                  {gettext('Sie sind leider nicht berechtigt den Projektkatalog zu öffnen. Bitte wenden Sie sich an den Keeper Support.')}\n                </h3>\n                : <div className=\"col-md-8 offset-md-2\">\n                  <h3 className=\"d-flex offset-md-3\"\n                    id=\"header\">{(gettext('The KEEPER Project Catalog of the Max Planck Society'))}</h3>\n                  <div className=\"row\">\n                    <div id=\"facet\" className=\"col-md-3\">\n                      <h3 style={{color: \"#57a5b8\", fontSize: \"1.75em\", fontWeight: 500}}>{gettext('Show Projects')} ({this.state.catalogScope.length})</h3>\n                      <div onClick={this.toggleAuthorFacetDialog}>\n                        {this.getFacetFragment(\"author\")}\n                      </div>\n                      <div onClick={this.toggleYearFacetDialog}>\n                        {this.getFacetFragment(\"year\")}\n                      </div>\n                      <div onClick={this.toggleInstituteFacetDialog}>\n                        {this.getFacetFragment(\"institute\")}\n                      </div>\n                      <div onClick={this.toggleDirectorFacetDialog}>\n                        {this.getFacetFragment(\"director\")}\n                      </div>\n                      {this.state.hasTermsChecked &&\n                      <div className=\"mt-1\">\n                        <a href=\"#\" onClick={this.cleanAllFacets}>{gettext(\"Reset all\")}</a>\n                      </div>\n                      }\n                    </div>\n                    <div className=\"col-md-9\">\n                      <Form>\n                        <FormGroup>\n                          <Input type=\"search\" style={{height: \"60%\"}} placeholder={gettext('Search') + \"...\"} value={this.state.searchTerm} onChange={this.inputSearchTerm}/>\n                        </FormGroup>\n                      </Form>\n                      <Content\n                        isLoading={this.state.isLoading}\n                        errorMsg={this.state.errorMsg}\n                        items={this.state.items}\n                      />\n                    </div>\n                  </div>\n                  <div className=\"row justify-content-center\">\n                    <Paginator\n                      gotoPreviousPage={() => {\n                        this.getItems(this.state.currentPage - 1, false);\n                      }}\n                      gotoNextPage={() => {\n                        this.getItems(this.state.currentPage + 1, false);\n                      }}\n                      currentPage={this.state.currentPage}\n                      hasNextPage={this.state.hasNextPage}\n                      curPerPage={this.state.perPage}\n                      resetPerPage={this.resetPerPage}\n                    />\n                  </div>\n                  <Footer/>\n                </div>\n              }\n            </div>\n          </div>\n        </div>\n        {isAuthorFacetDialogOpen &&\n          <KeeperCatalogFacetDialog\n            name={\"author\"}\n            values={facets.author}\n            hasCatalogSearchTerm={hasSearchTerm}\n            catalogScope={this.state.catalogScope}\n            toggleDialog={this.toggleAuthorFacetDialog}\n            applyFacet={this.applyFacet}\n          />\n        }\n        {isYearFacetDialogOpen &&\n          <KeeperCatalogFacetDialog\n            name={\"year\"}\n            values={facets.year}\n            hasCatalogSearchTerm={hasSearchTerm}\n            catalogScope={this.state.catalogScope}\n            toggleDialog={this.toggleYearFacetDialog}\n            applyFacet={this.applyFacet}\n          />\n        }\n        {isInstituteFacetDialogOpen &&\n          <KeeperCatalogFacetDialog\n            name={\"institute\"}\n            values={facets.institute}\n            hasCatalogSearchTerm={hasSearchTerm}\n            catalogScope={this.state.catalogScope}\n            toggleDialog={this.toggleInstituteFacetDialog}\n            applyFacet={this.applyFacet}\n          />\n        }\n        {isDirectorFacetDialogOpen &&\n          <KeeperCatalogFacetDialog\n            name={\"director\"}\n            values={facets.director}\n            hasCatalogSearchTerm={hasSearchTerm}\n            catalogScope={this.state.catalogScope}\n            toggleDialog={this.toggleDirectorFacetDialog}\n            applyFacet={this.applyFacet}\n          />\n        }\n      </Fragment>\n    );\n  }\n}\n\nclass Content extends React.Component {\n\n  render() {\n    const {\n      isLoading, errorMsg, items,\n    } = this.props;\n\n    if (isLoading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error mt-6 text-center\">{errorMsg}</p>;\n    }\n\n    return (\n      <Fragment>\n        {items.map((item, index) => {\n          return <Item key={index} item={item} />;\n        })}\n      </Fragment>\n    );\n  }\n}\n\nclass Item extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      descExpanded: false,\n    };\n  }\n\n   toggleDescription = () => {\n     this.setState({descExpanded: !this.state.descExpanded});\n   }\n\n  toTitleCase = (txt) => {\n    let str = txt.replace(/([^\\W_]+[^\\s-]*) */g, (t) => {\n      return t.charAt(0).toUpperCase() + t.substr(1).toLowerCase();\n    });\n    return str;\n  }\n\n  getAuthors = (item) => {\n    let author = [];\n    if (\"authors\" in item && item.authors.length > 0) {\n      let authors = item.authors;\n      for (let j = 0; j < authors.length; j++) {\n        let tauthor = \"\";\n        let tauthors = this.toTitleCase(authors[j].name).split(\", \");\n        for (let i = 0; i < tauthors.length; i++) {\n          if (i == 0 && tauthors[i].trim().length) {\n            tauthor += tauthors[i] + \", \";\n          } else if (tauthors[i].trim().length > 1)\n            tauthor += tauthors[i].trim().charAt(0) + \"., \";\n        }\n        tauthor = tauthor.trim().slice(0, -1);\n        if (j >= 5)\n          tauthor = \"et al.\";\n        author.push(tauthor);\n        if (j >= 5)\n          break;\n        if (\"affs\" in authors[j])\n          author.push(this.toTitleCase(authors[j].affs.join(\", \")));\n      }\n    }\n    return author.join(\"; \");\n  }\n\n  //TODO\n  getDirectors = (str) => {\n    let dirs = str.split(\"|\").map((s) => s.trim()).filter(s => s.length > 0);\n    if (dirs.length > 0) {\n      return dirs.join(\"; \");\n    }\n    return null;\n  }\n\n  instituteFragment = (ins) => {\n    const split = ins.split(\";\").map((s) => s.trim()).filter(s => s.length > 0);\n    if (!(split && split.length && split.length > 0))\n      return;\n\n    const dirs = split.length >= 3 ? this.getDirectors(split[2]) : null;\n    return (\n      <Fragment>\n        {split[0] &&\n        <p>{gettext(\"Institute\") + \": \" + split[0]}</p>\n        }\n        {split[1] &&\n        <p>{gettext(\"Department\") + \": \" + split[1]}</p>\n        }\n        {/*{dirs &&*/}\n        {/*  <p>{gettext(\"Directors or PIs\") + \": \" + dirs}</p>*/}\n        {/*}*/}\n      </Fragment>\n    );\n  }\n\n  render() {\n    const item = this.props.item;\n    let showExpandDesc = item.description && item.description.length > maxDescLength;\n    return (\n      <Fragment>\n        <div className=\"item-block\" id={item.repo_id}>\n          <div className=\"row\">\n            <div className=\"col-md-1\">\n              {\n                item.is_certified && <img src=\"/media/custom/certified.png\"/>\n              }\n            </div>\n            <div className=\"col-md-11\">\n              <h3>{\n                item.landing_page_url\n                  ? <a href={\"/landing-page/libs/\" + item.repo_id + \"/\"}>{item.title}</a>\n                  : item.title || gettext(\"Project archive no.\") + \": \" + item.catalog_id\n              }\n              </h3>\n              {\n                item.description && <p>{\n                  showExpandDesc\n                    ? !this.state.descExpanded\n                      ? item.description.substring(0, maxDescLength - 4) + \"...\"\n                      : item.description\n                    : item.description\n                }\n                {\n                  showExpandDesc &&\n                  <i onClick={this.toggleDescription}\n                    className={\"keeper-icon-triangle-\" + (this.state.descExpanded ? \"up\" : \"down\")}\n                  />\n                }\n                </p>\n              }\n              {\n                item.authors && <p>{this.getAuthors(item)}</p>\n              }\n              {\n                item.year && <p>{gettext(\"Year\") + \": \" + item.year}</p>\n              }\n              {\n                item.institute && this.instituteFragment(item.institute)\n              }\n              {\n                item.owner && <p>{gettext(\"Contact\") + \": \" + item.owner.toLowerCase()}</p>\n              }\n              {\n                item.landing_page_url &&\n                  <p>\n                    <a href={\"/landing-page/libs/\" + item.repo_id + \"/\"}>{gettext(\"Landing Page\")}</a>\n                  </p>\n              }\n              {/*{JSON.stringify(item)}*/}\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nclass Footer extends React.Component {\n  render() {\n    return (\n      <Fragment>\n        <div id=\"lg_footer\">\n          <div className=\"container\">\n            <div id=\"keeper-links\" className=\"row\">\n              <div className=\"col-md-3\">\n                <h4>Be informed</h4>\n                <a href=\"https://keeper.mpdl.mpg.de/f/d17ecbb967/\" target=\"_blank\">About Keeper</a><br/>\n                <a href=\"https://keeper.mpdl.mpg.de/f/1b0bfceac2/\" target=\"_blank\">Cared Data Commitment</a><br/>\n                <a href=\"/project-catalog\" target=\"_blank\">Project Catalog</a><br/>\n              </div>\n              <div className=\"col-md-3\">\n                <h4>Get the desktop sync client</h4>\n                <a href=\"/download_client_program/\" target=\"_blank\">Download the Keeper client for Windows, Linux and\n                    Mac</a>\n              </div>\n              <div className=\"col-md-3\">\n                <h4>Find help</h4>\n                <a href=\"mailto:keeper@mpdl.mpg.de\">Contact Keeper Support</a> <br/>\n                <a href=\"https://mpdl.zendesk.com/hc/en-us/categories/360001234340-Keeper\" target=\"_blank\">Help /\n                    Knowledge\n                    Base</a>\n              </div>\n              <div className=\"col-md-3\">\n                <h4>Check terms</h4>\n                <a href=\"https://keeper.mpdl.mpg.de/f/f62758e53c/\" target=\"_blank\">Terms of Services</a> <br/>\n                <a href=\"https://keeper.mpdl.mpg.de/f/17e4e9d648/\" target=\"_blank\">Disclaimer</a><br/>\n                <a href=\"https://keeper.mpdl.mpg.de/f/bf2c8a977f70428587eb/\" target=\"_blank\">Privacy Policy</a>\n              </div>\n            </div>\n            <div id=\"seafile-credits\" className=\"row\">\n              <div className=\"col-md-12 text-center\">\n                <div>\n                  <a href=\"https://www.seafile.com/en/home/\" target=\"_blank\">The software behind Keeper <img\n                    id=\"seafile-logo\"\n                    src=\"/media/custom/seafile_logo_footer.png\"\n                    height=\"35\"/>© 2022 Seafile</a>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nReactDOM.render(\n  <KeeperProjectCatalog />,\n  document.getElementById('wrapper')\n);\n"],"sourceRoot":""}