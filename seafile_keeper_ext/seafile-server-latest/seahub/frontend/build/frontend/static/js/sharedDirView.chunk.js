(this["webpackJsonpseahub-frontend"]=this["webpackJsonpseahub-frontend"]||[]).push([[21],{137:function(e,t,a){"use strict";var i,n=a(6),s=a(7),o=a(9),r=a(8),l=a(2),c=a.n(l),d=a(4),h=a(1),u=a(10),p=a(5),m=a(14),b=a(0),f=function(e){Object(o.a)(a,e);var t=Object(r.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).queryZipProgress=function(){var e=s.state.zipToken;u.b.queryZipProgress(e).then((function(t){var a=t.data;1==a.failed?(clearInterval(i),s.setState({isLoading:!1,errorMsg:a.failed_reason})):(s.setState({zipProgress:0==a.total?"100%":(a.zipped/a.total*100).toFixed(2)+"%"}),a.total==a.zipped&&(clearInterval(i),s.props.toggleDialog(),location.href="".concat(h.lb,"zip/").concat(e)))})).catch((function(e){clearInterval(i);var t=p.a.getErrorMsg(e);s.setState({isLoading:!1,errorMsg:t})}))},s.cancelZipTask=function(){var e=s.state.zipToken;u.b.cancelZipTask(e).then((function(e){})).catch((function(e){}))},s.toggleDialog=function(){var e=s.state.zipProgress;e&&"100%"!=e&&(clearInterval(i),s.cancelZipTask()),s.props.toggleDialog()},s.state={isLoading:!0,errorMsg:"",zipProgress:null},s}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.token,n=t.path,s=t.repoID,o=t.target;(a?o.length?u.b.getShareLinkDirentsZipTask(a,n,o):u.b.getShareLinkZipTask(a,n):u.b.zipDownload(s,n,o)).then((function(t){var a=t.data.zip_token;e.setState({isLoading:!1,errorMsg:"",zipToken:a}),e.queryZipProgress(),i=setInterval(e.queryZipProgress,1e3)})).catch((function(t){var a=p.a.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:a})}))}},{key:"render",value:function(){return Object(b.jsxs)(d.u,{isOpen:!0,toggle:this.toggleDialog,children:[Object(b.jsx)(d.x,{toggle:this.toggleDialog,children:Object(h.nb)("Download")}),Object(b.jsx)(d.v,{children:Object(b.jsx)(g,{data:this.state})})]})}}]),a}(c.a.Component),g=function(e){Object(o.a)(a,e);var t=Object(r.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,a=e.errorMsg,i=e.zipProgress;return t?Object(b.jsx)(m.a,{}):a?Object(b.jsx)("p",{className:"error mt-4 text-center",children:a}):Object(b.jsx)("p",{className:"mt-4 text-center",children:"".concat(Object(h.nb)("Packaging...")," ").concat(i)})}}]),a}(c.a.Component);t.a=f},158:function(e,t,a){"use strict";var i=a(6),n=a(7),s=a(9),o=a(8),r=a(2),l=a.n(r),c=a(1),d=a(317),h=(a(482),a(0)),u=function(e){Object(s.a)(a,e);var t=Object(o.a)(a);function a(e){return Object(i.a)(this,a),t.call(this,e)}return Object(n.a)(a,[{key:"render",value:function(){var e=this.props.imageItems,t=this.props.imageIndex,a=e.length,i=a&&Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)("span",{children:Object(c.nb)("%curr% of %total%").replace("%curr%",t+1).replace("%total%",a)}),Object(h.jsx)("br",{}),Object(h.jsx)("a",{href:e[t].url,target:"_blank",children:Object(c.nb)("Open in New Tab")})]});return Object(h.jsx)(d.a,{mainSrc:e[t].src,imageTitle:e[t].name,imageCaption:i,nextSrc:e[(t+1)%a].src,prevSrc:e[(t+a-1)%a].src,onCloseRequest:this.props.closeImagePopup,onMovePrevRequest:this.props.moveToPrevImage,onMoveNextRequest:this.props.moveToNextImage,imagePadding:70,imageLoadErrorMessage:Object(c.nb)("The image could not be loaded."),prevLabel:Object(c.nb)("Previous (Left arrow key)"),nextLabel:Object(c.nb)("Next (Right arrow key)"),closeLabel:Object(c.nb)("Close (Esc)"),zoomInLabel:Object(c.nb)("Zoom in"),zoomOutLabel:Object(c.nb)("Zoom out")})}}]),a}(l.a.Component);t.a=u},1591:function(e,t,a){a(48),e.exports=a(1688)},1592:function(e,t,a){},1688:function(e,t,a){"use strict";a.r(t);var i=a(109),n=a.n(i),s=a(160),o=a(6),r=a(7),l=a(22),c=a(9),d=a(8),h=a(2),u=a.n(h),p=a(125),m=a.n(p),b=a(20),f=a.n(b),g=a(4),j=a(12),v=a.n(j),O=a(61),x=a(1),y=a(5),S=a(10),k=a(14),w=a(11),C=a(18),I=a(137),D=a(158),M=a(47),F=a(250),_=a.n(F),P=a(0),N="uploading",L="error",T="isSaving",E="uploaded",U=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(o.a)(this,a),(i=t.call(this,e)).onUploadCancel=function(e){e.preventDefault(),i.props.onUploadCancel(i.props.resumableFile)},i.onUploadRetry=function(e){e.preventDefault(),i.props.onUploadRetry(i.props.resumableFile)},i.formatFileSize=function(e){return"number"!==typeof e?"":e>=1e9?(e/1e9).toFixed(1)+" G":e>=1e6?(e/1e6).toFixed(1)+" M":e>=1e3?(e/1e3).toFixed(1)+" K":e.toFixed(1)+" B"},i.state={uploadState:N},i}return Object(r.a)(a,[{key:"componentWillReceiveProps",value:function(e){var t=e.resumableFile,a=N;t.error?a=L:(0!==t.remainingTime||t.isSaved||(a=T),t.isSaved&&(a=E)),this.setState({uploadState:a})}},{key:"render",value:function(){var e=this.props.resumableFile,t=Math.round(100*e.progress()),a=e.error,i=e.newFileName,n=this.formatFileSize(e.size);return Object(P.jsxs)("tr",{className:"file-upload-item",children:[Object(P.jsx)("td",{className:"upload-name",children:Object(P.jsx)("div",{className:"ellipsis",title:i,children:i})}),Object(P.jsx)("td",{className:"ellipsis",children:Object(P.jsx)("span",{className:"file-size",title:n,children:n})}),Object(P.jsxs)("td",{className:"upload-progress ellipsis",children:[(this.state.uploadState===N||this.state.uploadState===T)&&Object(P.jsxs)(h.Fragment,{children:[e.size>=1e8&&Object(P.jsxs)(h.Fragment,{children:[e.isUploading()&&Object(P.jsxs)("div",{className:"progress-container",children:[Object(P.jsx)("div",{className:"progress",children:Object(P.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})}),-1===e.remainingTime&&Object(P.jsx)("div",{className:"progress-text",children:Object(x.nb)("Preparing to upload...")}),e.remainingTime>0&&Object(P.jsxs)("div",{className:"progress-text",children:[Object(x.nb)("Remaining")," ",y.a.formatTime(e.remainingTime)]}),0===e.remainingTime&&Object(P.jsx)("div",{className:"progress-text",children:Object(x.nb)("Indexing...")})]}),!e.isUploading()&&Object(P.jsx)("div",{className:"progress-container d-flex align-items-center",children:Object(P.jsx)("div",{className:"progress",children:Object(P.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})})]}),e.size<1e8&&Object(P.jsx)("div",{className:"progress-container d-flex align-items-center",children:Object(P.jsx)("div",{className:"progress",children:Object(P.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})})]}),this.state.uploadState===L&&Object(P.jsx)("div",{className:"message err-message ml-0",dangerouslySetInnerHTML:{__html:a}})]}),Object(P.jsx)("td",{className:"upload-operation ellipsis",children:Object(P.jsxs)(h.Fragment,{children:[this.state.uploadState===N&&Object(P.jsx)("a",{href:"#",onClick:this.onUploadCancel,children:Object(x.nb)("Cancel")}),this.state.uploadState===L&&Object(P.jsx)("a",{href:"#",onClick:this.onUploadRetry,children:Object(x.nb)("Retry")}),this.state.uploadState===T&&Object(P.jsx)("span",{className:"saving",children:Object(x.nb)("Saving...")}),this.state.uploadState===E&&Object(P.jsx)("span",{className:"uploaded",children:Object(x.nb)("Uploaded")})]})})]})}}]),a}(u.a.Component),z=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.file,t=Object(x.nb)("Please upload files less than {placeholder}M").replace("{placeholder}",x.Kb);return Object(P.jsxs)("tr",{className:"file-upload-item",children:[Object(P.jsx)("td",{className:"upload-name",children:Object(P.jsx)("div",{className:"ellipsis",title:e.name,children:e.name})}),Object(P.jsx)("td",{colSpan:3,className:"error",children:t})]})}}]),a}(u.a.Component),R=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(o.a)(this,a),(i=t.call(this,e)).onCancelAllUploading=function(){i.props.onCancelAllUploading()},i.onMinimizeUpload=function(e){e.nativeEvent.stopImmediatePropagation(),i.setState({isMinimized:!i.state.isMinimized})},i.onCloseUpload=function(e){e.nativeEvent.stopImmediatePropagation(),i.props.onCloseUploadDialog()},i.state={isMinimized:!1},i}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=y.a.formatBitRate(this.props.uploadBitrate),a=Object(x.nb)("File Upload"),i=Object(x.nb)("File Uploading...")+" "+this.props.totalProgress+"% ("+t+")",n=Object(P.jsx)("span",{className:"sf2-icon-minus",onClick:this.onMinimizeUpload}),s=Object(P.jsxs)(h.Fragment,{children:[Object(P.jsx)("span",{className:"sf2-icon-minus",onClick:this.onMinimizeUpload}),Object(P.jsx)("span",{className:"sf2-icon-x1",onClick:this.onCloseUpload})]}),o=this.props,r=o.totalProgress,l=o.allFilesUploaded,c=o.retryFileList;return Object(P.jsxs)("div",{className:"uploader-list-view mw-100",style:{height:this.state.isMinimized?"2.25rem":"20rem"},children:[Object(P.jsxs)("div",{className:"uploader-list-header",children:[Object(P.jsx)("div",{className:"title",children:100===r?a:i}),Object(P.jsx)("div",{className:"uploader-options",children:100===r||l?s:n})]}),Object(P.jsxs)("div",{className:"uploader-list-content",children:[Object(P.jsxs)("div",{className:"text-right mt-2",children:[c.length>0?Object(P.jsx)("span",{className:"cursor-pointer",onClick:this.props.onUploadRetryAll,children:Object(x.nb)("Retry All")}):Object(P.jsx)("span",{className:"cursor-pointer disabled-link",children:Object(x.nb)("Retry All")}),l?Object(P.jsx)("span",{className:"cursor-pointer ml-3 disabled-link",children:Object(x.nb)("Cancel All")}):Object(P.jsx)("span",{className:"cursor-pointer ml-3",onClick:this.onCancelAllUploading,children:Object(x.nb)("Cancel All")})]}),Object(P.jsxs)("table",{className:"table-thead-hidden",children:[Object(P.jsx)("thead",{children:Object(P.jsxs)("tr",{children:[Object(P.jsx)("th",{width:"30%",children:Object(x.nb)("name")}),Object(P.jsx)("th",{width:"20%",children:Object(x.nb)("size")}),Object(P.jsx)("th",{width:"30%",children:Object(x.nb)("progress")}),Object(P.jsx)("th",{width:"20%",children:Object(x.nb)("state")})]})}),Object(P.jsxs)("tbody",{children:[this.props.forbidUploadFileList.map((function(e,t){return Object(P.jsx)(z,{file:e},t)})),this.props.uploadFileList.map((function(t,a){return Object(P.jsx)(U,{resumableFile:t,onUploadCancel:e.props.onUploadCancel,onUploadRetry:e.props.onUploadRetry},a)}))]})]})]})]})}}]),a}(u.a.Component),A=(a(484),function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(o.a)(this,a),(i=t.call(this,e)).componentWillUnmount=function(){window.onbeforeunload=null,!0===i.props.dragAndDrop&&i.resumable.disableDropOnDocument()},i.onbeforeunload=function(){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress)return""},i.bindCallbackHandler=function(){var e=i.props,t=e.minFileSizeErrorCallback,a=e.fileTypeErrorCallback;i.maxFilesErrorCallback&&(i.resumable.opts.maxFilesErrorCallback=i.maxFilesErrorCallback),t&&(i.resumable.opts.minFileSizeErrorCallback=i.props.minFileSizeErrorCallback),i.maxFileSizeErrorCallback&&(i.resumable.opts.maxFileSizeErrorCallback=i.maxFileSizeErrorCallback),a&&(i.resumable.opts.fileTypeErrorCallback=i.props.fileTypeErrorCallback)},i.bindEventHandler=function(){i.resumable.on("chunkingComplete",i.onChunkingComplete.bind(Object(l.a)(i))),i.resumable.on("fileAdded",i.onFileAdded.bind(Object(l.a)(i))),i.resumable.on("filesAddedComplete",i.filesAddedComplete.bind(Object(l.a)(i))),i.resumable.on("fileProgress",i.onFileProgress.bind(Object(l.a)(i))),i.resumable.on("fileSuccess",i.onFileUploadSuccess.bind(Object(l.a)(i))),i.resumable.on("progress",i.onProgress.bind(Object(l.a)(i))),i.resumable.on("complete",i.onComplete.bind(Object(l.a)(i))),i.resumable.on("pause",i.onPause.bind(Object(l.a)(i))),i.resumable.on("fileRetry",i.onFileRetry.bind(Object(l.a)(i))),i.resumable.on("fileError",i.onFileError.bind(Object(l.a)(i))),i.resumable.on("error",i.onError.bind(Object(l.a)(i))),i.resumable.on("beforeCancel",i.onBeforeCancel.bind(Object(l.a)(i))),i.resumable.on("cancel",i.onCancel.bind(Object(l.a)(i))),i.resumable.on("dragstart",i.onDragStart.bind(Object(l.a)(i)))},i.maxFilesErrorCallback=function(e,t){var a=x.Jb,i=Object(x.nb)("Please upload no more than {maxFiles} files at a time.");i=i.replace("{maxFiles}",a),w.a.danger(i)},i.maxFileSizeErrorCallback=function(e){var t=i.state.forbidUploadFileList;t.push(e),i.setState({forbidUploadFileList:t})},i.onChunkingComplete=function(e){!0===i.state.allFilesUploaded&&i.setState({allFilesUploaded:!1});var t="/"===i.props.path?"/":i.props.path+"/",a=e.fileName,n=e.relativePath,s=a===n;if(e.formData={},s)e.formData={parent_dir:t};else{var o=n.slice(0,n.lastIndexOf("/")+1);e.formData={parent_dir:t,relative_path:o}}},i.onFileAdded=function(e,t){if(e.fileName===e.relativePath&&1===t.length){i.setUploadFileList(i.resumable.files);var a=i.props,n=a.token,s=a.relativePath;S.b.sharedLinkGetFileUploadUrl(n,s).then((function(t){i.resumable.opts.target=t.data.upload_link+"?ret-json=1",i.resumableUpload(e)})).catch((function(e){var t=y.a.getErrorMsg(e);w.a.danger(t)}))}else if(i.setUploadFileList(i.resumable.files),!i.isUploadLinkLoaded){i.isUploadLinkLoaded=!0;var o=i.props,r=o.token,l=o.relativePath;S.b.sharedLinkGetFileUploadUrl(r,l).then((function(e){i.resumable.opts.target=e.data.upload_link+"?ret-json=1",i.resumable.upload()})).catch((function(e){var t=y.a.getErrorMsg(e);w.a.danger(t)}))}},i.resumableUpload=function(e){var t=i.props,a=t.repoID,n=t.path;S.b.getFileUploadedBytes(a,n,e.fileName).then((function(t){var a=t.data.uploadedBytes,n=1024*parseInt(x.Zb)*1024||1048576,s=Math.floor(a/n);e.markChunksCompleted(s),i.resumable.upload()})).catch((function(e){var t=y.a.getErrorMsg(e);w.a.danger(t)}))},i.filesAddedComplete=function(e,t){i.state.forbidUploadFileList.length>0&&0===t.length&&i.setState({isUploadProgressDialogShow:!0,totalProgress:100})},i.setUploadFileList=function(){var e=i.resumable.files;i.setState({uploadFileList:e,isUploadProgressDialogShow:!0}),y.a.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)},i.onFileProgress=function(e){var t=i.getBitrate(),a=i.state.uploadFileList.map((function(a){if(a.uniqueIdentifier===e.uniqueIdentifier&&t){var i=8*(a.size-a.size*a.progress()),n=Math.floor(i/t);a.remainingTime=n}return a}));i.setState({uploadBitrate:t,uploadFileList:a})},i.getBitrate=function(){var e=0,t=0,a=(new Date).getTime();if(i.resumable.files.forEach((function(t){e+=t.progress()*t.size})),i.timestamp){var n=a-i.timestamp;if(n<i.bitrateInterval)return i.state.uploadBitrate;(e<i.loaded||0===i.loaded)&&(i.loaded=e),t=(e-i.loaded)*(1e3/n)*8}return i.timestamp=a,i.loaded=e,t},i.onProgress=function(){var e=Math.round(100*i.resumable.progress());i.setState({totalProgress:e}),y.a.registerGlobalVariable("uploader","totalProgress",e)},i.onFileUploadSuccess=function(e,t){var a=e.formData,n=(new Date).getTime()/1e3;t=a.replace?t:JSON.parse(t)[0],a.relative_path;var s={id:t.id,type:"file",name:t.name,size:t.size,mtime:n};i.props.onFileUploadSuccess(s);var o=i.state.uploadFileList.map((function(a){return a.uniqueIdentifier===e.uniqueIdentifier&&(a.newFileName=t.name,a.isSaved=!0),a}));i.setState({uploadFileList:o})},i.onFileError=function(e,t){var a="";if(t){var n=t.replace(/\n/g,"");n=JSON.parse(n),"File locked by others."===(a=n.error)&&(a=Object(x.nb)("File is locked by others.")),"Internal error."===a&&(a=Object(x.nb)("Internal Server Error"))}else a=Object(x.nb)("Network error");var s=i.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(i.state.retryFileList.push(t),t.error=a),t}));i.loaded=0,i.setState({retryFileList:i.state.retryFileList,uploadFileList:s})},i.onComplete=function(){i.notifiedFolders=[],i.isUploadLinkLoaded=!1,i.setState({allFilesUploaded:!0})},i.onPause=function(){},i.onError=function(e){i.isUploadLinkLoaded=!1,y.a.registerGlobalVariable("uploader","totalProgress",100)},i.onFileRetry=function(){},i.onBeforeCancel=function(){},i.onCancel=function(){},i.setHeaders=function(e,t){var a=t.offset,i=t.getOpt("chunkSize"),n=0===e.size?1:e.size,s=0!==a?a*i:0,o=Math.min(n,(a+1)*i)-1;return n-t.endByte<i&&!t.getOpt("forceChunkSize")&&(o=n),{Accept:"application/json; text/javascript, */*; q=0.01","Content-Disposition":'attachment; filename="'+encodeURI(e.fileName)+'"',"Content-Range":"bytes "+s+"-"+o+"/"+n}},i.setQuery=function(e){return e.formData},i.generateUniqueIdentifier=function(e){var t=e.webkitRelativePath||e.relativePath||e.fileName||e.name;return m()(t+new Date)+t},i.onClick=function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},i.onFileUpload=function(){i.uploadInput.current.removeAttribute("webkitdirectory"),i.uploadInput.current.click()},i.onFolderUpload=function(){i.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory"),i.uploadInput.current.click()},i.onDragStart=function(){i.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory")},i.onCloseUploadDialog=function(){i.loaded=0,i.resumable.files=[],i.isUploadLinkLoaded=!1,i.setState({isUploadProgressDialogShow:!1,uploadFileList:[],forbidUploadFileList:[]}),y.a.registerGlobalVariable("uploader","isUploadProgressDialogShow",!1)},i.onUploadCancel=function(e){var t=i.state.uploadFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier||(t.cancel(),!1)}));i.resumable.isUploading()||(i.setState({totalProgress:"100",allFilesUploaded:!0}),i.loaded=0),i.setState({uploadFileList:t})},i.onCancelAllUploading=function(){var e=i.state.uploadFileList.filter((function(e){return!Math.round(1!==e.progress())||(e.cancel(),!1)}));i.loaded=0,i.setState({allFilesUploaded:!0,totalProgress:"100",uploadFileList:e}),i.isUploadLinkLoaded=!1},i.onUploadRetry=function(e){var t=i.props,a=t.token,n=t.relativePath;S.b.sharedLinkGetFileUploadUrl(a,n).then((function(t){i.resumable.opts.target=t.data.upload_link+"?ret-json=1";var a=i.state.retryFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier})),n=i.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.error=null,i.retryUploadFile(t)),t}));i.setState({retryFileList:a,uploadFileList:n})})).catch((function(e){var t=y.a.getErrorMsg(e);w.a.danger(t)}))},i.onUploadRetryAll=function(){var e=i.props,t=e.token,a=e.relativePath;S.b.sharedLinkGetFileUploadUrl(t,a).then((function(e){i.resumable.opts.target=e.data.upload_link+"?ret-json=1",i.state.retryFileList.forEach((function(e){e.error=!1,i.retryUploadFile(e)}));var t=i.state.uploadFileList.slice(0);i.setState({retryFileList:[],uploadFileList:t})})).catch((function(e){var t=y.a.getErrorMsg(e);w.a.danger(t)}))},i.retryUploadFile=function(e){var t=i.props,a=t.repoID,n=t.path,s=e.fileName;if(!(e.fileName===e.relativePath)){var o=e.formData.relative_path;s=("/"===n?n+o:n+"/"+o)+s}e.bootstrap();var r=!1;e.resumableObj.on("chunkingComplete",(function(){r||S.b.getFileUploadedBytes(a,n,s).then((function(t){var a=t.data.uploadedBytes,i=1024*parseInt(x.Zb)*1024||1048576,n=Math.floor(a/i);e.markChunksCompleted(n),e.resumableObj.upload()})).catch((function(e){var t=y.a.getErrorMsg(e);w.a.danger(t)})),r=!0}))},i.uploadFile=function(){var e=i.resumable.files[i.resumable.files.length-1],t=i.props,a=t.token,n=t.relativePath;S.b.sharedLinkGetFileUploadUrl(a,n).then((function(t){i.resumable.opts.target=t.data.upload_link+"?ret-json=1",i.setState({isUploadRemindDialogShow:!1,isUploadProgressDialogShow:!0,uploadFileList:[].concat(Object(M.a)(i.state.uploadFileList),[e])},(function(){i.resumable.upload()})),y.a.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)})).catch((function(e){var t=y.a.getErrorMsg(e);w.a.danger(t)}))},i.cancelFileUpload=function(){i.resumable.files.pop(),i.setState({isUploadRemindDialogShow:!1})},i.state={retryFileList:[],uploadFileList:[],forbidUploadFileList:[],totalProgress:0,isUploadProgressDialogShow:!1,isUploadRemindDialogShow:!1,currentResumableFile:null,uploadBitrate:0,allFilesUploaded:!1},i.uploadInput=u.a.createRef(),i.notifiedFolders=[],i.timestamp=null,i.loaded=0,i.bitrateInterval=500,window.onbeforeunload=i.onbeforeunload,i.isUploadLinkLoaded=!1,i}return Object(r.a)(a,[{key:"componentDidMount",value:function(){this.resumable=new _.a({target:"",query:this.setQuery||{},fileType:this.props.filetypes,maxFiles:x.Jb||void 0,maxFileSize:1e3*x.Kb*1e3||void 0,testMethod:this.props.testMethod||"post",testChunks:this.props.testChunks||!1,headers:this.setHeaders||{},withCredentials:this.props.withCredentials||!1,chunkSize:1024*parseInt(x.Zb)*1024||1048576,simultaneousUploads:this.props.simultaneousUploads||1,fileParameterName:this.props.fileParameterName,generateUniqueIdentifier:this.generateUniqueIdentifier,forceChunkSize:!0,maxChunkRetries:3,minFileSize:0}),this.resumable.assignBrowse(this.uploadInput.current,!0),!0===this.props.dragAndDrop&&this.resumable.enableDropOnDocument(),this.bindCallbackHandler(),this.bindEventHandler()}},{key:"render",value:function(){return Object(P.jsxs)(h.Fragment,{children:[Object(P.jsx)("div",{className:"file-uploader-container",children:Object(P.jsx)("div",{className:"file-uploader",children:Object(P.jsx)("input",{className:"upload-input",type:"file",ref:this.uploadInput,onClick:this.onClick})})}),this.state.isUploadProgressDialogShow&&Object(P.jsx)(R,{retryFileList:this.state.retryFileList,uploadFileList:this.state.uploadFileList,forbidUploadFileList:this.state.forbidUploadFileList,totalProgress:this.state.totalProgress,uploadBitrate:this.state.uploadBitrate,allFilesUploaded:this.state.allFilesUploaded,onCloseUploadDialog:this.onCloseUploadDialog,onCancelAllUploading:this.onCancelAllUploading,onUploadCancel:this.onUploadCancel,onUploadRetry:this.onUploadRetry,onUploadRetryAll:this.onUploadRetryAll})]})}}]),a}(u.a.Component)),B=a(108),q=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(o.a)(this,a),(i=t.call(this,e)).onSaveSharedFile=function(){i.props.handleSaveSharedDir(i.state.repo.repo_id,i.state.selectedPath)},i.onDirentItemClick=function(e,t,a){"dir"===a.type?i.setState({repo:e,selectedPath:t}):i.setState({repo:null,selectedPath:""})},i.onRepoItemClick=function(e){i.setState({repo:e,selectedPath:"/"})},i.state={repo:null,selectedPath:"",errMessage:""},i}return Object(r.a)(a,[{key:"render",value:function(){return Object(P.jsxs)(g.u,{isOpen:!0,className:"sf-save-file",children:[Object(P.jsx)(g.x,{toggle:this.props.toggleCancel,children:Object(x.nb)("Save to:")}),Object(P.jsxs)(g.v,{children:[Object(P.jsx)(B.a,{isShowFile:!1,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:"only_all_repos"}),this.state.errMessage&&Object(P.jsx)(g.a,{color:"danger",children:this.state.errMessage})]}),Object(P.jsxs)(g.w,{children:[Object(P.jsx)(g.c,{color:"secondary",onClick:this.props.toggleCancel,children:Object(x.nb)("Cancel")}),this.state.selectedPath?Object(P.jsx)(g.c,{color:"primary",onClick:this.onSaveSharedFile,children:Object(x.nb)("Submit")}):Object(P.jsx)(g.c,{color:"primary",disabled:!0,children:Object(x.nb)("Submit")})]})]})}}]),a}(u.a.Component),Y=a(318),Z=a(213),X=a(143);a(1592),a(483);v.a.locale(window.app.config.lang);var W=window.app.pageOptions.name,H=window.shared.pageOptions,K=H.token,G=H.dirName,J=H.dirPath,V=H.sharedBy,Q=H.repoID,$=H.relativePath,ee=H.mode,te=H.thumbnailSize,ae=H.zipped,ie=H.trafficOverLimit,ne=H.canDownload,se=H.noQuota,oe=H.canUpload,re=H.enableVideoThumbnail,le=!ie&&ne,ce=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(o.a)(this,a),(i=t.call(this,e)).sortItems=function(e,t){i.setState({sortBy:e,sortOrder:t,items:y.a.sortDirentsInSharedDir(i.state.items,e,t)})},i.getThumbnails=function(){var e=i.state.items.filter((function(e){return!e.is_dir&&(y.a.imageCheck(e.file_name)||re&&y.a.videoCheck(e.file_name))&&!e.encoded_thumbnail_src}));if(0!=e.length){var t=e.length,a=Object(l.a)(i);!function i(n){var s=e[n];S.b.getShareLinkThumbnail(K,s.file_path,te).then((function(e){s.encoded_thumbnail_src=e.data.encoded_thumbnail_src})).catch((function(e){})).then((function(){n<t-1?i(++n):a.setState({items:a.state.items})}))}(0)}},i.renderPath=function(){return Object(P.jsxs)(u.a.Fragment,{children:[ae.map((function(e,t){if(t!=ae.length-1)return Object(P.jsxs)(u.a.Fragment,{children:[Object(P.jsx)("a",{href:"?p=".concat(encodeURIComponent(e.path),"&mode=").concat(ee),className:"mx-1 ellipsis",title:e.name,children:e.name}),Object(P.jsx)("span",{children:" / "})]},t)})),Object(P.jsx)("span",{className:"ml-1 ellipsis",title:ae[ae.length-1].name,children:ae[ae.length-1].name})]})},i.zipDownloadFolder=function(e){x.wc?S.b.getShareLinkZipTask(K,e).then((function(e){var t=e.data.zip_token;location.href="".concat(x.lb,"zip/").concat(t)})).catch((function(e){var t=y.a.getErrorMsg(e);i.setState({isLoading:!1,errorMsg:t})})):i.setState({isZipDialogOpen:!0,zipFolderPath:e})},i.zipDownloadSelectedItems=function(){if(x.wc){var e=i.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}));S.b.getShareLinkDirentsZipTask(K,$,e).then((function(e){var t=e.data.zip_token;location.href="".concat(x.lb,"zip/").concat(t)})).catch((function(e){var t=y.a.getErrorMsg(e);i.setState({isLoading:!1,errorMsg:t})}))}else i.setState({isZipDialogOpen:!0,zipFolderPath:$,selectedItems:i.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}))})},i.saveSelectedItems=function(){i.setState({isSaveSharedDirDialogShow:!0,itemsForSave:i.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}))})},i.saveAllItems=function(){i.setState({isSaveSharedDirDialogShow:!0,itemsForSave:i.state.items.map((function(e){return e.file_name||e.folder_name}))})},i.toggleSaveSharedDirCancel=function(){i.setState({isSaveSharedDirDialogShow:!1,itemsForSave:[]})},i.handleSaveSharedDir=function(e,t){var a=i.state.itemsForSave;S.b.saveSharedDir(e,t,K,$,a).then((function(e){i.setState({isSaveSharedDirDialogShow:!1,itemsForSave:[],isCopyMoveProgressDialogShow:!0,asyncCopyMoveTaskId:e.data.task_id,asyncOperatedFilesLength:a.length},(function(){i.getAsyncCopyMoveProgress()}))})).catch((function(e){var t=y.a.getErrorMsg(e);i.setState({errMessage:t})}))},i.onProgressDialogToggle=function(){if(100!==i.state.asyncOperationProgress){var e=i.state.asyncCopyMoveTaskId;S.b.cancelCopyMoveOperation(e)}i.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1})},i.closeZipDialog=function(){i.setState({isZipDialogOpen:!1,zipFolderPath:"",selectedItems:[]})},i.prepareImageItem=function(e){var t=e.file_name,a="gif"==t.substr(t.lastIndexOf(".")+1).toLowerCase(),i="".concat(x.mc,"d/").concat(K,"/files/?p=").concat(encodeURIComponent(e.file_path));return{name:t,url:i,src:a?"".concat(i,"&raw=1"):"".concat(x.mc,"thumbnail/").concat(K,"/").concat(x.rc).concat(y.a.encodePath(e.file_path))}},i.showImagePopup=function(e){var t=i.state.items.filter((function(e){return!e.is_dir&&y.a.imageCheck(e.file_name)})),a=t.map((function(e){return i.prepareImageItem(e)}));i.setState({isImagePopupOpen:!0,imageItems:a,imageIndex:t.indexOf(e)})},i.closeImagePopup=function(){i.setState({isImagePopupOpen:!1})},i.moveToPrevImage=function(){var e=i.state.imageItems.length;i.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},i.moveToNextImage=function(){var e=i.state.imageItems.length;i.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},i.toggleAllSelected=function(){i.setState((function(e){return{isAllItemsSelected:!e.isAllItemsSelected,items:i.state.items.map((function(t){return t.isSelected=!e.isAllItemsSelected,t}))}}))},i.toggleItemSelected=function(e,t){i.setState({items:i.state.items.map((function(a){return a===e&&(a.isSelected=t),a}))},(function(){i.setState({isAllItemsSelected:!i.state.items.some((function(e){return!e.isSelected}))})}))},i.onUploadFile=function(e){e.nativeEvent.stopImmediatePropagation(),i.uploader.onFileUpload()},i.onFileUploadSuccess=function(e){var t=e.name,a=e.size,n={isSelected:!1,file_name:t,file_path:y.a.joinPath($,t),is_dir:!1,last_modified:v()().format(),size:a},s=i.state.items.filter((function(e){return e.is_dir})),o=Array.from(i.state.items);o.splice(s.length,0,n),i.setState({items:o}),S.b.shareLinksUploadDone(K,y.a.joinPath(J,t))},i.getShareLinkRepoTags=function(){S.b.getShareLinkRepoTags(K).then((function(e){var t=[];e.data.repo_tags.forEach((function(e){var a=new X.a(e);a.fileCount>0&&t.push(a)})),i.setState({usedRepoTags:t}),0!=t.length&&"/"==$&&i.setState({isRepoInfoBarShow:!0})})).catch((function(e){var t=y.a.getErrorMsg(e);w.a.danger(t)}))},i.state={isLoading:!0,errorMsg:"",items:[],isAllItemsSelected:!1,selectedItems:[],sortBy:"name",sortOrder:"asc",isZipDialogOpen:!1,zipFolderPath:"",usedRepoTags:[],isRepoInfoBarShow:!1,isSaveSharedDirDialogShow:!1,itemsForSave:[],asyncCopyMoveTaskId:"",asyncOperationProgress:0,asyncOperatedFilesLength:0,isCopyMoveProgressDialogShow:!1,isImagePopupOpen:!1,imageItems:[],imageIndex:0},i}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this;ie&&w.a.danger(Object(x.nb)("File download is disabled: the share link traffic of owner is used up."),{duration:3}),S.b.listSharedDir(K,$,te).then((function(t){var a=t.data.dirent_list.map((function(e){return e.isSelected=!1,e}));e.setState({isLoading:!1,errorMsg:"",items:y.a.sortDirentsInSharedDir(a,e.state.sortBy,e.state.sortOrder)}),e.getThumbnails()})).catch((function(t){var a=y.a.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:a})})),this.getShareLinkRepoTags()}},{key:"getAsyncCopyMoveProgress",value:function(){var e=Object(s.a)(n.a.mark((function e(){var t,a,i,s,o,r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.asyncCopyMoveTaskId,e.prev=1,e.next=4,S.b.queryAsyncOperationProgress(t);case 4:if(a=e.sent,!(i=a.data).failed){e.next=11;break}return s=Object(x.nb)("Failed to copy files to another library."),w.a.danger(s),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),e.abrupt("return");case 11:if(!i.successful){e.next=16;break}return this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),o=Object(x.nb)("Successfully copied files to another library."),w.a.success(o),e.abrupt("return");case 16:r=i.total?parseInt((i.done/i.total*100).toFixed(2)):0,this.getAsyncCopyMoveProgress(),this.setState({asyncOperationProgress:r}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(1),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1});case 24:case"end":return e.stop()}}),e,this,[[1,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=y.a.isDesktop(),a="btn btn-secondary btn-icon sf-view-mode-btn";return Object(P.jsxs)(u.a.Fragment,{children:[Object(P.jsxs)("div",{className:"h-100 d-flex flex-column",children:[Object(P.jsxs)("div",{className:"top-header d-flex justify-content-between",children:[Object(P.jsx)("a",{href:x.mc,children:Object(P.jsx)("img",{src:x.Lb+x.Gb,height:x.Fb,width:x.Hb,title:x.nc,alt:"logo"})}),W&&Object(P.jsx)(O.a,{})]}),Object(P.jsx)("div",{className:"o-auto",children:Object(P.jsxs)("div",{className:"shared-dir-view-main",children:[Object(P.jsx)("h2",{className:"h3",children:G}),Object(P.jsxs)("p",{children:[Object(x.nb)("Shared by: "),V]}),Object(P.jsxs)("div",{className:"d-flex justify-content-between align-items-center op-bar",children:[Object(P.jsxs)("p",{className:"m-0 mr-4 ellipsis d-flex align-items-center",children:[Object(P.jsx)("span",{className:"flex-none",children:Object(x.nb)("Current path: ")}),this.renderPath()]}),Object(P.jsxs)("div",{className:"flex-none",children:[t&&Object(P.jsxs)("div",{className:"view-mode btn-group",children:[Object(P.jsx)("a",{href:"?p=".concat(encodeURIComponent($),"&mode=list"),className:"".concat(a," sf2-icon-list-view ").concat("list"==ee?"current-mode":""),title:Object(x.nb)("List"),"aria-label":Object(x.nb)("List")}),Object(P.jsx)("a",{href:"?p=".concat(encodeURIComponent($),"&mode=grid"),className:"".concat(a," sf2-icon-grid-view ").concat("grid"==ee?"current-mode":""),title:Object(x.nb)("Grid"),"aria-label":Object(x.nb)("Grid")})]}),oe&&Object(P.jsx)(g.c,{disabled:se,title:se?Object(x.nb)("The owner of this library has run out of space."):"",onClick:this.onUploadFile,className:"ml-2 shared-dir-op-btn shared-dir-upload-btn",children:Object(x.nb)("Upload")}),le&&Object(P.jsx)(h.Fragment,{children:this.state.items.some((function(e){return e.isSelected}))?Object(P.jsxs)(h.Fragment,{children:[Object(P.jsx)(g.c,{color:"success",onClick:this.zipDownloadSelectedItems,className:"ml-2 shared-dir-op-btn",children:Object(x.nb)("ZIP Selected Items")}),ne&&W&&W!==V&&Object(P.jsx)(g.c,{color:"success",onClick:this.saveSelectedItems,className:"ml-2 shared-dir-op-btn",children:Object(x.nb)("Save Selected Items")})]}):Object(P.jsxs)(h.Fragment,{children:[Object(P.jsx)(g.c,{color:"success",onClick:this.zipDownloadFolder.bind(this,$),className:"ml-2 shared-dir-op-btn",children:Object(x.nb)("ZIP")}),ne&&W&&W!==V&&Object(P.jsx)(g.c,{color:"success",onClick:this.saveAllItems,className:"ml-2 shared-dir-op-btn",children:Object(x.nb)("Save")})]})})]})]}),!se&&oe&&Object(P.jsx)(A,{ref:function(t){return e.uploader=t},dragAndDrop:!1,token:K,path:"/"===J?J:J.replace(/\/+$/,""),relativePath:"/"===$?$:$.replace(/\/+$/,""),repoID:Q,onFileUploadSuccess:this.onFileUploadSuccess}),this.state.isRepoInfoBarShow&&Object(P.jsx)(Z.a,{repoID:Q,currentPath:"/",usedRepoTags:this.state.usedRepoTags,shareLinkToken:K,enableFileDownload:le,className:"mx-0"}),Object(P.jsx)(de,{isDesktop:t,isLoading:this.state.isLoading,errorMsg:this.state.errorMsg,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,isAllItemsSelected:this.state.isAllItemsSelected,toggleAllSelected:this.toggleAllSelected,toggleItemSelected:this.toggleItemSelected,zipDownloadFolder:this.zipDownloadFolder,showImagePopup:this.showImagePopup})]})})]}),this.state.isZipDialogOpen&&Object(P.jsx)(C.a,{children:Object(P.jsx)(I.a,{token:K,path:this.state.zipFolderPath,target:this.state.selectedItems,toggleDialog:this.closeZipDialog})}),this.state.isSaveSharedDirDialogShow&&Object(P.jsx)(q,{sharedToken:K,parentDir:$,items:this.state.itemsForSave,toggleCancel:this.toggleSaveSharedDirCancel,handleSaveSharedDir:this.handleSaveSharedDir}),this.state.isCopyMoveProgressDialogShow&&Object(P.jsx)(Y.a,{type:"copy",asyncOperatedFilesLength:this.state.asyncOperatedFilesLength,asyncOperationProgress:this.state.asyncOperationProgress,toggleDialog:this.onProgressDialogToggle}),this.state.isImagePopupOpen&&Object(P.jsx)(C.a,{children:Object(P.jsx)(D.a,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})})]})}}]),a}(u.a.Component),de=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(o.a)(this,a),(i=t.call(this,e)).sortByName=function(e){e.preventDefault();var t="asc"==i.props.sortOrder?"desc":"asc";i.props.sortItems("name",t)},i.sortByTime=function(e){e.preventDefault();var t="asc"==i.props.sortOrder?"desc":"asc";i.props.sortItems("time",t)},i.sortBySize=function(e){e.preventDefault();var t="asc"==i.props.sortOrder?"desc":"asc";i.props.sortItems("size",t)},i}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.isDesktop,i=t.isLoading,n=t.errorMsg,s=t.items,o=t.sortBy,r=t.sortOrder,l=t.isAllItemsSelected;if(i)return Object(P.jsx)(k.a,{});if(n)return Object(P.jsx)("p",{className:"error mt-6 text-center",children:n});var c=Object(P.jsx)("tbody",{children:s.map((function(t,i){return Object(P.jsx)(he,{isDesktop:a,item:t,zipDownloadFolder:e.props.zipDownloadFolder,showImagePopup:e.props.showImagePopup,toggleItemSelected:e.props.toggleItemSelected},i)}))});if(!a)return Object(P.jsxs)("table",{className:"table-hover table-thead-hidden",children:[Object(P.jsx)("thead",{children:Object(P.jsxs)("tr",{children:[Object(P.jsx)("th",{width:"12%"}),Object(P.jsx)("th",{width:"80%"}),Object(P.jsx)("th",{width:"8%"})]})}),c]});var d=Object(P.jsx)("span",{className:"fas ".concat("asc"==r?"fa-caret-up":"fa-caret-down")});return"list"==ee?Object(P.jsxs)("table",{className:"table-hover",children:[Object(P.jsx)("thead",{children:Object(P.jsxs)("tr",{children:[le&&Object(P.jsx)("th",{width:"3%",className:"text-center",children:Object(P.jsx)("input",{type:"checkbox",checked:l,onChange:this.props.toggleAllSelected})}),Object(P.jsx)("th",{width:"5%"}),Object(P.jsx)("th",{width:le?"50%":"53%",children:Object(P.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[Object(x.nb)("Name")," ","name"==o&&d]})}),Object(P.jsx)("th",{width:"8%"}),Object(P.jsx)("th",{width:"14%",children:Object(P.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize,children:[Object(x.nb)("Size")," ","size"==o&&d]})}),Object(P.jsx)("th",{width:"13%",children:Object(P.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[Object(x.nb)("Last Update")," ","time"==o&&d]})}),Object(P.jsx)("th",{width:"7%"})]})}),c]}):Object(P.jsx)("ul",{className:"grid-view",children:s.map((function(t,a){return Object(P.jsx)(ue,{item:t,zipDownloadFolder:e.props.zipDownloadFolder,showImagePopup:e.props.showImagePopup},a)}))})}}]),a}(u.a.Component),he=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(o.a)(this,a),(i=t.call(this,e)).toggleOpMenu=function(){i.setState({isOpMenuOpen:!i.state.isOpMenuOpen})},i.handleMouseOver=function(){i.setState({isIconShown:!0})},i.handleMouseOut=function(){i.setState({isIconShown:!1})},i.zipDownloadFolder=function(e){e.preventDefault(),i.props.zipDownloadFolder.bind(Object(l.a)(i),i.props.item.folder_path)()},i.handleFileClick=function(e){var t=i.props.item;y.a.imageCheck(t.file_name)&&(e.preventDefault(),i.props.showImagePopup(t))},i.toggleItemSelected=function(e){i.props.toggleItemSelected(i.props.item,e.target.checked)},i.state={isIconShown:!1,isOpMenuOpen:!1},i}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.item,a=e.isDesktop,i=this.state.isIconShown,n="",s="";if(t.file_tags&&t.file_tags.length>0&&(n=m()(t.file_name).slice(0,7),s=t.file_tags.map((function(e){return e.tag_name})).join(" ")),t.is_dir)return a?Object(P.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[le&&Object(P.jsx)("td",{className:"text-center",children:Object(P.jsx)("input",{type:"checkbox",checked:t.isSelected,onChange:this.toggleItemSelected})}),Object(P.jsx)("td",{className:"text-center",children:Object(P.jsx)("img",{src:y.a.getFolderIconUrl(),alt:"",width:"24"})}),Object(P.jsx)("td",{children:Object(P.jsx)("a",{href:"?p=".concat(encodeURIComponent(t.folder_path.substr(0,t.folder_path.length-1)),"&mode=").concat(ee),children:t.folder_name})}),Object(P.jsx)("td",{}),Object(P.jsx)("td",{}),Object(P.jsx)("td",{title:v()(t.last_modified).format("llll"),children:v()(t.last_modified).fromNow()}),Object(P.jsx)("td",{children:le&&Object(P.jsx)("a",{role:"button",className:"action-icon sf2-icon-download".concat(i?"":" invisible"),href:"#",onClick:this.zipDownloadFolder,title:Object(x.nb)("Download"),"aria-label":Object(x.nb)("Download")})})]}):Object(P.jsxs)("tr",{children:[Object(P.jsx)("td",{className:"text-center",children:Object(P.jsx)("img",{src:y.a.getFolderIconUrl(),alt:"",width:"24"})}),Object(P.jsxs)("td",{children:[Object(P.jsx)("a",{href:"?p=".concat(encodeURIComponent(t.folder_path.substr(0,t.folder_path.length-1)),"&mode=").concat(ee),children:t.folder_name}),Object(P.jsx)("br",{}),Object(P.jsx)("span",{className:"item-meta-info",children:v()(t.last_modified).fromNow()})]}),Object(P.jsx)("td",{children:le&&Object(P.jsxs)(g.i,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[Object(P.jsx)(g.l,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:Object(x.nb)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),Object(P.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[Object(P.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),Object(P.jsx)("div",{className:"mobile-operation-menu",children:Object(P.jsx)(g.j,{className:"mobile-menu-item",onClick:this.zipDownloadFolder,children:Object(x.nb)("Download")})})]})]})})]});var o="".concat(x.mc,"d/").concat(K,"/files/?p=").concat(encodeURIComponent(t.file_path)),r=t.encoded_thumbnail_src?"".concat(x.mc).concat(t.encoded_thumbnail_src):"";return a?Object(P.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[le&&Object(P.jsx)("td",{className:"text-center",children:Object(P.jsx)("input",{type:"checkbox",checked:t.isSelected,onChange:this.toggleItemSelected})}),Object(P.jsx)("td",{className:"text-center",children:r?Object(P.jsx)("img",{className:"thumbnail",src:r,alt:""}):Object(P.jsx)("img",{src:y.a.getFileIconUrl(t.file_name),alt:"",width:"24"})}),Object(P.jsx)("td",{children:Object(P.jsx)("a",{href:o,onClick:this.handleFileClick,children:t.file_name})}),Object(P.jsx)("td",{className:"tag-list-title",children:t.file_tags&&t.file_tags.length>0&&Object(P.jsxs)(h.Fragment,{children:[Object(P.jsx)("div",{id:"tag-list-title-".concat(n),className:"dirent-item tag-list tag-list-stacked",children:t.file_tags.map((function(e,a){var i=t.file_tags.length;return Object(P.jsx)("span",{className:"file-tag",style:{zIndex:i-a,backgroundColor:e.tag_color}},e.file_tag_id)}))}),Object(P.jsx)(g.I,{target:"tag-list-title-".concat(n),placement:"bottom",children:s})]})}),Object(P.jsx)("td",{children:y.a.bytesToSize(t.size)}),Object(P.jsx)("td",{title:v()(t.last_modified).format("llll"),children:v()(t.last_modified).fromNow()}),Object(P.jsx)("td",{children:le&&Object(P.jsx)("a",{className:"action-icon sf2-icon-download".concat(i?"":" invisible"),href:"".concat(o,"&dl=1"),title:Object(x.nb)("Download"),"aria-label":Object(x.nb)("Download")})})]}):Object(P.jsxs)("tr",{children:[Object(P.jsx)("td",{className:"text-center",children:r?Object(P.jsx)("img",{className:"thumbnail",src:r,alt:""}):Object(P.jsx)("img",{src:y.a.getFileIconUrl(t.file_name),alt:"",width:"24"})}),Object(P.jsxs)("td",{children:[Object(P.jsx)("a",{href:o,onClick:this.handleFileClick,children:t.file_name}),Object(P.jsx)("br",{}),Object(P.jsx)("span",{className:"item-meta-info",children:y.a.bytesToSize(t.size)}),Object(P.jsx)("span",{className:"item-meta-info",children:v()(t.last_modified).fromNow()})]}),Object(P.jsx)("td",{children:le&&Object(P.jsxs)(g.i,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[Object(P.jsx)(g.l,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:Object(x.nb)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),Object(P.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[Object(P.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),Object(P.jsx)("div",{className:"mobile-operation-menu",children:Object(P.jsx)(g.j,{className:"mobile-menu-item",tag:"a",href:"".concat(o,"&dl=1"),children:Object(x.nb)("Download")})})]})]})})]})}}]),a}(u.a.Component),ue=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(o.a)(this,a),(i=t.call(this,e)).handleMouseOver=function(){i.setState({isIconShown:!0})},i.handleMouseOut=function(){i.setState({isIconShown:!1})},i.zipDownloadFolder=function(e){e.preventDefault(),i.props.zipDownloadFolder.bind(Object(l.a)(i),i.props.item.folder_path)()},i.handleFileClick=function(e){var t=i.props.item;y.a.imageCheck(t.file_name)&&(e.preventDefault(),i.props.showImagePopup(t))},i.state={isIconShown:!1},i}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.item,t=this.state.isIconShown;if(e.is_dir){var a="?p=".concat(encodeURIComponent(e.folder_path.substr(0,e.folder_path.length-1)),"&mode=").concat(ee);return Object(P.jsxs)("li",{className:"grid-item",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[Object(P.jsx)("a",{href:a,className:"grid-file-img-link d-block",children:Object(P.jsx)("img",{src:y.a.getFolderIconUrl(!1,192),alt:"",width:"96",height:"96"})}),Object(P.jsx)("a",{href:a,className:"grid-file-name grid-file-name-link",children:e.folder_name}),le&&Object(P.jsx)("a",{role:"button",className:"action-icon sf2-icon-download".concat(t?"":" invisible"),href:"#",onClick:this.zipDownloadFolder,title:Object(x.nb)("Download"),"aria-label":Object(x.nb)("Download")})]})}var i="".concat(x.mc,"d/").concat(K,"/files/?p=").concat(encodeURIComponent(e.file_path)),n=e.encoded_thumbnail_src?"".concat(x.mc).concat(e.encoded_thumbnail_src):"";return Object(P.jsxs)("li",{className:"grid-item",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[Object(P.jsx)("a",{href:i,className:"grid-file-img-link d-block",onClick:this.handleFileClick,children:n?Object(P.jsx)("img",{className:"thumbnail",src:n,alt:""}):Object(P.jsx)("img",{src:y.a.getFileIconUrl(e.file_name,192),alt:"",width:"96",height:"96"})}),Object(P.jsx)("a",{href:i,className:"grid-file-name grid-file-name-link",onClick:this.handleFileClick,children:e.file_name}),le&&Object(P.jsx)("a",{className:"action-icon sf2-icon-download".concat(t?"":" invisible"),href:"".concat(i,"&dl=1"),title:Object(x.nb)("Download"),"aria-label":Object(x.nb)("Download")})]})}}]),a}(u.a.Component);f.a.render(Object(P.jsx)(ce,{}),document.getElementById("wrapper"))},212:function(e,t,a){"use strict";var i=a(6),n=a(7),s=a(9),o=a(8),r=a(2),l=a.n(r),c=a(4),d=a(12),h=a.n(d),u=a(1),p=a(10),m=a(5),b=a(11),f=a(0),g=function(e){Object(s.a)(a,e);var t=Object(o.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onFileTagChanged=function(e){var t=e.parent_path,a={name:e.filename},i="/"===t?t+e.filename:t+"/"+e.filename;n.props.onFileTagChanged(a,i)},n.onDeleteTaggedFile=function(e){var t=n.props.repoID,a=e.file_tag_id;p.b.deleteFileTag(t,a).then((function(t){n.getTaggedFiles(),n.props.updateUsedRepoTags(),n.props.onFileTagChanged&&!e.file_deleted&&n.onFileTagChanged(e)})).catch((function(e){var t=m.a.getErrorMsg(e);b.a.danger(t)}))},n.getTaggedFiles=function(){var e=n.props,t=e.repoID,a=e.currentTag,i=e.shareLinkToken;(i?p.b.getShareLinkTaggedFiles(i,a.id):p.b.listTaggedFiles(t,a.id)).then((function(e){var t=[];void 0!==e.data.tagged_files&&e.data.tagged_files.forEach((function(e){var a=e;t.push(a)})),n.setState({taggedFileList:t})})).catch((function(e){var t=m.a.getErrorMsg(e);b.a.danger(t)}))},n.state={taggedFileList:[]},n}return Object(n.a)(a,[{key:"componentDidMount",value:function(){this.getTaggedFiles()}},{key:"render",value:function(){var e=this,t=this.state.taggedFileList;return Object(f.jsxs)(c.u,{isOpen:!0,style:{maxWidth:"678px"},children:[Object(f.jsx)(c.x,{toggle:this.props.onClose,children:Object(u.nb)("Tagged Files")}),Object(f.jsx)(c.v,{className:"dialog-list-container",children:Object(f.jsxs)("table",{children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{width:"50%",className:"ellipsis",children:Object(u.nb)("Name")}),Object(f.jsx)("th",{width:"20%",children:Object(u.nb)("Size")}),Object(f.jsx)("th",{width:"22%",children:Object(u.nb)("Last Update")}),Object(f.jsx)("th",{width:"8%"})]})}),Object(f.jsx)("tbody",{children:t.map((function(t,a){return Object(f.jsx)(j,{repoID:e.props.repoID,taggedFile:t,onDeleteTaggedFile:e.onDeleteTaggedFile,shareLinkToken:e.props.shareLinkToken,enableFileDownload:e.props.enableFileDownload},a)}))})]})}),Object(f.jsx)(c.w,{children:Object(f.jsx)(c.c,{color:"secondary",onClick:this.props.toggleCancel,children:Object(u.nb)("Close")})})]})}}]),a}(l.a.Component);t.a=g;var j=function(e){Object(s.a)(a,e);var t=Object(o.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.setState({active:!1})},n.deleteFile=function(e){e.preventDefault(),n.props.onDeleteTaggedFile(n.props.taggedFile)},n.state={active:!1},n}return Object(n.a)(a,[{key:"render",value:function(){var e=this.props,t=e.taggedFile,a=e.shareLinkToken,i=e.enableFileDownload,n=t.parent_path?m.a.joinPath(t.parent_path,t.filename):"",s=a?u.mc+"d/"+a+"/files/?p="+m.a.encodePath(n):u.mc+"lib/"+this.props.repoID+"/file"+m.a.encodePath(n);return Object(f.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[t.file_deleted?Object(f.jsx)(r.Fragment,{children:Object(f.jsxs)("td",{colSpan:"3",className:"name",children:[t.filename," ",Object(f.jsx)("span",{style:{color:"red"},children:Object(u.nb)("deleted")})]})}):Object(f.jsxs)(r.Fragment,{children:[Object(f.jsx)("td",{children:Object(f.jsx)("a",{href:s,target:"_blank",className:"d-inline-block w-100 ellipsis",title:t.filename,rel:"noreferrer",children:t.filename})}),Object(f.jsx)("td",{children:m.a.bytesToSize(t.size)}),Object(f.jsx)("td",{children:h.a.unix(t.mtime).fromNow()})]}),Object(f.jsxs)("td",{children:[!a&&Object(f.jsx)("a",{href:"#",role:"button","aria-label":Object(u.nb)("Delete"),title:Object(u.nb)("Delete"),className:"action-icon sf2-icon-x3".concat(this.state.active?"":" invisible"),onClick:this.deleteFile}),a&&i&&Object(f.jsx)("a",{className:"action-icon sf2-icon-download".concat(this.state.active?"":" invisible"),href:"".concat(s,"&dl=1"),title:Object(u.nb)("Download"),"aria-label":Object(u.nb)("Download")})]})]})}}]),a}(l.a.Component)},213:function(e,t,a){"use strict";var i=a(6),n=a(7),s=a(9),o=a(8),r=a(2),l=a.n(r),c=a(18),d=a(212),h=a(4),u=a(1),p=a(10),m=a(12),b=a.n(m),f=a(85),g=a(11),j=a(5),v=function e(t){Object(i.a)(this,e),this.created=t.created_at,this.createdStr=b()(new Date(t.created_at).getTime()).format("YYYY-MM-DD HH:mm"),this.id=t.id,this.ownerNickname=t.owner_nickname,this.originRepoID=t.origin_repo_id,this.draftFilePath=t.draft_file_path},O=a(0),x=function(e){Object(s.a)(a,e);var t=Object(o.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onDeleteDraftItem=function(e){f.a.deleteDraft(e.id).then((function(){var t=n.state.drafts.filter((function(t){return t.id!==e.id}));n.setState({drafts:t});var a=Object(u.nb)("Successfully deleted draft %(draft)s.");a=a.replace("%(draft)s",e.draftFilePath),g.a.success(a)})).catch((function(){var t=Object(u.nb)("Failed to delete draft %(draft)s.");t=t.replace("%(draft)s",e.draftFilePath),g.a.danger(t)}))},n.toggle=function(){n.props.toggle()},n.state={drafts:[]},n}return Object(n.a)(a,[{key:"componentDidMount",value:function(){var e=this;p.b.listRepoDrafts(this.props.repoID).then((function(t){var a=t.data.drafts.map((function(e){return new v(e)}));e.setState({drafts:a})}))}},{key:"render",value:function(){var e=this;return Object(O.jsxs)(h.u,{isOpen:!0,children:[Object(O.jsx)(h.x,{toggle:this.toggle,children:Object(u.nb)("Drafts")}),Object(O.jsx)(h.v,{className:"dialog-list-container",children:Object(O.jsxs)("table",{children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{width:"50%",className:"ellipsis",children:Object(u.nb)("Name")}),Object(O.jsx)("th",{width:"20%",children:Object(u.nb)("Owner")}),Object(O.jsx)("th",{width:"20%",children:Object(u.nb)("Last Update")}),Object(O.jsx)("th",{width:"10%"})]})}),Object(O.jsx)("tbody",{children:this.state.drafts.map((function(t,a){return Object(O.jsx)(y,{draftItem:t,onDeleteDraftItem:e.onDeleteDraftItem},a)}))})]})}),Object(O.jsx)(h.w,{children:Object(O.jsx)(h.c,{color:"secondary",onClick:this.toggle,children:Object(u.nb)("Close")})})]})}}]),a}(l.a.Component),y=function(e){Object(s.a)(a,e);var t=Object(o.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.setState({active:!1})},n.state={active:!1},n}return Object(n.a)(a,[{key:"render",value:function(){var e=this.props.draftItem,t=u.mc+"drafts/"+e.id+"/",a=this.state.active?"action-icon sf2-icon-x3":"action-icon vh sf2-icon-x3";return Object(O.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[Object(O.jsx)("td",{className:"name",children:Object(O.jsx)("a",{href:t,target:"_blank",children:j.a.getFileName(e.draftFilePath)})}),Object(O.jsx)("td",{children:e.ownerNickname}),Object(O.jsx)("td",{children:b()(e.createdStr).fromNow()}),Object(O.jsx)("td",{children:Object(O.jsx)("i",{className:a,onClick:this.props.onDeleteDraftItem.bind(this,e)})})]})}}]),a}(l.a.Component),S=a(34),k=a(14),w=function(e){Object(s.a)(a,e);var t=Object(o.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={readmeContent:null,isLoading:!0},n}return Object(n.a)(a,[{key:"componentDidMount",value:function(){var e=this;p.b.getFileDownloadLink(this.props.repoID,this.props.filePath).then((function(t){p.b.getFileContent(t.data).then((function(t){e.setState({readmeContent:t.data,isLoading:!1})}))})).catch((function(e){var t=j.a.getErrorMsg(e);g.a.danger(t)}))}},{key:"render",value:function(){return Object(O.jsxs)(h.u,{isOpen:!0,toggle:this.props.toggleCancel,className:"readme-dialog",size:"lg",children:[Object(O.jsxs)(h.x,{children:[this.props.fileName,Object(O.jsx)("a",{className:"readme-dialog-edit",href:this.props.href,target:"_blank",children:Object(O.jsx)("i",{className:"fa fa-pencil-alt"})})]}),Object(O.jsx)(h.v,{children:this.state.isLoading?Object(O.jsx)(k.a,{}):Object(O.jsx)(S.d,{markdownContent:this.state.readmeContent,showTOC:!1,scriptSource:u.Lb+"js/mathjax/tex-svg.js"})}),Object(O.jsx)(h.w,{children:Object(O.jsx)(h.c,{color:"secondary",onClick:this.props.toggleCancel,children:Object(u.nb)("Close")})})]})}}]),a}(l.a.Component),C=(a(481),function(e){Object(s.a)(a,e);var t=Object(o.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onListTaggedFiles=function(e){n.setState({currentTag:e,isListTaggedFileShow:!n.state.isListTaggedFileShow})},n.onCloseDialog=function(){n.setState({isListTaggedFileShow:!1})},n.toggleDrafts=function(){n.setState({showRepoDrafts:!n.state.showRepoDrafts})},n.toggleReadme=function(){n.setState({showReadmeDialog:!n.state.showReadmeDialog})},n.state={currentTag:null,isListTaggedFileShow:!1,showRepoDrafts:!1,showReadmeDialog:!1},n}return Object(n.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.repoID,i=t.currentPath,n=t.usedRepoTags,s=t.readmeMarkdown,o=t.draftCounts,r=t.className;void 0===s&&(s=null),void 0===o&&(o=0);var l=null!==s?u.mc+"lib/"+a+"/file"+j.a.joinPath(i,s.name)+"?mode=edit":"",h=null!==s?i+s.name:"";return Object(O.jsxs)("div",{className:"repo-info-bar ".concat(r||""),children:[n.length>0&&Object(O.jsx)("ul",{className:"used-tag-list",children:n.map((function(t){return Object(O.jsxs)("li",{className:"used-tag-item",children:[Object(O.jsx)("span",{className:"used-tag",style:{backgroundColor:t.color}}),Object(O.jsx)("span",{className:"used-tag-name",title:t.name,children:t.name}),Object(O.jsx)("button",{type:"button",className:"used-tag-files border-0 bg-transparent",onClick:e.onListTaggedFiles.bind(e,t),children:t.fileCount>1?t.fileCount+" files":t.fileCount+" file"})]},t.id)}))}),Object(O.jsxs)("div",{className:n.length>0&&s?"file-info-list mt-1":"file-info-list",children:[null!==s&&parseInt(s.size)>1&&Object(O.jsxs)("span",{className:"file-info",onClick:this.toggleReadme,children:[Object(O.jsx)("span",{className:"info-icon sf2-icon-readme"}),Object(O.jsx)("span",{className:"used-tag-name",children:s.name})]}),null!==s&&parseInt(s.size)<2&&Object(O.jsxs)("span",{className:"file-info",children:[Object(O.jsx)("span",{className:"info-icon sf2-icon-readme"}),Object(O.jsx)("a",{className:"used-tag-name",href:l,target:"_blank",rel:"noreferrer",children:s.name})]}),o>0&&Object(O.jsxs)("span",{className:"file-info",children:[Object(O.jsx)("span",{className:"info-icon sf2-icon-drafts"}),Object(O.jsx)("span",{className:"used-tag-name",children:Object(u.nb)("draft")}),Object(O.jsx)("button",{type:"button",className:"used-tag-files border-0 bg-transparent",onClick:this.toggleDrafts,children:o>1?o+" files":o+" file"})]})]}),this.state.isListTaggedFileShow&&Object(O.jsx)(c.a,{children:Object(O.jsx)(d.a,{repoID:a,currentTag:this.state.currentTag,onClose:this.onCloseDialog,toggleCancel:this.onListTaggedFiles,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged,shareLinkToken:this.props.shareLinkToken,enableFileDownload:this.props.enableFileDownload})}),this.state.showRepoDrafts&&Object(O.jsx)(c.a,{children:Object(O.jsx)(x,{toggle:this.toggleDrafts,repoID:this.props.repoID})}),this.state.showReadmeDialog&&Object(O.jsx)(c.a,{children:Object(O.jsx)(w,{toggleCancel:this.toggleReadme,repoID:a,filePath:h,href:l,fileName:s.name})})]})}}]),a}(l.a.Component));t.a=C},317:function(e,t,a){"use strict";(function(e){var i=a(2),n=a.n(i),s=a(3),o=a.n(s),r=a(243),l=a.n(r);function c(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,a){return t&&c(e.prototype,t),a&&c(e,a),e}function h(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){h(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var a=[],i=!0,n=!1,s=void 0;try{for(var o,r=e[Symbol.iterator]();!(i=(o=r.next()).done)&&(a.push(o.value),!t||a.length!==t);i=!0);}catch(l){n=!0,s=l}finally{try{i||null==r.return||r.return()}finally{if(n)throw s}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function v(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return"";var a=e;return t&&Object.keys(t).forEach((function(e){a=a.replace(e,t[e])})),a}function x(){return"undefined"!==typeof e.window?e.window.innerWidth:0}function y(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.window.self,a=t.document.referrer;if(t===e.window.top||!a)return t;var i=function(e){return e.match(/(.*\/\/.*?)(\/|$)/)[1]};return i(t.location.href)===i(a)?y(t.parent):t}var S=300,k=27,w=37,C=39,I=function(t){function a(e){var t,i,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i=this,t=!(s=b(a).call(this,e))||"object"!==typeof s&&"function"!==typeof s?g(i):s,h(g(t),"handleWheel",(function(e){e.preventDefault()})),t.state={isClosing:!e.animationDisabled,shouldAnimate:!1,zoomLevel:0,offsetX:0,offsetY:0,loadErrorStatus:{}},t.outerEl=n.a.createRef(),t.zoomInBtn=n.a.createRef(),t.zoomOutBtn=n.a.createRef(),t.caption=n.a.createRef(),t.closeIfClickInner=t.closeIfClickInner.bind(g(t)),t.handleImageDoubleClick=t.handleImageDoubleClick.bind(g(t)),t.handleImageMouseWheel=t.handleImageMouseWheel.bind(g(t)),t.handleKeyInput=t.handleKeyInput.bind(g(t)),t.handleMouseUp=t.handleMouseUp.bind(g(t)),t.handleMouseDown=t.handleMouseDown.bind(g(t)),t.handleMouseMove=t.handleMouseMove.bind(g(t)),t.handleOuterMousewheel=t.handleOuterMousewheel.bind(g(t)),t.handleTouchStart=t.handleTouchStart.bind(g(t)),t.handleTouchMove=t.handleTouchMove.bind(g(t)),t.handleTouchEnd=t.handleTouchEnd.bind(g(t)),t.handlePointerEvent=t.handlePointerEvent.bind(g(t)),t.handleCaptionMousewheel=t.handleCaptionMousewheel.bind(g(t)),t.handleWindowResize=t.handleWindowResize.bind(g(t)),t.handleZoomInButtonClick=t.handleZoomInButtonClick.bind(g(t)),t.handleZoomOutButtonClick=t.handleZoomOutButtonClick.bind(g(t)),t.requestClose=t.requestClose.bind(g(t)),t.requestMoveNext=t.requestMoveNext.bind(g(t)),t.requestMovePrev=t.requestMovePrev.bind(g(t)),t}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(a,t),d(a,null,[{key:"isTargetMatchImage",value:function(e){return e&&/ril-image-current/.test(e.className)}},{key:"parseMouseEvent",value:function(e){return{id:"mouse",source:1,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parseTouchPointer",value:function(e){return{id:e.identifier,source:2,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parsePointerEvent",value:function(e){return{id:e.pointerId,source:3,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"getTransform",value:function(e){var t=e.x,a=void 0===t?0:t,i=e.y,n=void 0===i?0:i,s=e.zoom,o=void 0===s?1:s,r=e.width,l=e.targetWidth,c=a,d=x();r>d&&(c+=(d-r)/2);var h=o*(l/r);return{transform:"translate3d(".concat(c,"px,").concat(n,"px,0) scale3d(").concat(h,",").concat(h,",1)")}}}]),d(a,[{key:"UNSAFE_componentWillMount",value:function(){this.timeouts=[],this.currentAction=0,this.eventsSource=0,this.pointerList=[],this.preventInnerClose=!1,this.preventInnerCloseTimeout=null,this.keyPressed=!1,this.imageCache={},this.lastKeyDownTime=0,this.resizeTimeout=null,this.wheelActionTimeout=null,this.resetScrollTimeout=null,this.scrollX=0,this.scrollY=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,this.pinchTouchList=null,this.pinchDistance=0,this.keyCounter=0,this.moveRequested=!1,this.props.animationDisabled||this.setState({isClosing:!1})}},{key:"componentDidMount",value:function(){var e=this;this.windowContext=y(),this.listeners={resize:this.handleWindowResize,mouseup:this.handleMouseUp,touchend:this.handleTouchEnd,touchcancel:this.handleTouchEnd,pointerdown:this.handlePointerEvent,pointermove:this.handlePointerEvent,pointerup:this.handlePointerEvent,pointercancel:this.handlePointerEvent},Object.keys(this.listeners).forEach((function(t){e.windowContext.addEventListener(t,e.listeners[t])})),document.addEventListener("wheel",this.handleWheel,{passive:!1}),this.loadAllImages()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this,a=!1,i={},n={};this.getSrcTypes().forEach((function(s){t.props[s.name]!==e[s.name]&&(a=!0,i[t.props[s.name]]=!0,n[e[s.name]]=!0)})),(a||this.moveRequested)&&(Object.keys(i).forEach((function(e){!(e in n)&&e in t.imageCache&&(t.imageCache[e].loaded=!1)})),this.moveRequested=!1,this.loadAllImages(e))}},{key:"shouldComponentUpdate",value:function(){return!this.moveRequested}},{key:"componentWillUnmount",value:function(){var e=this;this.didUnmount=!0,Object.keys(this.listeners).forEach((function(t){e.windowContext.removeEventListener(t,e.listeners[t])})),document.removeEventListener("wheel",this.handleWheel,{passive:!1}),this.timeouts.forEach((function(e){return clearTimeout(e)}))}},{key:"setTimeout",value:function(e){function t(t,a){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var a=this,i=setTimeout((function(){a.timeouts=a.timeouts.filter((function(e){return e!==i})),e()}),t);return this.timeouts.push(i),i}))},{key:"setPreventInnerClose",value:function(){var e=this;this.preventInnerCloseTimeout&&this.clearTimeout(this.preventInnerCloseTimeout),this.preventInnerClose=!0,this.preventInnerCloseTimeout=this.setTimeout((function(){e.preventInnerClose=!1,e.preventInnerCloseTimeout=null}),100)}},{key:"getBestImageForType",value:function(e){var t=this.props[e],a={};if(this.isImageLoaded(t))a=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height);else{if(!this.isImageLoaded(this.props["".concat(e,"Thumbnail")]))return null;t=this.props["".concat(e,"Thumbnail")],a=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height,!0)}return{src:t,height:this.imageCache[t].height,width:this.imageCache[t].width,targetHeight:a.height,targetWidth:a.width}}},{key:"getFitSizes",value:function(e,t,a){var i=this.getLightboxRect(),n=i.height-2*this.props.imagePadding,s=i.width-2*this.props.imagePadding;return a||(n=Math.min(n,t),s=Math.min(s,e)),s/n>e/t?{width:e*n/t,height:n}:{width:s,height:t*s/e}}},{key:"getMaxOffsets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel,t=this.getBestImageForType("mainSrc");if(null===t)return{maxX:0,minX:0,maxY:0,minY:0};var a=this.getLightboxRect(),i=this.getZoomMultiplier(e),n=0,s=0;return{maxX:n=i*t.width-a.width<0?(a.width-i*t.width)/2:(i*t.width-a.width)/2,maxY:s=i*t.height-a.height<0?(a.height-i*t.height)/2:(i*t.height-a.height)/2,minX:-1*n,minY:-1*s}}},{key:"getSrcTypes",value:function(){return[{name:"mainSrc",keyEnding:"i".concat(this.keyCounter)},{name:"mainSrcThumbnail",keyEnding:"t".concat(this.keyCounter)},{name:"nextSrc",keyEnding:"i".concat(this.keyCounter+1)},{name:"nextSrcThumbnail",keyEnding:"t".concat(this.keyCounter+1)},{name:"prevSrc",keyEnding:"i".concat(this.keyCounter-1)},{name:"prevSrcThumbnail",keyEnding:"t".concat(this.keyCounter-1)}]}},{key:"getZoomMultiplier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel;return Math.pow(1.007,e)}},{key:"getLightboxRect",value:function(){return this.outerEl.current?this.outerEl.current.getBoundingClientRect():{width:x(),height:"undefined"!==typeof e.window?e.window.innerHeight:0,top:0,right:0,bottom:0,left:0}}},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){this.timeouts=this.timeouts.filter((function(t){return t!==e})),clearTimeout(e)}))},{key:"changeZoom",value:function(e,t,a){if(this.props.enableZoom){var i=Math.max(0,Math.min(S,e));if(i!==this.state.zoomLevel)if(0!==i){var n=this.getBestImageForType("mainSrc");if(null!==n){var s=this.getZoomMultiplier(),o=this.getZoomMultiplier(i),r=this.getLightboxRect(),l="undefined"!==typeof t?t-r.left:r.width/2,c="undefined"!==typeof a?a-r.top:r.height/2,d=(r.width-n.width*s)/2,h=(r.height-n.height*s)/2,u=l-(l-(d-this.state.offsetX))/s*o,p=c-(c-(h-this.state.offsetY))/s*o,m=(r.width-n.width*o)/2-u,b=(r.height-n.height*o)/2-p;if(3!==this.currentAction){var f=this.getMaxOffsets();this.state.zoomLevel>i&&(m=Math.max(f.minX,Math.min(f.maxX,m)),b=Math.max(f.minY,Math.min(f.maxY,b)))}this.setState({zoomLevel:i,offsetX:m,offsetY:b})}}else this.setState({zoomLevel:i,offsetX:0,offsetY:0})}}},{key:"closeIfClickInner",value:function(e){!this.preventInnerClose&&e.target.className.search(/\bril-inner\b/)>-1&&this.requestClose(e)}},{key:"handleKeyInput",value:function(e){if(e.stopPropagation(),!this.isAnimating())if("keyup"!==e.type){var t=e.which||e.keyCode,a=new Date;if(!(a.getTime()-this.lastKeyDownTime<this.props.keyRepeatLimit&&t!==k))switch(this.lastKeyDownTime=a.getTime(),t){case k:e.preventDefault(),this.requestClose(e);break;case w:if(!this.props.prevSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMovePrev(e);break;case C:if(!this.props.nextSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMoveNext(e)}}else this.lastKeyDownTime-=this.props.keyRepeatKeyupBonus}},{key:"handleOuterMousewheel",value:function(e){var t=this;e.stopPropagation(),this.clearTimeout(this.resetScrollTimeout),this.resetScrollTimeout=this.setTimeout((function(){t.scrollX=0,t.scrollY=0}),300)}},{key:"handleImageMouseWheel",value:function(e){if(parseInt(e.deltaY)!==parseFloat(e.deltaY)){if(Math.abs(e.deltaY)>=Math.abs(e.deltaX)){if(e.stopPropagation(),Math.abs(e.deltaY)<1)return;this.scrollX=0,this.scrollY+=e.deltaY,this.changeZoom(this.state.zoomLevel-e.deltaY,e.clientX,e.clientY)}}else if(Math.abs(e.deltaY)>Math.abs(e.deltaX)){var t=this.state.offsetY+e.deltaY;this.setState({offsetY:t})}else{var a=this.state.offsetX+e.deltaX;this.setState({offsetX:a})}}},{key:"handleImageDoubleClick",value:function(e){this.state.zoomLevel>0?this.changeZoom(0,e.clientX,e.clientY):this.changeZoom(this.state.zoomLevel+100,e.clientX,e.clientY)}},{key:"shouldHandleEvent",value:function(e){if(this.eventsSource===e)return!0;if(0===this.eventsSource)return this.eventsSource=e,!0;switch(e){case 1:return!1;case 2:return this.eventsSource=2,this.filterPointersBySource(),!0;case 3:return 1===this.eventsSource&&(this.eventsSource=3,this.filterPointersBySource(),!0);default:return!1}}},{key:"addPointer",value:function(e){this.pointerList.push(e)}},{key:"removePointer",value:function(e){this.pointerList=this.pointerList.filter((function(t){return t.id!==e.id}))}},{key:"filterPointersBySource",value:function(){var e=this;this.pointerList=this.pointerList.filter((function(t){return t.source===e.eventsSource}))}},{key:"handleMouseDown",value:function(e){this.shouldHandleEvent(1)&&a.isTargetMatchImage(e.target)&&(this.addPointer(a.parseMouseEvent(e)),this.multiPointerStart(e))}},{key:"handleMouseMove",value:function(e){this.shouldHandleEvent(1)&&this.multiPointerMove(e,[a.parseMouseEvent(e)])}},{key:"handleMouseUp",value:function(e){this.shouldHandleEvent(1)&&(this.removePointer(a.parseMouseEvent(e)),this.multiPointerEnd(e))}},{key:"handlePointerEvent",value:function(e){if(this.shouldHandleEvent(3))switch(e.type){case"pointerdown":a.isTargetMatchImage(e.target)&&(this.addPointer(a.parsePointerEvent(e)),this.multiPointerStart(e));break;case"pointermove":this.multiPointerMove(e,[a.parsePointerEvent(e)]);break;case"pointerup":case"pointercancel":this.removePointer(a.parsePointerEvent(e)),this.multiPointerEnd(e)}}},{key:"handleTouchStart",value:function(e){var t=this;this.shouldHandleEvent(2)&&a.isTargetMatchImage(e.target)&&([].forEach.call(e.changedTouches,(function(e){return t.addPointer(a.parseTouchPointer(e))})),this.multiPointerStart(e))}},{key:"handleTouchMove",value:function(e){this.shouldHandleEvent(2)&&this.multiPointerMove(e,[].map.call(e.changedTouches,(function(e){return a.parseTouchPointer(e)})))}},{key:"handleTouchEnd",value:function(e){var t=this;this.shouldHandleEvent(2)&&([].map.call(e.changedTouches,(function(e){return t.removePointer(a.parseTouchPointer(e))})),this.multiPointerEnd(e))}},{key:"decideMoveOrSwipe",value:function(e){this.state.zoomLevel<=0?this.handleSwipeStart(e):this.handleMoveStart(e)}},{key:"multiPointerStart",value:function(e){switch(this.handleEnd(null),this.pointerList.length){case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"multiPointerMove",value:function(e,t){switch(this.currentAction){case 1:e.preventDefault(),this.handleMove(t[0]);break;case 2:e.preventDefault(),this.handleSwipe(t[0]);break;case 3:e.preventDefault(),this.handlePinch(t)}}},{key:"multiPointerEnd",value:function(e){switch(0!==this.currentAction&&(this.setPreventInnerClose(),this.handleEnd(e)),this.pointerList.length){case 0:this.eventsSource=0;break;case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"handleEnd",value:function(e){switch(this.currentAction){case 1:this.handleMoveEnd(e);break;case 2:this.handleSwipeEnd(e);break;case 3:this.handlePinchEnd(e)}}},{key:"handleMoveStart",value:function(e){var t=e.x,a=e.y;this.props.enableZoom&&(this.currentAction=1,this.moveStartX=t,this.moveStartY=a,this.moveStartOffsetX=this.state.offsetX,this.moveStartOffsetY=this.state.offsetY)}},{key:"handleMove",value:function(e){var t=e.x,a=e.y,i=this.moveStartX-t+this.moveStartOffsetX,n=this.moveStartY-a+this.moveStartOffsetY;this.state.offsetX===i&&this.state.offsetY===n||this.setState({offsetX:i,offsetY:n})}},{key:"handleMoveEnd",value:function(){var e=this;this.currentAction=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0;var t=this.getMaxOffsets(),a=Math.max(t.minX,Math.min(t.maxX,this.state.offsetX)),i=Math.max(t.minY,Math.min(t.maxY,this.state.offsetY));a===this.state.offsetX&&i===this.state.offsetY||(this.setState({offsetX:a,offsetY:i,shouldAnimate:!0}),this.setTimeout((function(){e.setState({shouldAnimate:!1})}),this.props.animationDuration))}},{key:"handleSwipeStart",value:function(e){var t=e.x,a=e.y;this.currentAction=2,this.swipeStartX=t,this.swipeStartY=a,this.swipeEndX=t,this.swipeEndY=a}},{key:"handleSwipe",value:function(e){var t=e.x,a=e.y;this.swipeEndX=t,this.swipeEndY=a}},{key:"handleSwipeEnd",value:function(e){var t=this.swipeEndX-this.swipeStartX,a=Math.abs(t),i=Math.abs(this.swipeEndY-this.swipeStartY);if(this.currentAction=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,!(!e||this.isAnimating()||a<1.5*i)){if(a<200)if(a<this.getLightboxRect().width/4)return;t>0&&this.props.prevSrc?(e.preventDefault(),this.requestMovePrev()):t<0&&this.props.nextSrc&&(e.preventDefault(),this.requestMoveNext())}}},{key:"calculatePinchDistance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,t=j(e,2),a=t[0],i=t[1];return Math.sqrt(Math.pow(a.x-i.x,2)+Math.pow(a.y-i.y,2))}},{key:"calculatePinchCenter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,t=j(e,2),a=t[0],i=t[1];return{x:a.x-(a.x-i.x)/2,y:a.y-(a.y-i.y)/2}}},{key:"handlePinchStart",value:function(e){this.props.enableZoom&&(this.currentAction=3,this.pinchTouchList=e.map((function(e){return{id:e.id,x:e.x,y:e.y}})),this.pinchDistance=this.calculatePinchDistance())}},{key:"handlePinch",value:function(e){this.pinchTouchList=this.pinchTouchList.map((function(t){for(var a=0;a<e.length;a+=1)if(e[a].id===t.id)return e[a];return t}));var t=this.calculatePinchDistance(),a=this.state.zoomLevel+t-this.pinchDistance;this.pinchDistance=t;var i=this.calculatePinchCenter(this.pinchTouchList),n=i.x,s=i.y;this.changeZoom(a,n,s)}},{key:"handlePinchEnd",value:function(){this.currentAction=0,this.pinchTouchList=null,this.pinchDistance=0}},{key:"handleWindowResize",value:function(){this.clearTimeout(this.resizeTimeout),this.resizeTimeout=this.setTimeout(this.forceUpdate.bind(this),100)}},{key:"handleZoomInButtonClick",value:function(){var e=this.state.zoomLevel+100;this.changeZoom(e),e===S&&this.zoomOutBtn.current.focus()}},{key:"handleZoomOutButtonClick",value:function(){var e=this.state.zoomLevel-100;this.changeZoom(e),0===e&&this.zoomInBtn.current.focus()}},{key:"handleCaptionMousewheel",value:function(e){if(e.stopPropagation(),this.caption.current){var t=this.caption.current.getBoundingClientRect().height,a=this.caption.current,i=a.scrollHeight,n=a.scrollTop;(e.deltaY>0&&t+n>=i||e.deltaY<0&&n<=0)&&e.preventDefault()}}},{key:"isAnimating",value:function(){return this.state.shouldAnimate||this.state.isClosing}},{key:"isImageLoaded",value:function(e){return e&&e in this.imageCache&&this.imageCache[e].loaded}},{key:"loadImage",value:function(t,a,i){var n=this;if(this.isImageLoaded(a))this.setTimeout((function(){i()}),1);else{var s=new e.Image;this.props.imageCrossOrigin&&(s.crossOrigin=this.props.imageCrossOrigin),s.onerror=function(e){n.props.onImageLoadError(a,t,e),n.setState((function(e){return{loadErrorStatus:m({},e.loadErrorStatus,h({},t,!0))}})),i(e)},s.onload=function(){n.props.onImageLoad(a,t,s),n.imageCache[a]={loaded:!0,width:s.width,height:s.height},i()},s.src=a}}},{key:"loadAllImages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,a=function(t,a){return function(i){i||e.props[t]!==a||e.didUnmount||e.forceUpdate()}};this.getSrcTypes().forEach((function(i){var n=i.name;t[n]&&e.state.loadErrorStatus[n]&&e.setState((function(e){return{loadErrorStatus:m({},e.loadErrorStatus,h({},n,!1))}})),t[n]&&!e.isImageLoaded(t[n])&&e.loadImage(n,t[n],a(n,t[n]))}))}},{key:"requestClose",value:function(e){var t=this,a=function(){return t.props.onCloseRequest(e)};this.props.animationDisabled||"keydown"===e.type&&!this.props.animationOnKeyInput?a():(this.setState({isClosing:!0}),this.setTimeout(a,this.props.animationDuration))}},{key:"requestMove",value:function(e,t){var a=this,i={zoomLevel:0,offsetX:0,offsetY:0};this.props.animationDisabled||this.keyPressed&&!this.props.animationOnKeyInput||(i.shouldAnimate=!0,this.setTimeout((function(){return a.setState({shouldAnimate:!1})}),this.props.animationDuration)),this.keyPressed=!1,this.moveRequested=!0,"prev"===e?(this.keyCounter-=1,this.setState(i),this.props.onMovePrevRequest(t)):(this.keyCounter+=1,this.setState(i),this.props.onMoveNextRequest(t))}},{key:"requestMoveNext",value:function(e){this.requestMove("next",e)}},{key:"requestMovePrev",value:function(e){this.requestMove("prev",e)}},{key:"render",value:function(){var t=this,i=this.props,s=i.animationDisabled,o=i.animationDuration,r=i.clickOutsideToClose,c=i.discourageDownloads,d=i.enableZoom,h=i.imageTitle,p=i.nextSrc,b=i.prevSrc,f=i.toolbarButtons,g=i.reactModalStyle,j=i.onAfterOpen,x=i.imageCrossOrigin,y=i.reactModalProps,k=this.state,w=k.zoomLevel,C=k.offsetX,I=k.offsetY,D=k.isClosing,M=k.loadErrorStatus,F=this.getLightboxRect(),_={};!s&&this.isAnimating()&&(_=m({},_,{transition:"transform ".concat(o,"ms")}));var P={};this.getSrcTypes().forEach((function(e){var t=e.name,a=e.keyEnding;P[t]=a}));var N=[],L=function(e,i,s){if(t.props[e]){var o=t.getBestImageForType(e),r=m({},_,{},a.getTransform(m({},s,{},o)));w>0&&(r.cursor="move");var l;if(null===o&&(l=M,Object.keys(l).some((function(e){return l[e]}))))N.push(n.a.createElement("div",{className:"".concat(i," ril__image ril-errored"),style:r,key:t.props[e]+P[e]},n.a.createElement("div",{className:"ril__errorContainer"},t.props.imageLoadErrorMessage)));else if(null!==o){var d=o.src;c?(r.backgroundImage="url('".concat(d,"')"),N.push(n.a.createElement("div",{className:"".concat(i," ril__image ril__imageDiscourager"),onDoubleClick:t.handleImageDoubleClick,onWheel:t.handleImageMouseWheel,style:r,key:d+P[e]},n.a.createElement("div",{className:"ril-download-blocker ril__downloadBlocker"})))):N.push(n.a.createElement("img",u({},x?{crossOrigin:x}:{},{className:"".concat(i," ril__image"),onDoubleClick:t.handleImageDoubleClick,onWheel:t.handleImageMouseWheel,onDragStart:function(e){return e.preventDefault()},style:r,src:d,key:d+P[e],alt:"string"===typeof h?h:O("Image"),draggable:!1})))}else{var p=n.a.createElement("div",{className:"ril-loading-circle ril__loadingCircle ril__loadingContainer__icon"},v(new Array(12)).map((function(e,t){return n.a.createElement("div",{key:t,className:"ril-loading-circle-point ril__loadingCirclePoint"})})));N.push(n.a.createElement("div",{className:"".concat(i," ril__image ril-not-loaded"),style:r,key:t.props[e]+P[e]},n.a.createElement("div",{className:"ril__loadingContainer"},p)))}}},T=this.getZoomMultiplier();L("nextSrc","ril-image-next ril__imageNext",{x:F.width}),L("mainSrc","ril-image-current",{x:-1*C,y:-1*I,zoom:T}),L("prevSrc","ril-image-prev ril__imagePrev",{x:-1*F.width});var E={overlay:m({zIndex:1e3,backgroundColor:"transparent"},g.overlay),content:m({backgroundColor:"transparent",overflow:"hidden",border:"none",borderRadius:0,padding:0,top:0,left:0,right:0,bottom:0},g.content)};return n.a.createElement(l.a,u({isOpen:!0,onRequestClose:r?this.requestClose:void 0,onAfterOpen:function(){t.outerEl.current&&t.outerEl.current.focus(),j()},style:E,contentLabel:O("Lightbox"),appElement:"undefined"!==typeof e.window?e.window.document.body:void 0},y),n.a.createElement("div",{className:"ril-outer ril__outer ril__outerAnimating ".concat(this.props.wrapperClassName," ").concat(D?"ril-closing ril__outerClosing":""),style:{transition:"opacity ".concat(o,"ms"),animationDuration:"".concat(o,"ms"),animationDirection:D?"normal":"reverse"},ref:this.outerEl,onWheel:this.handleOuterMousewheel,onMouseMove:this.handleMouseMove,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,tabIndex:"-1",onKeyDown:this.handleKeyInput,onKeyUp:this.handleKeyInput},n.a.createElement("div",{className:"ril-inner ril__inner",onClick:r?this.closeIfClickInner:void 0},N),b&&n.a.createElement("button",{type:"button",className:"ril-prev-button ril__navButtons ril__navButtonPrev",key:"prev","aria-label":this.props.prevLabel,onClick:this.isAnimating()?void 0:this.requestMovePrev}),p&&n.a.createElement("button",{type:"button",className:"ril-next-button ril__navButtons ril__navButtonNext",key:"next","aria-label":this.props.nextLabel,onClick:this.isAnimating()?void 0:this.requestMoveNext}),n.a.createElement("div",{className:"ril-toolbar ril__toolbar"},n.a.createElement("ul",{className:"ril-toolbar-left ril__toolbarSide ril__toolbarLeftSide"},n.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},n.a.createElement("span",{className:"ril-toolbar__item__child ril__toolbarItemChild"},h))),n.a.createElement("ul",{className:"ril-toolbar-right ril__toolbarSide ril__toolbarRightSide"},f&&f.map((function(e,t){return n.a.createElement("li",{key:"button_".concat(t+1),className:"ril-toolbar__item ril__toolbarItem"},e)})),d&&n.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},n.a.createElement("button",{type:"button",key:"zoom-in","aria-label":this.props.zoomInLabel,className:["ril-zoom-in","ril__toolbarItemChild","ril__builtinButton","ril__zoomInButton"].concat(v(w===S?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomInBtn,disabled:this.isAnimating()||w===S,onClick:this.isAnimating()||w===S?void 0:this.handleZoomInButtonClick})),d&&n.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},n.a.createElement("button",{type:"button",key:"zoom-out","aria-label":this.props.zoomOutLabel,className:["ril-zoom-out","ril__toolbarItemChild","ril__builtinButton","ril__zoomOutButton"].concat(v(0===w?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomOutBtn,disabled:this.isAnimating()||0===w,onClick:this.isAnimating()||0===w?void 0:this.handleZoomOutButtonClick})),n.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},n.a.createElement("button",{type:"button",key:"close","aria-label":this.props.closeLabel,className:"ril-close ril-toolbar__item__child ril__toolbarItemChild ril__builtinButton ril__closeButton",onClick:this.isAnimating()?void 0:this.requestClose})))),this.props.imageCaption&&n.a.createElement("div",{onWheel:this.handleCaptionMousewheel,onMouseDown:function(e){return e.stopPropagation()},className:"ril-caption ril__caption",ref:this.caption},n.a.createElement("div",{className:"ril-caption-content ril__captionContent"},this.props.imageCaption))))}}]),a}(i.Component);I.propTypes={mainSrc:o.a.string.isRequired,prevSrc:o.a.string,nextSrc:o.a.string,mainSrcThumbnail:o.a.string,prevSrcThumbnail:o.a.string,nextSrcThumbnail:o.a.string,onCloseRequest:o.a.func.isRequired,onMovePrevRequest:o.a.func,onMoveNextRequest:o.a.func,onImageLoadError:o.a.func,onImageLoad:o.a.func,onAfterOpen:o.a.func,discourageDownloads:o.a.bool,animationDisabled:o.a.bool,animationOnKeyInput:o.a.bool,animationDuration:o.a.number,keyRepeatLimit:o.a.number,keyRepeatKeyupBonus:o.a.number,imageTitle:o.a.node,imageCaption:o.a.node,imageCrossOrigin:o.a.string,reactModalStyle:o.a.object,imagePadding:o.a.number,wrapperClassName:o.a.string,toolbarButtons:o.a.arrayOf(o.a.node),clickOutsideToClose:o.a.bool,enableZoom:o.a.bool,reactModalProps:o.a.shape({}),nextLabel:o.a.string,prevLabel:o.a.string,zoomInLabel:o.a.string,zoomOutLabel:o.a.string,closeLabel:o.a.string,imageLoadErrorMessage:o.a.node},I.defaultProps={imageTitle:null,imageCaption:null,toolbarButtons:null,reactModalProps:{},animationDisabled:!1,animationDuration:300,animationOnKeyInput:!1,clickOutsideToClose:!0,closeLabel:"Close lightbox",discourageDownloads:!1,enableZoom:!0,imagePadding:10,imageCrossOrigin:null,keyRepeatKeyupBonus:40,keyRepeatLimit:180,mainSrcThumbnail:null,nextLabel:"Next image",nextSrc:null,nextSrcThumbnail:null,onAfterOpen:function(){},onImageLoadError:function(){},onImageLoad:function(){},onMoveNextRequest:function(){},onMovePrevRequest:function(){},prevLabel:"Previous image",prevSrc:null,prevSrcThumbnail:null,reactModalStyle:{},wrapperClassName:"",zoomInLabel:"Zoom in",zoomOutLabel:"Zoom out",imageLoadErrorMessage:"This image failed to load"},t.a=I}).call(this,a(65))},318:function(e,t,a){"use strict";var i=a(6),n=a(7),s=a(9),o=a(8),r=a(2),l=a.n(r),c=a(4),d=a(1),h=a(0),u=function(e){Object(s.a)(a,e);var t=Object(o.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(n.a)(a,[{key:"render",value:function(){var e=this.props,t=e.type,a=e.asyncOperationProgress,i=e.asyncOperatedFilesLength,n="move"===t?Object(d.nb)("Move {num} items"):Object(d.nb)("Copy {num} items");n=n.replace("{num}",i);var s={width:a+"%",lineHeight:"40px",textAlign:"left"};return Object(h.jsxs)(c.u,{isOpen:!0,children:[Object(h.jsx)(c.x,{toggle:this.props.toggleDialog,children:n}),Object(h.jsx)(c.v,{style:{minHeight:"80px"},children:Object(h.jsx)("div",{className:"progress",style:{height:"40px"},children:Object(h.jsx)("div",{className:"progress-bar pl-2",role:"progressbar",style:s,"aria-valuenow":a,"aria-valuemin":"0","aria-valuemax":"100",children:a+"%"})})})]})}}]),a}(l.a.Component);t.a=u},481:function(e,t,a){},482:function(e,t,a){},483:function(e,t,a){}},[[1591,1,0]]]);
//# sourceMappingURL=sharedDirView.chunk.js.map