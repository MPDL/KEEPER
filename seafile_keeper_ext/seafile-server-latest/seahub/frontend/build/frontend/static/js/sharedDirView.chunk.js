(this["webpackJsonpseahub-frontend"]=this["webpackJsonpseahub-frontend"]||[]).push([[21],{144:function(e,t,n){"use strict";var i,a=n(6),r=n(7),o=n(9),s=n(8),l=n(2),c=n.n(l),d=n(4),h=n(1),u=n(10),p=n(5),m=n(14),f=n(0),b=function(e){Object(o.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).queryZipProgress=function(){var e=r.state.zipToken;u.b.queryZipProgress(e).then((function(t){var n=t.data;1==n.failed?(clearInterval(i),r.setState({isLoading:!1,errorMsg:n.failed_reason})):(r.setState({zipProgress:0==n.total?"100%":(n.zipped/n.total*100).toFixed(2)+"%"}),n.total==n.zipped&&(clearInterval(i),r.props.toggleDialog(),location.href="".concat(h.lb,"zip/").concat(e)))})).catch((function(e){clearInterval(i);var t=p.a.getErrorMsg(e);r.setState({isLoading:!1,errorMsg:t})}))},r.cancelZipTask=function(){var e=r.state.zipToken;u.b.cancelZipTask(e).then((function(e){})).catch((function(e){}))},r.toggleDialog=function(){var e=r.state.zipProgress;e&&"100%"!=e&&(clearInterval(i),r.cancelZipTask()),r.props.toggleDialog()},r.state={isLoading:!0,errorMsg:"",zipProgress:null},r}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.token,a=t.path,r=t.repoID,o=t.target;(n?o.length?u.b.getShareLinkDirentsZipTask(n,a,o):u.b.getShareLinkZipTask(n,a):u.b.zipDownload(r,a,o)).then((function(t){var n=t.data.zip_token;e.setState({isLoading:!1,errorMsg:"",zipToken:n}),e.queryZipProgress(),i=setInterval(e.queryZipProgress,1e3)})).catch((function(t){var n=p.a.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:n})}))}},{key:"render",value:function(){return Object(f.jsxs)(d.u,{isOpen:!0,toggle:this.toggleDialog,children:[Object(f.jsx)(d.x,{toggle:this.toggleDialog,children:Object(h.nb)("Download")}),Object(f.jsx)(d.v,{children:Object(f.jsx)(g,{data:this.state})})]})}}]),n}(c.a.Component),g=function(e){Object(o.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,n=e.errorMsg,i=e.zipProgress;return t?Object(f.jsx)(m.a,{}):n?Object(f.jsx)("p",{className:"error mt-4 text-center",children:n}):Object(f.jsx)("p",{className:"mt-4 text-center",children:"".concat(Object(h.nb)("Packaging...")," ").concat(i)})}}]),n}(c.a.Component);t.a=b},1688:function(e,t,n){n(48),e.exports=n(1785)},1689:function(e,t,n){},173:function(e,t,n){"use strict";var i=n(6),a=n(7),r=n(9),o=n(8),s=n(2),l=n.n(s),c=n(1),d=n(349),h=(n(528),n(0)),u=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,e)}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props.imageItems,t=this.props.imageIndex,n=e.length,i=n&&Object(h.jsxs)(s.Fragment,{children:[Object(h.jsx)("span",{children:Object(c.nb)("%curr% of %total%").replace("%curr%",t+1).replace("%total%",n)}),Object(h.jsx)("br",{}),Object(h.jsx)("a",{href:e[t].url,target:"_blank",children:Object(c.nb)("Open in New Tab")})]});return Object(h.jsx)(d.a,{mainSrc:e[t].src,imageTitle:e[t].name,imageCaption:i,nextSrc:e[(t+1)%n].src,prevSrc:e[(t+n-1)%n].src,onCloseRequest:this.props.closeImagePopup,onMovePrevRequest:this.props.moveToPrevImage,onMoveNextRequest:this.props.moveToNextImage,imagePadding:70,imageLoadErrorMessage:Object(c.nb)("The image could not be loaded."),prevLabel:Object(c.nb)("Previous (Left arrow key)"),nextLabel:Object(c.nb)("Next (Right arrow key)"),closeLabel:Object(c.nb)("Close (Esc)"),zoomInLabel:Object(c.nb)("Zoom in"),zoomOutLabel:Object(c.nb)("Zoom out")})}}]),n}(l.a.Component);t.a=u},1785:function(e,t,n){"use strict";n.r(t);var i=n(175),a=n(6),r=n(7),o=n(22),s=n(9),l=n(8),c=n(2),d=n.n(c),h=n(132),u=n.n(h),p=n(20),m=n.n(p),f=n(4),b=n(12),g=n.n(b),v=n(62),j=n(1),O=n(5),y=n(10),x=n(14),S=n(11),w=n(18),k=n(144),C=n(173),I=n(47),D=n(276),M=n.n(D),_=n(0),F="uploading",L="error",P="isSaving",N="uploaded",T=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).onUploadCancel=function(e){e.preventDefault(),i.props.onUploadCancel(i.props.resumableFile)},i.onUploadRetry=function(e){e.preventDefault(),i.props.onUploadRetry(i.props.resumableFile)},i.formatFileSize=function(e){return"number"!==typeof e?"":e>=1e9?(e/1e9).toFixed(1)+" G":e>=1e6?(e/1e6).toFixed(1)+" M":e>=1e3?(e/1e3).toFixed(1)+" K":e.toFixed(1)+" B"},i.state={uploadState:F},i}return Object(r.a)(n,[{key:"componentWillReceiveProps",value:function(e){var t=e.resumableFile,n=F;t.error?n=L:(0!==t.remainingTime||t.isSaved||(n=P),t.isSaved&&(n=N)),this.setState({uploadState:n})}},{key:"render",value:function(){var e=this.props.resumableFile,t=Math.round(100*e.progress()),n=e.error,i=e.newFileName,a=this.formatFileSize(e.size);return Object(_.jsxs)("tr",{className:"file-upload-item",children:[Object(_.jsx)("td",{className:"upload-name",children:Object(_.jsx)("div",{className:"ellipsis",title:i,children:i})}),Object(_.jsx)("td",{className:"ellipsis",children:Object(_.jsx)("span",{className:"file-size",title:a,children:a})}),Object(_.jsxs)("td",{className:"upload-progress ellipsis",children:[(this.state.uploadState===F||this.state.uploadState===P)&&Object(_.jsxs)(c.Fragment,{children:[e.size>=1e8&&Object(_.jsxs)(c.Fragment,{children:[e.isUploading()&&Object(_.jsxs)("div",{className:"progress-container",children:[Object(_.jsx)("div",{className:"progress",children:Object(_.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})}),-1===e.remainingTime&&Object(_.jsx)("div",{className:"progress-text",children:Object(j.nb)("Preparing to upload...")}),e.remainingTime>0&&Object(_.jsxs)("div",{className:"progress-text",children:[Object(j.nb)("Remaining")," ",O.a.formatTime(e.remainingTime)]}),0===e.remainingTime&&Object(_.jsx)("div",{className:"progress-text",children:Object(j.nb)("Indexing...")})]}),!e.isUploading()&&Object(_.jsx)("div",{className:"progress-container d-flex align-items-center",children:Object(_.jsx)("div",{className:"progress",children:Object(_.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})})]}),e.size<1e8&&Object(_.jsx)("div",{className:"progress-container d-flex align-items-center",children:Object(_.jsx)("div",{className:"progress",children:Object(_.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})})]}),this.state.uploadState===L&&Object(_.jsx)("div",{className:"message err-message ml-0",dangerouslySetInnerHTML:{__html:n}})]}),Object(_.jsx)("td",{className:"upload-operation ellipsis",children:Object(_.jsxs)(c.Fragment,{children:[this.state.uploadState===F&&Object(_.jsx)("a",{href:"#",onClick:this.onUploadCancel,children:Object(j.nb)("Cancel")}),this.state.uploadState===L&&Object(_.jsx)("a",{href:"#",onClick:this.onUploadRetry,children:Object(j.nb)("Retry")}),this.state.uploadState===P&&Object(_.jsx)("span",{className:"saving",children:Object(j.nb)("Saving...")}),this.state.uploadState===N&&Object(_.jsx)("span",{className:"uploaded",children:Object(j.nb)("Uploaded")})]})})]})}}]),n}(d.a.Component),E=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props.file,t=Object(j.nb)("Please upload files less than {placeholder}M").replace("{placeholder}",j.Kb);return Object(_.jsxs)("tr",{className:"file-upload-item",children:[Object(_.jsx)("td",{className:"upload-name",children:Object(_.jsx)("div",{className:"ellipsis",title:e.name,children:e.name})}),Object(_.jsx)("td",{colSpan:3,className:"error",children:t})]})}}]),n}(d.a.Component),U=E,z=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).onCancelAllUploading=function(){i.props.onCancelAllUploading()},i.onMinimizeUpload=function(e){e.nativeEvent.stopImmediatePropagation(),i.setState({isMinimized:!i.state.isMinimized})},i.onCloseUpload=function(e){e.nativeEvent.stopImmediatePropagation(),i.props.onCloseUploadDialog()},i.state={isMinimized:!1},i}return Object(r.a)(n,[{key:"render",value:function(){var e=this,t=O.a.formatBitRate(this.props.uploadBitrate),n=Object(j.nb)("File Upload"),i=Object(j.nb)("File Uploading...")+" "+this.props.totalProgress+"% ("+t+")",a=Object(_.jsx)("span",{className:"sf2-icon-minus",onClick:this.onMinimizeUpload}),r=Object(_.jsxs)(c.Fragment,{children:[Object(_.jsx)("span",{className:"sf2-icon-minus",onClick:this.onMinimizeUpload}),Object(_.jsx)("span",{className:"sf2-icon-x1",onClick:this.onCloseUpload})]}),o=this.props,s=o.totalProgress,l=o.allFilesUploaded,d=o.retryFileList;return Object(_.jsxs)("div",{className:"uploader-list-view mw-100",style:{height:this.state.isMinimized?"2.25rem":"20rem"},children:[Object(_.jsxs)("div",{className:"uploader-list-header",children:[Object(_.jsx)("div",{className:"title",children:100===s?n:i}),Object(_.jsx)("div",{className:"uploader-options",children:100===s||l?r:a})]}),Object(_.jsxs)("div",{className:"uploader-list-content",children:[Object(_.jsxs)("div",{className:"text-right mt-2",children:[d.length>0?Object(_.jsx)("span",{className:"cursor-pointer",onClick:this.props.onUploadRetryAll,children:Object(j.nb)("Retry All")}):Object(_.jsx)("span",{className:"cursor-pointer disabled-link",children:Object(j.nb)("Retry All")}),l?Object(_.jsx)("span",{className:"cursor-pointer ml-3 disabled-link",children:Object(j.nb)("Cancel All")}):Object(_.jsx)("span",{className:"cursor-pointer ml-3",onClick:this.onCancelAllUploading,children:Object(j.nb)("Cancel All")})]}),Object(_.jsxs)("table",{className:"table-thead-hidden",children:[Object(_.jsx)("thead",{children:Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{width:"30%",children:Object(j.nb)("name")}),Object(_.jsx)("th",{width:"20%",children:Object(j.nb)("size")}),Object(_.jsx)("th",{width:"30%",children:Object(j.nb)("progress")}),Object(_.jsx)("th",{width:"20%",children:Object(j.nb)("state")})]})}),Object(_.jsxs)("tbody",{children:[this.props.forbidUploadFileList.map((function(e,t){return Object(_.jsx)(U,{file:e},t)})),this.props.uploadFileList.map((function(t,n){return Object(_.jsx)(T,{resumableFile:t,onUploadCancel:e.props.onUploadCancel,onUploadRetry:e.props.onUploadRetry},n)}))]})]})]})]})}}]),n}(d.a.Component),R=(n(530),function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).componentWillUnmount=function(){window.onbeforeunload=null,!0===i.props.dragAndDrop&&i.resumable.disableDropOnDocument()},i.onbeforeunload=function(){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress)return""},i.bindCallbackHandler=function(){var e=i.props,t=e.minFileSizeErrorCallback,n=e.fileTypeErrorCallback;i.maxFilesErrorCallback&&(i.resumable.opts.maxFilesErrorCallback=i.maxFilesErrorCallback),t&&(i.resumable.opts.minFileSizeErrorCallback=i.props.minFileSizeErrorCallback),i.maxFileSizeErrorCallback&&(i.resumable.opts.maxFileSizeErrorCallback=i.maxFileSizeErrorCallback),n&&(i.resumable.opts.fileTypeErrorCallback=i.props.fileTypeErrorCallback)},i.bindEventHandler=function(){i.resumable.on("chunkingComplete",i.onChunkingComplete.bind(Object(o.a)(i))),i.resumable.on("fileAdded",i.onFileAdded.bind(Object(o.a)(i))),i.resumable.on("filesAddedComplete",i.filesAddedComplete.bind(Object(o.a)(i))),i.resumable.on("fileProgress",i.onFileProgress.bind(Object(o.a)(i))),i.resumable.on("fileSuccess",i.onFileUploadSuccess.bind(Object(o.a)(i))),i.resumable.on("progress",i.onProgress.bind(Object(o.a)(i))),i.resumable.on("complete",i.onComplete.bind(Object(o.a)(i))),i.resumable.on("pause",i.onPause.bind(Object(o.a)(i))),i.resumable.on("fileRetry",i.onFileRetry.bind(Object(o.a)(i))),i.resumable.on("fileError",i.onFileError.bind(Object(o.a)(i))),i.resumable.on("error",i.onError.bind(Object(o.a)(i))),i.resumable.on("beforeCancel",i.onBeforeCancel.bind(Object(o.a)(i))),i.resumable.on("cancel",i.onCancel.bind(Object(o.a)(i))),i.resumable.on("dragstart",i.onDragStart.bind(Object(o.a)(i)))},i.maxFilesErrorCallback=function(e,t){var n=j.Jb,i=Object(j.nb)("Please upload no more than {maxFiles} files at a time.");i=i.replace("{maxFiles}",n),S.a.danger(i)},i.maxFileSizeErrorCallback=function(e){var t=i.state.forbidUploadFileList;t.push(e),i.setState({forbidUploadFileList:t})},i.onChunkingComplete=function(e){!0===i.state.allFilesUploaded&&i.setState({allFilesUploaded:!1});var t="/"===i.props.path?"/":i.props.path+"/",n=e.fileName,a=e.relativePath,r=n===a;if(e.formData={},r)e.formData={parent_dir:t};else{var o=a.slice(0,a.lastIndexOf("/")+1);e.formData={parent_dir:t,relative_path:o}}},i.onFileAdded=function(e,t){if(e.fileName===e.relativePath&&1===t.length){i.setUploadFileList(i.resumable.files);var n=i.props,a=n.token,r=n.relativePath;y.b.sharedLinkGetFileUploadUrl(a,r).then((function(t){i.resumable.opts.target=t.data.upload_link+"?ret-json=1",i.resumableUpload(e)})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)}))}else if(i.setUploadFileList(i.resumable.files),!i.isUploadLinkLoaded){i.isUploadLinkLoaded=!0;var o=i.props,s=o.token,l=o.relativePath;y.b.sharedLinkGetFileUploadUrl(s,l).then((function(e){i.resumable.opts.target=e.data.upload_link+"?ret-json=1",i.resumable.upload()})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)}))}},i.resumableUpload=function(e){var t=i.props,n=t.repoID,a=t.path;y.b.getFileUploadedBytes(n,a,e.fileName).then((function(t){var n=t.data.uploadedBytes,a=1024*parseInt(j.Zb)*1024||1048576,r=Math.floor(n/a);e.markChunksCompleted(r),i.resumable.upload()})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)}))},i.filesAddedComplete=function(e,t){i.state.forbidUploadFileList.length>0&&0===t.length&&i.setState({isUploadProgressDialogShow:!0,totalProgress:100})},i.setUploadFileList=function(){var e=i.resumable.files;i.setState({uploadFileList:e,isUploadProgressDialogShow:!0}),O.a.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)},i.onFileProgress=function(e){var t=i.getBitrate(),n=i.state.uploadFileList.map((function(n){if(n.uniqueIdentifier===e.uniqueIdentifier&&t){var i=8*(n.size-n.size*n.progress()),a=Math.floor(i/t);n.remainingTime=a}return n}));i.setState({uploadBitrate:t,uploadFileList:n})},i.getBitrate=function(){var e=0,t=0,n=(new Date).getTime();if(i.resumable.files.forEach((function(t){e+=t.progress()*t.size})),i.timestamp){var a=n-i.timestamp;if(a<i.bitrateInterval)return i.state.uploadBitrate;(e<i.loaded||0===i.loaded)&&(i.loaded=e),t=(e-i.loaded)*(1e3/a)*8}return i.timestamp=n,i.loaded=e,t},i.onProgress=function(){var e=Math.round(100*i.resumable.progress());i.setState({totalProgress:e}),O.a.registerGlobalVariable("uploader","totalProgress",e)},i.onFileUploadSuccess=function(e,t){var n=e.formData,a=(new Date).getTime()/1e3;t=n.replace?t:JSON.parse(t)[0],n.relative_path;var r={id:t.id,type:"file",name:t.name,size:t.size,mtime:a};i.props.onFileUploadSuccess(r);var o=i.state.uploadFileList.map((function(n){return n.uniqueIdentifier===e.uniqueIdentifier&&(n.newFileName=t.name,n.isSaved=!0),n}));i.setState({uploadFileList:o})},i.onFileError=function(e,t){var n="";if(t){var a=t.replace(/\n/g,"");a=JSON.parse(a),"File locked by others."===(n=a.error)&&(n=Object(j.nb)("File is locked by others.")),"Internal error."===n&&(n=Object(j.nb)("Internal Server Error"))}else n=Object(j.nb)("Network error");var r=i.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(i.state.retryFileList.push(t),t.error=n),t}));i.loaded=0,i.setState({retryFileList:i.state.retryFileList,uploadFileList:r})},i.onComplete=function(){i.notifiedFolders=[],i.isUploadLinkLoaded=!1,i.setState({allFilesUploaded:!0})},i.onPause=function(){},i.onError=function(e){i.isUploadLinkLoaded=!1,O.a.registerGlobalVariable("uploader","totalProgress",100)},i.onFileRetry=function(){},i.onBeforeCancel=function(){},i.onCancel=function(){},i.setHeaders=function(e,t){var n=t.offset,i=t.getOpt("chunkSize"),a=0===e.size?1:e.size,r=0!==n?n*i:0,o=Math.min(a,(n+1)*i)-1;return a-t.endByte<i&&!t.getOpt("forceChunkSize")&&(o=a),{Accept:"application/json; text/javascript, */*; q=0.01","Content-Disposition":'attachment; filename="'+encodeURI(e.fileName)+'"',"Content-Range":"bytes "+r+"-"+o+"/"+a}},i.setQuery=function(e){return e.formData},i.generateUniqueIdentifier=function(e){var t=e.webkitRelativePath||e.relativePath||e.fileName||e.name;return u()(t+new Date)+t},i.onClick=function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},i.onFileUpload=function(){i.uploadInput.current.removeAttribute("webkitdirectory"),i.uploadInput.current.click()},i.onFolderUpload=function(){i.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory"),i.uploadInput.current.click()},i.onDragStart=function(){i.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory")},i.onCloseUploadDialog=function(){i.loaded=0,i.resumable.files=[],i.isUploadLinkLoaded=!1,i.setState({isUploadProgressDialogShow:!1,uploadFileList:[],forbidUploadFileList:[]}),O.a.registerGlobalVariable("uploader","isUploadProgressDialogShow",!1)},i.onUploadCancel=function(e){var t=i.state.uploadFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier||(t.cancel(),!1)}));i.resumable.isUploading()||(i.setState({totalProgress:"100",allFilesUploaded:!0}),i.loaded=0),i.setState({uploadFileList:t})},i.onCancelAllUploading=function(){var e=i.state.uploadFileList.filter((function(e){return!Math.round(1!==e.progress())||(e.cancel(),!1)}));i.loaded=0,i.setState({allFilesUploaded:!0,totalProgress:"100",uploadFileList:e}),i.isUploadLinkLoaded=!1},i.onUploadRetry=function(e){var t=i.props,n=t.token,a=t.relativePath;y.b.sharedLinkGetFileUploadUrl(n,a).then((function(t){i.resumable.opts.target=t.data.upload_link+"?ret-json=1";var n=i.state.retryFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier})),a=i.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.error=null,i.retryUploadFile(t)),t}));i.setState({retryFileList:n,uploadFileList:a})})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)}))},i.onUploadRetryAll=function(){var e=i.props,t=e.token,n=e.relativePath;y.b.sharedLinkGetFileUploadUrl(t,n).then((function(e){i.resumable.opts.target=e.data.upload_link+"?ret-json=1",i.state.retryFileList.forEach((function(e){e.error=!1,i.retryUploadFile(e)}));var t=i.state.uploadFileList.slice(0);i.setState({retryFileList:[],uploadFileList:t})})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)}))},i.retryUploadFile=function(e){var t=i.props,n=t.repoID,a=t.path,r=e.fileName;if(!(e.fileName===e.relativePath)){var o=e.formData.relative_path;r=("/"===a?a+o:a+"/"+o)+r}e.bootstrap();var s=!1;e.resumableObj.on("chunkingComplete",(function(){s||y.b.getFileUploadedBytes(n,a,r).then((function(t){var n=t.data.uploadedBytes,i=1024*parseInt(j.Zb)*1024||1048576,a=Math.floor(n/i);e.markChunksCompleted(a),e.resumableObj.upload()})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)})),s=!0}))},i.uploadFile=function(){var e=i.resumable.files[i.resumable.files.length-1],t=i.props,n=t.token,a=t.relativePath;y.b.sharedLinkGetFileUploadUrl(n,a).then((function(t){i.resumable.opts.target=t.data.upload_link+"?ret-json=1",i.setState({isUploadRemindDialogShow:!1,isUploadProgressDialogShow:!0,uploadFileList:[].concat(Object(I.a)(i.state.uploadFileList),[e])},(function(){i.resumable.upload()})),O.a.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)}))},i.cancelFileUpload=function(){i.resumable.files.pop(),i.setState({isUploadRemindDialogShow:!1})},i.state={retryFileList:[],uploadFileList:[],forbidUploadFileList:[],totalProgress:0,isUploadProgressDialogShow:!1,isUploadRemindDialogShow:!1,currentResumableFile:null,uploadBitrate:0,allFilesUploaded:!1},i.uploadInput=d.a.createRef(),i.notifiedFolders=[],i.timestamp=null,i.loaded=0,i.bitrateInterval=500,window.onbeforeunload=i.onbeforeunload,i.isUploadLinkLoaded=!1,i}return Object(r.a)(n,[{key:"componentDidMount",value:function(){this.resumable=new M.a({target:"",query:this.setQuery||{},fileType:this.props.filetypes,maxFiles:j.Jb||void 0,maxFileSize:1e3*j.Kb*1e3||void 0,testMethod:this.props.testMethod||"post",testChunks:this.props.testChunks||!1,headers:this.setHeaders||{},withCredentials:this.props.withCredentials||!1,chunkSize:1024*parseInt(j.Zb)*1024||1048576,simultaneousUploads:this.props.simultaneousUploads||1,fileParameterName:this.props.fileParameterName,generateUniqueIdentifier:this.generateUniqueIdentifier,forceChunkSize:!0,maxChunkRetries:3,minFileSize:0}),this.resumable.assignBrowse(this.uploadInput.current,!0),!0===this.props.dragAndDrop&&this.resumable.enableDropOnDocument(),this.bindCallbackHandler(),this.bindEventHandler()}},{key:"render",value:function(){return Object(_.jsxs)(c.Fragment,{children:[Object(_.jsx)("div",{className:"file-uploader-container",children:Object(_.jsx)("div",{className:"file-uploader",children:Object(_.jsx)("input",{className:"upload-input",type:"file",ref:this.uploadInput,onClick:this.onClick})})}),this.state.isUploadProgressDialogShow&&Object(_.jsx)(z,{retryFileList:this.state.retryFileList,uploadFileList:this.state.uploadFileList,forbidUploadFileList:this.state.forbidUploadFileList,totalProgress:this.state.totalProgress,uploadBitrate:this.state.uploadBitrate,allFilesUploaded:this.state.allFilesUploaded,onCloseUploadDialog:this.onCloseUploadDialog,onCancelAllUploading:this.onCancelAllUploading,onUploadCancel:this.onUploadCancel,onUploadRetry:this.onUploadRetry,onUploadRetryAll:this.onUploadRetryAll})]})}}]),n}(d.a.Component)),A=R,B=n(113),q=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).onSaveSharedFile=function(){i.props.handleSaveSharedDir(i.state.repo.repo_id,i.state.selectedPath)},i.onDirentItemClick=function(e,t,n){"dir"===n.type?i.setState({repo:e,selectedPath:t}):i.setState({repo:null,selectedPath:""})},i.onRepoItemClick=function(e){i.setState({repo:e,selectedPath:"/"})},i.state={repo:null,selectedPath:"",errMessage:""},i}return Object(r.a)(n,[{key:"render",value:function(){return Object(_.jsxs)(f.u,{isOpen:!0,className:"sf-save-file",children:[Object(_.jsx)(f.x,{toggle:this.props.toggleCancel,children:Object(j.nb)("Save to:")}),Object(_.jsxs)(f.v,{children:[Object(_.jsx)(B.a,{isShowFile:!1,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:"only_all_repos"}),this.state.errMessage&&Object(_.jsx)(f.a,{color:"danger",children:this.state.errMessage})]}),Object(_.jsxs)(f.w,{children:[Object(_.jsx)(f.c,{color:"secondary",onClick:this.props.toggleCancel,children:Object(j.nb)("Cancel")}),this.state.selectedPath?Object(_.jsx)(f.c,{color:"primary",onClick:this.onSaveSharedFile,children:Object(j.nb)("Submit")}):Object(_.jsx)(f.c,{color:"primary",disabled:!0,children:Object(j.nb)("Submit")})]})]})}}]),n}(d.a.Component),Y=n(350),Z=n(233),X=n(156);n(1689),n(529);function W(){W=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(D){l=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof u?t:u,o=Object.create(r.prototype),s=new k(a||[]);return i(o,"_invoke",{value:y(e,n,s)}),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(D){return{type:"throw",arg:D}}}e.wrap=c;var h={};function u(){}function p(){}function m(){}var f={};l(f,r,(function(){return this}));var b=Object.getPrototypeOf,g=b&&b(b(C([])));g&&g!==t&&n.call(g,r)&&(f=g);var v=m.prototype=u.prototype=Object.create(f);function j(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function a(i,r,o,s){var l=d(e[i],e,r);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){a("next",e,o,s)}),(function(e){a("throw",e,o,s)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return a("throw",e,o,s)}))}s(l.arg)}var r;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){a(e,n,t,i)}))}return r=r?r.then(i,i):i()}})}function y(e,t,n){var i="suspendedStart";return function(a,r){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw r;return I()}for(n.method=a,n.arg=r;;){var o=n.delegate;if(o){var s=x(o,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=d(e,t,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}function x(e,t){var n=t.method,i=e.iterator[n];if(void 0===i)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var a=d(i,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,h;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function C(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function t(){for(;++i<e.length;)if(n.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:I}}function I(){return{value:void 0,done:!0}}return p.prototype=m,i(v,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:p,configurable:!0}),p.displayName=l(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},j(O.prototype),l(O.prototype,o,(function(){return this})),e.AsyncIterator=O,e.async=function(t,n,i,a,r){void 0===r&&(r=Promise);var o=new O(c(t,n,i,a),r);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},j(v),l(v,s,"Generator"),l(v,r,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=C,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(n,i){return o.type="throw",o.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],o=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var s=n.call(r,"catchLoc"),l=n.call(r,"finallyLoc");if(s&&l){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=t,r?(this.method="next",this.next=r.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var a=i.arg;w(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}g.a.locale(window.app.config.lang);var H=window.app.pageOptions.name,G=window.shared.pageOptions,K=G.token,J=G.dirName,V=G.dirPath,Q=G.sharedBy,$=G.repoID,ee=G.relativePath,te=G.mode,ne=G.thumbnailSize,ie=G.zipped,ae=G.trafficOverLimit,re=G.canDownload,oe=G.noQuota,se=G.canUpload,le=G.enableVideoThumbnail,ce=!ae&&re,de=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).sortItems=function(e,t){i.setState({sortBy:e,sortOrder:t,items:O.a.sortDirentsInSharedDir(i.state.items,e,t)})},i.getThumbnails=function(){var e=i.state.items.filter((function(e){return!e.is_dir&&(O.a.imageCheck(e.file_name)||le&&O.a.videoCheck(e.file_name))&&!e.encoded_thumbnail_src}));if(0!=e.length){var t=e.length,n=Object(o.a)(i);!function i(a){var r=e[a];y.b.getShareLinkThumbnail(K,r.file_path,ne).then((function(e){r.encoded_thumbnail_src=e.data.encoded_thumbnail_src})).catch((function(e){})).then((function(){a<t-1?i(++a):n.setState({items:n.state.items})}))}(0)}},i.renderPath=function(){return Object(_.jsxs)(d.a.Fragment,{children:[ie.map((function(e,t){if(t!=ie.length-1)return Object(_.jsxs)(d.a.Fragment,{children:[Object(_.jsx)("a",{href:"?p=".concat(encodeURIComponent(e.path),"&mode=").concat(te),className:"mx-1 ellipsis",title:e.name,children:e.name}),Object(_.jsx)("span",{children:" / "})]},t)})),Object(_.jsx)("span",{className:"ml-1 ellipsis",title:ie[ie.length-1].name,children:ie[ie.length-1].name})]})},i.zipDownloadFolder=function(e){j.wc?y.b.getShareLinkZipTask(K,e).then((function(e){var t=e.data.zip_token;location.href="".concat(j.lb,"zip/").concat(t)})).catch((function(e){var t=O.a.getErrorMsg(e);i.setState({isLoading:!1,errorMsg:t})})):i.setState({isZipDialogOpen:!0,zipFolderPath:e})},i.zipDownloadSelectedItems=function(){if(j.wc){var e=i.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}));y.b.getShareLinkDirentsZipTask(K,ee,e).then((function(e){var t=e.data.zip_token;location.href="".concat(j.lb,"zip/").concat(t)})).catch((function(e){var t=O.a.getErrorMsg(e);i.setState({isLoading:!1,errorMsg:t})}))}else i.setState({isZipDialogOpen:!0,zipFolderPath:ee,selectedItems:i.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}))})},i.saveSelectedItems=function(){i.setState({isSaveSharedDirDialogShow:!0,itemsForSave:i.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}))})},i.saveAllItems=function(){i.setState({isSaveSharedDirDialogShow:!0,itemsForSave:i.state.items.map((function(e){return e.file_name||e.folder_name}))})},i.toggleSaveSharedDirCancel=function(){i.setState({isSaveSharedDirDialogShow:!1,itemsForSave:[]})},i.handleSaveSharedDir=function(e,t){var n=i.state.itemsForSave;y.b.saveSharedDir(e,t,K,ee,n).then((function(e){i.setState({isSaveSharedDirDialogShow:!1,itemsForSave:[],isCopyMoveProgressDialogShow:!0,asyncCopyMoveTaskId:e.data.task_id,asyncOperatedFilesLength:n.length},(function(){i.getAsyncCopyMoveProgress()}))})).catch((function(e){var t=O.a.getErrorMsg(e);i.setState({errMessage:t})}))},i.onProgressDialogToggle=function(){if(100!==i.state.asyncOperationProgress){var e=i.state.asyncCopyMoveTaskId;y.b.cancelCopyMoveOperation(e)}i.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1})},i.closeZipDialog=function(){i.setState({isZipDialogOpen:!1,zipFolderPath:"",selectedItems:[]})},i.prepareImageItem=function(e){var t=e.file_name,n="gif"==t.substr(t.lastIndexOf(".")+1).toLowerCase(),i="".concat(j.mc,"d/").concat(K,"/files/?p=").concat(encodeURIComponent(e.file_path));return{name:t,url:i,src:n?"".concat(i,"&raw=1"):"".concat(j.mc,"thumbnail/").concat(K,"/").concat(j.rc).concat(O.a.encodePath(e.file_path))}},i.showImagePopup=function(e){var t=i.state.items.filter((function(e){return!e.is_dir&&O.a.imageCheck(e.file_name)})),n=t.map((function(e){return i.prepareImageItem(e)}));i.setState({isImagePopupOpen:!0,imageItems:n,imageIndex:t.indexOf(e)})},i.closeImagePopup=function(){i.setState({isImagePopupOpen:!1})},i.moveToPrevImage=function(){var e=i.state.imageItems.length;i.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},i.moveToNextImage=function(){var e=i.state.imageItems.length;i.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},i.toggleAllSelected=function(){i.setState((function(e){return{isAllItemsSelected:!e.isAllItemsSelected,items:i.state.items.map((function(t){return t.isSelected=!e.isAllItemsSelected,t}))}}))},i.toggleItemSelected=function(e,t){i.setState({items:i.state.items.map((function(n){return n===e&&(n.isSelected=t),n}))},(function(){i.setState({isAllItemsSelected:!i.state.items.some((function(e){return!e.isSelected}))})}))},i.onUploadFile=function(e){e.nativeEvent.stopImmediatePropagation(),i.uploader.onFileUpload()},i.onFileUploadSuccess=function(e){var t=e.name,n=e.size,a={isSelected:!1,file_name:t,file_path:O.a.joinPath(ee,t),is_dir:!1,last_modified:g()().format(),size:n},r=i.state.items.filter((function(e){return e.is_dir})),o=Array.from(i.state.items);o.splice(r.length,0,a),i.setState({items:o}),y.b.shareLinksUploadDone(K,O.a.joinPath(V,t))},i.getShareLinkRepoTags=function(){y.b.getShareLinkRepoTags(K).then((function(e){var t=[];e.data.repo_tags.forEach((function(e){var n=new X.a(e);n.fileCount>0&&t.push(n)})),i.setState({usedRepoTags:t}),0!=t.length&&"/"==ee&&i.setState({isRepoInfoBarShow:!0})})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)}))},i.state={isLoading:!0,errorMsg:"",items:[],isAllItemsSelected:!1,selectedItems:[],sortBy:"name",sortOrder:"asc",isZipDialogOpen:!1,zipFolderPath:"",usedRepoTags:[],isRepoInfoBarShow:!1,isSaveSharedDirDialogShow:!1,itemsForSave:[],asyncCopyMoveTaskId:"",asyncOperationProgress:0,asyncOperatedFilesLength:0,isCopyMoveProgressDialogShow:!1,isImagePopupOpen:!1,imageItems:[],imageIndex:0},i}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;ae&&S.a.danger(Object(j.nb)("File download is disabled: the share link traffic of owner is used up."),{duration:3}),y.b.listSharedDir(K,ee,ne).then((function(t){var n=t.data.dirent_list.map((function(e){return e.isSelected=!1,e}));e.setState({isLoading:!1,errorMsg:"",items:O.a.sortDirentsInSharedDir(n,e.state.sortBy,e.state.sortOrder)}),e.getThumbnails()})).catch((function(t){var n=O.a.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:n})})),this.getShareLinkRepoTags()}},{key:"getAsyncCopyMoveProgress",value:function(){var e=Object(i.a)(W().mark((function e(){var t,n,i,a,r,o;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.asyncCopyMoveTaskId,e.prev=1,e.next=4,y.b.queryAsyncOperationProgress(t);case 4:if(n=e.sent,!(i=n.data).failed){e.next=11;break}return a=Object(j.nb)("Failed to copy files to another library."),S.a.danger(a),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),e.abrupt("return");case 11:if(!i.successful){e.next=16;break}return this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),r=Object(j.nb)("Successfully copied files to another library."),S.a.success(r),e.abrupt("return");case 16:o=i.total?parseInt((i.done/i.total*100).toFixed(2)):0,this.getAsyncCopyMoveProgress(),this.setState({asyncOperationProgress:o}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(1),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1});case 24:case"end":return e.stop()}}),e,this,[[1,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=O.a.isDesktop(),n="btn btn-secondary btn-icon sf-view-mode-btn";return Object(_.jsxs)(d.a.Fragment,{children:[Object(_.jsxs)("div",{className:"h-100 d-flex flex-column",children:[Object(_.jsxs)("div",{className:"top-header d-flex justify-content-between",children:[Object(_.jsx)("a",{href:j.mc,children:Object(_.jsx)("img",{src:j.Lb+j.Gb,height:j.Fb,width:j.Hb,title:j.nc,alt:"logo"})}),H&&Object(_.jsx)(v.a,{})]}),Object(_.jsx)("div",{className:"o-auto",children:Object(_.jsxs)("div",{className:"shared-dir-view-main",children:[Object(_.jsx)("h2",{className:"h3",children:J}),Object(_.jsxs)("p",{children:[Object(j.nb)("Shared by: "),Q]}),Object(_.jsxs)("div",{className:"d-flex justify-content-between align-items-center op-bar",children:[Object(_.jsxs)("p",{className:"m-0 mr-4 ellipsis d-flex align-items-center",children:[Object(_.jsx)("span",{className:"flex-none",children:Object(j.nb)("Current path: ")}),this.renderPath()]}),Object(_.jsxs)("div",{className:"flex-none",children:[t&&Object(_.jsxs)("div",{className:"view-mode btn-group",children:[Object(_.jsx)("a",{href:"?p=".concat(encodeURIComponent(ee),"&mode=list"),className:"".concat(n," sf2-icon-list-view ").concat("list"==te?"current-mode":""),title:Object(j.nb)("List"),"aria-label":Object(j.nb)("List")}),Object(_.jsx)("a",{href:"?p=".concat(encodeURIComponent(ee),"&mode=grid"),className:"".concat(n," sf2-icon-grid-view ").concat("grid"==te?"current-mode":""),title:Object(j.nb)("Grid"),"aria-label":Object(j.nb)("Grid")})]}),se&&Object(_.jsx)(f.c,{disabled:oe,title:oe?Object(j.nb)("The owner of this library has run out of space."):"",onClick:this.onUploadFile,className:"ml-2 shared-dir-op-btn shared-dir-upload-btn",children:Object(j.nb)("Upload")}),ce&&Object(_.jsx)(c.Fragment,{children:this.state.items.some((function(e){return e.isSelected}))?Object(_.jsxs)(c.Fragment,{children:[Object(_.jsx)(f.c,{color:"success",onClick:this.zipDownloadSelectedItems,className:"ml-2 shared-dir-op-btn",children:Object(j.nb)("ZIP Selected Items")}),re&&H&&H!==Q&&Object(_.jsx)(f.c,{color:"success",onClick:this.saveSelectedItems,className:"ml-2 shared-dir-op-btn",children:Object(j.nb)("Save Selected Items")})]}):Object(_.jsxs)(c.Fragment,{children:[Object(_.jsx)(f.c,{color:"success",onClick:this.zipDownloadFolder.bind(this,ee),className:"ml-2 shared-dir-op-btn",children:Object(j.nb)("ZIP")}),re&&H&&H!==Q&&Object(_.jsx)(f.c,{color:"success",onClick:this.saveAllItems,className:"ml-2 shared-dir-op-btn",children:Object(j.nb)("Save")})]})})]})]}),!oe&&se&&Object(_.jsx)(A,{ref:function(t){return e.uploader=t},dragAndDrop:!1,token:K,path:"/"===V?V:V.replace(/\/+$/,""),relativePath:"/"===ee?ee:ee.replace(/\/+$/,""),repoID:$,onFileUploadSuccess:this.onFileUploadSuccess}),this.state.isRepoInfoBarShow&&Object(_.jsx)(Z.a,{repoID:$,currentPath:"/",usedRepoTags:this.state.usedRepoTags,shareLinkToken:K,enableFileDownload:ce,className:"mx-0"}),Object(_.jsx)(he,{isDesktop:t,isLoading:this.state.isLoading,errorMsg:this.state.errorMsg,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,isAllItemsSelected:this.state.isAllItemsSelected,toggleAllSelected:this.toggleAllSelected,toggleItemSelected:this.toggleItemSelected,zipDownloadFolder:this.zipDownloadFolder,showImagePopup:this.showImagePopup})]})})]}),this.state.isZipDialogOpen&&Object(_.jsx)(w.a,{children:Object(_.jsx)(k.a,{token:K,path:this.state.zipFolderPath,target:this.state.selectedItems,toggleDialog:this.closeZipDialog})}),this.state.isSaveSharedDirDialogShow&&Object(_.jsx)(q,{sharedToken:K,parentDir:ee,items:this.state.itemsForSave,toggleCancel:this.toggleSaveSharedDirCancel,handleSaveSharedDir:this.handleSaveSharedDir}),this.state.isCopyMoveProgressDialogShow&&Object(_.jsx)(Y.a,{type:"copy",asyncOperatedFilesLength:this.state.asyncOperatedFilesLength,asyncOperationProgress:this.state.asyncOperationProgress,toggleDialog:this.onProgressDialogToggle}),this.state.isImagePopupOpen&&Object(_.jsx)(w.a,{children:Object(_.jsx)(C.a,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})})]})}}]),n}(d.a.Component),he=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).sortByName=function(e){e.preventDefault();var t="asc"==i.props.sortOrder?"desc":"asc";i.props.sortItems("name",t)},i.sortByTime=function(e){e.preventDefault();var t="asc"==i.props.sortOrder?"desc":"asc";i.props.sortItems("time",t)},i.sortBySize=function(e){e.preventDefault();var t="asc"==i.props.sortOrder?"desc":"asc";i.props.sortItems("size",t)},i}return Object(r.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.isDesktop,i=t.isLoading,a=t.errorMsg,r=t.items,o=t.sortBy,s=t.sortOrder,l=t.isAllItemsSelected;if(i)return Object(_.jsx)(x.a,{});if(a)return Object(_.jsx)("p",{className:"error mt-6 text-center",children:a});var c=Object(_.jsx)("tbody",{children:r.map((function(t,i){return Object(_.jsx)(ue,{isDesktop:n,item:t,zipDownloadFolder:e.props.zipDownloadFolder,showImagePopup:e.props.showImagePopup,toggleItemSelected:e.props.toggleItemSelected},i)}))});if(!n)return Object(_.jsxs)("table",{className:"table-hover table-thead-hidden",children:[Object(_.jsx)("thead",{children:Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{width:"12%"}),Object(_.jsx)("th",{width:"80%"}),Object(_.jsx)("th",{width:"8%"})]})}),c]});var d=Object(_.jsx)("span",{className:"fas ".concat("asc"==s?"fa-caret-up":"fa-caret-down")});return"list"==te?Object(_.jsxs)("table",{className:"table-hover",children:[Object(_.jsx)("thead",{children:Object(_.jsxs)("tr",{children:[ce&&Object(_.jsx)("th",{width:"3%",className:"text-center",children:Object(_.jsx)("input",{type:"checkbox",checked:l,onChange:this.props.toggleAllSelected})}),Object(_.jsx)("th",{width:"5%"}),Object(_.jsx)("th",{width:ce?"50%":"53%",children:Object(_.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[Object(j.nb)("Name")," ","name"==o&&d]})}),Object(_.jsx)("th",{width:"8%"}),Object(_.jsx)("th",{width:"14%",children:Object(_.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize,children:[Object(j.nb)("Size")," ","size"==o&&d]})}),Object(_.jsx)("th",{width:"13%",children:Object(_.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[Object(j.nb)("Last Update")," ","time"==o&&d]})}),Object(_.jsx)("th",{width:"7%"})]})}),c]}):Object(_.jsx)("ul",{className:"grid-view",children:r.map((function(t,n){return Object(_.jsx)(pe,{item:t,zipDownloadFolder:e.props.zipDownloadFolder,showImagePopup:e.props.showImagePopup},n)}))})}}]),n}(d.a.Component),ue=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).toggleOpMenu=function(){i.setState({isOpMenuOpen:!i.state.isOpMenuOpen})},i.handleMouseOver=function(){i.setState({isIconShown:!0})},i.handleMouseOut=function(){i.setState({isIconShown:!1})},i.zipDownloadFolder=function(e){e.preventDefault(),i.props.zipDownloadFolder.bind(Object(o.a)(i),i.props.item.folder_path)()},i.handleFileClick=function(e){var t=i.props.item;O.a.imageCheck(t.file_name)&&(e.preventDefault(),i.props.showImagePopup(t))},i.toggleItemSelected=function(e){i.props.toggleItemSelected(i.props.item,e.target.checked)},i.state={isIconShown:!1,isOpMenuOpen:!1},i}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.isDesktop,i=this.state.isIconShown,a="",r="";if(t.file_tags&&t.file_tags.length>0&&(a=u()(t.file_name).slice(0,7),r=t.file_tags.map((function(e){return e.tag_name})).join(" ")),t.is_dir)return n?Object(_.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[ce&&Object(_.jsx)("td",{className:"text-center",children:Object(_.jsx)("input",{type:"checkbox",checked:t.isSelected,onChange:this.toggleItemSelected})}),Object(_.jsx)("td",{className:"text-center",children:Object(_.jsx)("img",{src:O.a.getFolderIconUrl(),alt:"",width:"24"})}),Object(_.jsx)("td",{children:Object(_.jsx)("a",{href:"?p=".concat(encodeURIComponent(t.folder_path.substr(0,t.folder_path.length-1)),"&mode=").concat(te),children:t.folder_name})}),Object(_.jsx)("td",{}),Object(_.jsx)("td",{}),Object(_.jsx)("td",{title:g()(t.last_modified).format("llll"),children:g()(t.last_modified).fromNow()}),Object(_.jsx)("td",{children:ce&&Object(_.jsx)("a",{role:"button",className:"action-icon sf2-icon-download".concat(i?"":" invisible"),href:"#",onClick:this.zipDownloadFolder,title:Object(j.nb)("Download"),"aria-label":Object(j.nb)("Download")})})]}):Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{className:"text-center",children:Object(_.jsx)("img",{src:O.a.getFolderIconUrl(),alt:"",width:"24"})}),Object(_.jsxs)("td",{children:[Object(_.jsx)("a",{href:"?p=".concat(encodeURIComponent(t.folder_path.substr(0,t.folder_path.length-1)),"&mode=").concat(te),children:t.folder_name}),Object(_.jsx)("br",{}),Object(_.jsx)("span",{className:"item-meta-info",children:g()(t.last_modified).fromNow()})]}),Object(_.jsx)("td",{children:ce&&Object(_.jsxs)(f.i,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[Object(_.jsx)(f.l,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:Object(j.nb)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),Object(_.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[Object(_.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),Object(_.jsx)("div",{className:"mobile-operation-menu",children:Object(_.jsx)(f.j,{className:"mobile-menu-item",onClick:this.zipDownloadFolder,children:Object(j.nb)("Download")})})]})]})})]});var o="".concat(j.mc,"d/").concat(K,"/files/?p=").concat(encodeURIComponent(t.file_path)),s=t.encoded_thumbnail_src?"".concat(j.mc).concat(t.encoded_thumbnail_src):"";return n?Object(_.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[ce&&Object(_.jsx)("td",{className:"text-center",children:Object(_.jsx)("input",{type:"checkbox",checked:t.isSelected,onChange:this.toggleItemSelected})}),Object(_.jsx)("td",{className:"text-center",children:s?Object(_.jsx)("img",{className:"thumbnail",src:s,alt:""}):Object(_.jsx)("img",{src:O.a.getFileIconUrl(t.file_name),alt:"",width:"24"})}),Object(_.jsx)("td",{children:Object(_.jsx)("a",{href:o,onClick:this.handleFileClick,children:t.file_name})}),Object(_.jsx)("td",{className:"tag-list-title",children:t.file_tags&&t.file_tags.length>0&&Object(_.jsxs)(c.Fragment,{children:[Object(_.jsx)("div",{id:"tag-list-title-".concat(a),className:"dirent-item tag-list tag-list-stacked",children:t.file_tags.map((function(e,n){var i=t.file_tags.length;return Object(_.jsx)("span",{className:"file-tag",style:{zIndex:i-n,backgroundColor:e.tag_color}},e.file_tag_id)}))}),Object(_.jsx)(f.I,{target:"tag-list-title-".concat(a),placement:"bottom",children:r})]})}),Object(_.jsx)("td",{children:O.a.bytesToSize(t.size)}),Object(_.jsx)("td",{title:g()(t.last_modified).format("llll"),children:g()(t.last_modified).fromNow()}),Object(_.jsx)("td",{children:ce&&Object(_.jsx)("a",{className:"action-icon sf2-icon-download".concat(i?"":" invisible"),href:"".concat(o,"&dl=1"),title:Object(j.nb)("Download"),"aria-label":Object(j.nb)("Download")})})]}):Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{className:"text-center",children:s?Object(_.jsx)("img",{className:"thumbnail",src:s,alt:""}):Object(_.jsx)("img",{src:O.a.getFileIconUrl(t.file_name),alt:"",width:"24"})}),Object(_.jsxs)("td",{children:[Object(_.jsx)("a",{href:o,onClick:this.handleFileClick,children:t.file_name}),Object(_.jsx)("br",{}),Object(_.jsx)("span",{className:"item-meta-info",children:O.a.bytesToSize(t.size)}),Object(_.jsx)("span",{className:"item-meta-info",children:g()(t.last_modified).fromNow()})]}),Object(_.jsx)("td",{children:ce&&Object(_.jsxs)(f.i,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[Object(_.jsx)(f.l,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:Object(j.nb)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),Object(_.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[Object(_.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),Object(_.jsx)("div",{className:"mobile-operation-menu",children:Object(_.jsx)(f.j,{className:"mobile-menu-item",tag:"a",href:"".concat(o,"&dl=1"),children:Object(j.nb)("Download")})})]})]})})]})}}]),n}(d.a.Component),pe=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).handleMouseOver=function(){i.setState({isIconShown:!0})},i.handleMouseOut=function(){i.setState({isIconShown:!1})},i.zipDownloadFolder=function(e){e.preventDefault(),i.props.zipDownloadFolder.bind(Object(o.a)(i),i.props.item.folder_path)()},i.handleFileClick=function(e){var t=i.props.item;O.a.imageCheck(t.file_name)&&(e.preventDefault(),i.props.showImagePopup(t))},i.state={isIconShown:!1},i}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props.item,t=this.state.isIconShown;if(e.is_dir){var n="?p=".concat(encodeURIComponent(e.folder_path.substr(0,e.folder_path.length-1)),"&mode=").concat(te);return Object(_.jsxs)("li",{className:"grid-item",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[Object(_.jsx)("a",{href:n,className:"grid-file-img-link d-block",children:Object(_.jsx)("img",{src:O.a.getFolderIconUrl(!1,192),alt:"",width:"96",height:"96"})}),Object(_.jsx)("a",{href:n,className:"grid-file-name grid-file-name-link",children:e.folder_name}),ce&&Object(_.jsx)("a",{role:"button",className:"action-icon sf2-icon-download".concat(t?"":" invisible"),href:"#",onClick:this.zipDownloadFolder,title:Object(j.nb)("Download"),"aria-label":Object(j.nb)("Download")})]})}var i="".concat(j.mc,"d/").concat(K,"/files/?p=").concat(encodeURIComponent(e.file_path)),a=e.encoded_thumbnail_src?"".concat(j.mc).concat(e.encoded_thumbnail_src):"";return Object(_.jsxs)("li",{className:"grid-item",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[Object(_.jsx)("a",{href:i,className:"grid-file-img-link d-block",onClick:this.handleFileClick,children:a?Object(_.jsx)("img",{className:"thumbnail",src:a,alt:""}):Object(_.jsx)("img",{src:O.a.getFileIconUrl(e.file_name,192),alt:"",width:"96",height:"96"})}),Object(_.jsx)("a",{href:i,className:"grid-file-name grid-file-name-link",onClick:this.handleFileClick,children:e.file_name}),ce&&Object(_.jsx)("a",{className:"action-icon sf2-icon-download".concat(t?"":" invisible"),href:"".concat(i,"&dl=1"),title:Object(j.nb)("Download"),"aria-label":Object(j.nb)("Download")})]})}}]),n}(d.a.Component);m.a.render(Object(_.jsx)(de,{}),document.getElementById("wrapper"))},232:function(e,t,n){"use strict";var i=n(6),a=n(7),r=n(9),o=n(8),s=n(2),l=n.n(s),c=n(4),d=n(12),h=n.n(d),u=n(1),p=n(10),m=n(5),f=n(11),b=n(0),g=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).onFileTagChanged=function(e){var t=e.parent_path,n={name:e.filename},i="/"===t?t+e.filename:t+"/"+e.filename;a.props.onFileTagChanged(n,i)},a.onDeleteTaggedFile=function(e){var t=a.props.repoID,n=e.file_tag_id;p.b.deleteFileTag(t,n).then((function(t){a.getTaggedFiles(),a.props.updateUsedRepoTags(),a.props.onFileTagChanged&&!e.file_deleted&&a.onFileTagChanged(e)})).catch((function(e){var t=m.a.getErrorMsg(e);f.a.danger(t)}))},a.getTaggedFiles=function(){var e=a.props,t=e.repoID,n=e.currentTag,i=e.shareLinkToken;(i?p.b.getShareLinkTaggedFiles(i,n.id):p.b.listTaggedFiles(t,n.id)).then((function(e){var t=[];void 0!==e.data.tagged_files&&e.data.tagged_files.forEach((function(e){var n=e;t.push(n)})),a.setState({taggedFileList:t})})).catch((function(e){var t=m.a.getErrorMsg(e);f.a.danger(t)}))},a.state={taggedFileList:[]},a}return Object(a.a)(n,[{key:"componentDidMount",value:function(){this.getTaggedFiles()}},{key:"render",value:function(){var e=this,t=this.state.taggedFileList;return Object(b.jsxs)(c.u,{isOpen:!0,style:{maxWidth:"678px"},children:[Object(b.jsx)(c.x,{toggle:this.props.onClose,children:Object(u.nb)("Tagged Files")}),Object(b.jsx)(c.v,{className:"dialog-list-container",children:Object(b.jsxs)("table",{children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{width:"50%",className:"ellipsis",children:Object(u.nb)("Name")}),Object(b.jsx)("th",{width:"20%",children:Object(u.nb)("Size")}),Object(b.jsx)("th",{width:"22%",children:Object(u.nb)("Last Update")}),Object(b.jsx)("th",{width:"8%"})]})}),Object(b.jsx)("tbody",{children:t.map((function(t,n){return Object(b.jsx)(v,{repoID:e.props.repoID,taggedFile:t,onDeleteTaggedFile:e.onDeleteTaggedFile,shareLinkToken:e.props.shareLinkToken,enableFileDownload:e.props.enableFileDownload},n)}))})]})}),Object(b.jsx)(c.w,{children:Object(b.jsx)(c.c,{color:"secondary",onClick:this.props.toggleCancel,children:Object(u.nb)("Close")})})]})}}]),n}(l.a.Component);t.a=g;var v=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).onMouseEnter=function(){a.setState({active:!0})},a.onMouseLeave=function(){a.setState({active:!1})},a.deleteFile=function(e){e.preventDefault(),a.props.onDeleteTaggedFile(a.props.taggedFile)},a.state={active:!1},a}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props,t=e.taggedFile,n=e.shareLinkToken,i=e.enableFileDownload,a=t.parent_path?m.a.joinPath(t.parent_path,t.filename):"",r=n?u.mc+"d/"+n+"/files/?p="+m.a.encodePath(a):u.mc+"lib/"+this.props.repoID+"/file"+m.a.encodePath(a);return Object(b.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[t.file_deleted?Object(b.jsx)(s.Fragment,{children:Object(b.jsxs)("td",{colSpan:"3",className:"name",children:[t.filename," ",Object(b.jsx)("span",{style:{color:"red"},children:Object(u.nb)("deleted")})]})}):Object(b.jsxs)(s.Fragment,{children:[Object(b.jsx)("td",{children:Object(b.jsx)("a",{href:r,target:"_blank",className:"d-inline-block w-100 ellipsis",title:t.filename,rel:"noreferrer",children:t.filename})}),Object(b.jsx)("td",{children:m.a.bytesToSize(t.size)}),Object(b.jsx)("td",{children:h.a.unix(t.mtime).fromNow()})]}),Object(b.jsxs)("td",{children:[!n&&Object(b.jsx)("a",{href:"#",role:"button","aria-label":Object(u.nb)("Delete"),title:Object(u.nb)("Delete"),className:"action-icon sf2-icon-x3".concat(this.state.active?"":" invisible"),onClick:this.deleteFile}),n&&i&&Object(b.jsx)("a",{className:"action-icon sf2-icon-download".concat(this.state.active?"":" invisible"),href:"".concat(r,"&dl=1"),title:Object(u.nb)("Download"),"aria-label":Object(u.nb)("Download")})]})]})}}]),n}(l.a.Component)},233:function(e,t,n){"use strict";var i=n(6),a=n(7),r=n(9),o=n(8),s=n(2),l=n.n(s),c=n(18),d=n(232),h=n(4),u=n(1),p=n(10),m=n(12),f=n.n(m),b=n(86),g=n(11),v=n(5),j=Object(a.a)((function e(t){Object(i.a)(this,e),this.created=t.created_at,this.createdStr=f()(new Date(t.created_at).getTime()).format("YYYY-MM-DD HH:mm"),this.id=t.id,this.ownerNickname=t.owner_nickname,this.originRepoID=t.origin_repo_id,this.draftFilePath=t.draft_file_path})),O=n(0),y=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).onDeleteDraftItem=function(e){b.a.deleteDraft(e.id).then((function(){var t=a.state.drafts.filter((function(t){return t.id!==e.id}));a.setState({drafts:t});var n=Object(u.nb)("Successfully deleted draft %(draft)s.");n=n.replace("%(draft)s",e.draftFilePath),g.a.success(n)})).catch((function(){var t=Object(u.nb)("Failed to delete draft %(draft)s.");t=t.replace("%(draft)s",e.draftFilePath),g.a.danger(t)}))},a.toggle=function(){a.props.toggle()},a.state={drafts:[]},a}return Object(a.a)(n,[{key:"componentDidMount",value:function(){var e=this;p.b.listRepoDrafts(this.props.repoID).then((function(t){var n=t.data.drafts.map((function(e){return new j(e)}));e.setState({drafts:n})}))}},{key:"render",value:function(){var e=this;return Object(O.jsxs)(h.u,{isOpen:!0,children:[Object(O.jsx)(h.x,{toggle:this.toggle,children:Object(u.nb)("Drafts")}),Object(O.jsx)(h.v,{className:"dialog-list-container",children:Object(O.jsxs)("table",{children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{width:"50%",className:"ellipsis",children:Object(u.nb)("Name")}),Object(O.jsx)("th",{width:"20%",children:Object(u.nb)("Owner")}),Object(O.jsx)("th",{width:"20%",children:Object(u.nb)("Last Update")}),Object(O.jsx)("th",{width:"10%"})]})}),Object(O.jsx)("tbody",{children:this.state.drafts.map((function(t,n){return Object(O.jsx)(x,{draftItem:t,onDeleteDraftItem:e.onDeleteDraftItem},n)}))})]})}),Object(O.jsx)(h.w,{children:Object(O.jsx)(h.c,{color:"secondary",onClick:this.toggle,children:Object(u.nb)("Close")})})]})}}]),n}(l.a.Component),x=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).onMouseEnter=function(){a.setState({active:!0})},a.onMouseLeave=function(){a.setState({active:!1})},a.state={active:!1},a}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props.draftItem,t=u.mc+"drafts/"+e.id+"/",n=this.state.active?"action-icon sf2-icon-x3":"action-icon vh sf2-icon-x3";return Object(O.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[Object(O.jsx)("td",{className:"name",children:Object(O.jsx)("a",{href:t,target:"_blank",children:v.a.getFileName(e.draftFilePath)})}),Object(O.jsx)("td",{children:e.ownerNickname}),Object(O.jsx)("td",{children:f()(e.createdStr).fromNow()}),Object(O.jsx)("td",{children:Object(O.jsx)("i",{className:n,onClick:this.props.onDeleteDraftItem.bind(this,e)})})]})}}]),n}(l.a.Component),S=n(35),w=n(14),k=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={readmeContent:null,isLoading:!0},a}return Object(a.a)(n,[{key:"componentDidMount",value:function(){var e=this;p.b.getFileDownloadLink(this.props.repoID,this.props.filePath).then((function(t){p.b.getFileContent(t.data).then((function(t){e.setState({readmeContent:t.data,isLoading:!1})}))})).catch((function(e){var t=v.a.getErrorMsg(e);g.a.danger(t)}))}},{key:"render",value:function(){return Object(O.jsxs)(h.u,{isOpen:!0,toggle:this.props.toggleCancel,className:"readme-dialog",size:"lg",children:[Object(O.jsxs)(h.x,{children:[this.props.fileName,Object(O.jsx)("a",{className:"readme-dialog-edit",href:this.props.href,target:"_blank",children:Object(O.jsx)("i",{className:"fa fa-pencil-alt"})})]}),Object(O.jsx)(h.v,{children:this.state.isLoading?Object(O.jsx)(w.a,{}):Object(O.jsx)(S.d,{markdownContent:this.state.readmeContent,showTOC:!1,scriptSource:u.Lb+"js/mathjax/tex-svg.js"})}),Object(O.jsx)(h.w,{children:Object(O.jsx)(h.c,{color:"secondary",onClick:this.props.toggleCancel,children:Object(u.nb)("Close")})})]})}}]),n}(l.a.Component),C=(n(527),function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).onListTaggedFiles=function(e){a.setState({currentTag:e,isListTaggedFileShow:!a.state.isListTaggedFileShow})},a.onCloseDialog=function(){a.setState({isListTaggedFileShow:!1})},a.toggleDrafts=function(){a.setState({showRepoDrafts:!a.state.showRepoDrafts})},a.toggleReadme=function(){a.setState({showReadmeDialog:!a.state.showReadmeDialog})},a.state={currentTag:null,isListTaggedFileShow:!1,showRepoDrafts:!1,showReadmeDialog:!1},a}return Object(a.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.repoID,i=t.currentPath,a=t.usedRepoTags,r=t.readmeMarkdown,o=t.draftCounts,s=t.className;void 0===r&&(r=null),void 0===o&&(o=0);var l=null!==r?u.mc+"lib/"+n+"/file"+v.a.joinPath(i,r.name)+"?mode=edit":"",h=null!==r?i+r.name:"";return Object(O.jsxs)("div",{className:"repo-info-bar ".concat(s||""),children:[a.length>0&&Object(O.jsx)("ul",{className:"used-tag-list",children:a.map((function(t){return Object(O.jsxs)("li",{className:"used-tag-item",children:[Object(O.jsx)("span",{className:"used-tag",style:{backgroundColor:t.color}}),Object(O.jsx)("span",{className:"used-tag-name",title:t.name,children:t.name}),Object(O.jsx)("button",{type:"button",className:"used-tag-files border-0 bg-transparent",onClick:e.onListTaggedFiles.bind(e,t),children:t.fileCount>1?t.fileCount+" files":t.fileCount+" file"})]},t.id)}))}),Object(O.jsxs)("div",{className:a.length>0&&r?"file-info-list mt-1":"file-info-list",children:[null!==r&&parseInt(r.size)>1&&Object(O.jsxs)("span",{className:"file-info",onClick:this.toggleReadme,children:[Object(O.jsx)("span",{className:"info-icon sf2-icon-readme"}),Object(O.jsx)("span",{className:"used-tag-name",children:r.name})]}),null!==r&&parseInt(r.size)<2&&Object(O.jsxs)("span",{className:"file-info",children:[Object(O.jsx)("span",{className:"info-icon sf2-icon-readme"}),Object(O.jsx)("a",{className:"used-tag-name",href:l,target:"_blank",rel:"noreferrer",children:r.name})]}),o>0&&Object(O.jsxs)("span",{className:"file-info",children:[Object(O.jsx)("span",{className:"info-icon sf2-icon-drafts"}),Object(O.jsx)("span",{className:"used-tag-name",children:Object(u.nb)("draft")}),Object(O.jsx)("button",{type:"button",className:"used-tag-files border-0 bg-transparent",onClick:this.toggleDrafts,children:o>1?o+" files":o+" file"})]})]}),this.state.isListTaggedFileShow&&Object(O.jsx)(c.a,{children:Object(O.jsx)(d.a,{repoID:n,currentTag:this.state.currentTag,onClose:this.onCloseDialog,toggleCancel:this.onListTaggedFiles,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged,shareLinkToken:this.props.shareLinkToken,enableFileDownload:this.props.enableFileDownload})}),this.state.showRepoDrafts&&Object(O.jsx)(c.a,{children:Object(O.jsx)(y,{toggle:this.toggleDrafts,repoID:this.props.repoID})}),this.state.showReadmeDialog&&Object(O.jsx)(c.a,{children:Object(O.jsx)(k,{toggleCancel:this.toggleReadme,repoID:n,filePath:h,href:l,fileName:r.name})})]})}}]),n}(l.a.Component));t.a=C},349:function(e,t,n){"use strict";(function(e){var i=n(2),a=n.n(i),r=n(3),o=n.n(r),s=n(269),l=n.n(s);function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},u.apply(this,arguments)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var n=[],i=!0,a=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(l){a=!0,r=l}finally{try{i||null==s.return||s.return()}finally{if(a)throw r}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function j(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return"";var n=e;return t&&Object.keys(t).forEach((function(e){n=n.replace(e,t[e])})),n}function y(){return"undefined"!==typeof e.window?e.window.innerWidth:0}function x(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.window.self,n=t.document.referrer;if(t===e.window.top||!n)return t;var i=function(e){return e.match(/(.*\/\/.*?)(\/|$)/)[1]};return i(t.location.href)===i(n)?x(t.parent):t}var S=300,w=27,k=37,C=39,I=function(t){function n(e){var t,i,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),i=this,t=!(r=f(n).call(this,e))||"object"!==typeof r&&"function"!==typeof r?g(i):r,h(g(t),"handleWheel",(function(e){e.preventDefault()})),t.state={isClosing:!e.animationDisabled,shouldAnimate:!1,zoomLevel:0,offsetX:0,offsetY:0,loadErrorStatus:{}},t.outerEl=a.a.createRef(),t.zoomInBtn=a.a.createRef(),t.zoomOutBtn=a.a.createRef(),t.caption=a.a.createRef(),t.closeIfClickInner=t.closeIfClickInner.bind(g(t)),t.handleImageDoubleClick=t.handleImageDoubleClick.bind(g(t)),t.handleImageMouseWheel=t.handleImageMouseWheel.bind(g(t)),t.handleKeyInput=t.handleKeyInput.bind(g(t)),t.handleMouseUp=t.handleMouseUp.bind(g(t)),t.handleMouseDown=t.handleMouseDown.bind(g(t)),t.handleMouseMove=t.handleMouseMove.bind(g(t)),t.handleOuterMousewheel=t.handleOuterMousewheel.bind(g(t)),t.handleTouchStart=t.handleTouchStart.bind(g(t)),t.handleTouchMove=t.handleTouchMove.bind(g(t)),t.handleTouchEnd=t.handleTouchEnd.bind(g(t)),t.handlePointerEvent=t.handlePointerEvent.bind(g(t)),t.handleCaptionMousewheel=t.handleCaptionMousewheel.bind(g(t)),t.handleWindowResize=t.handleWindowResize.bind(g(t)),t.handleZoomInButtonClick=t.handleZoomInButtonClick.bind(g(t)),t.handleZoomOutButtonClick=t.handleZoomOutButtonClick.bind(g(t)),t.requestClose=t.requestClose.bind(g(t)),t.requestMoveNext=t.requestMoveNext.bind(g(t)),t.requestMovePrev=t.requestMovePrev.bind(g(t)),t}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(n,t),d(n,null,[{key:"isTargetMatchImage",value:function(e){return e&&/ril-image-current/.test(e.className)}},{key:"parseMouseEvent",value:function(e){return{id:"mouse",source:1,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parseTouchPointer",value:function(e){return{id:e.identifier,source:2,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parsePointerEvent",value:function(e){return{id:e.pointerId,source:3,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"getTransform",value:function(e){var t=e.x,n=void 0===t?0:t,i=e.y,a=void 0===i?0:i,r=e.zoom,o=void 0===r?1:r,s=e.width,l=e.targetWidth,c=n,d=y();s>d&&(c+=(d-s)/2);var h=o*(l/s);return{transform:"translate3d(".concat(c,"px,").concat(a,"px,0) scale3d(").concat(h,",").concat(h,",1)")}}}]),d(n,[{key:"UNSAFE_componentWillMount",value:function(){this.timeouts=[],this.currentAction=0,this.eventsSource=0,this.pointerList=[],this.preventInnerClose=!1,this.preventInnerCloseTimeout=null,this.keyPressed=!1,this.imageCache={},this.lastKeyDownTime=0,this.resizeTimeout=null,this.wheelActionTimeout=null,this.resetScrollTimeout=null,this.scrollX=0,this.scrollY=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,this.pinchTouchList=null,this.pinchDistance=0,this.keyCounter=0,this.moveRequested=!1,this.props.animationDisabled||this.setState({isClosing:!1})}},{key:"componentDidMount",value:function(){var e=this;this.windowContext=x(),this.listeners={resize:this.handleWindowResize,mouseup:this.handleMouseUp,touchend:this.handleTouchEnd,touchcancel:this.handleTouchEnd,pointerdown:this.handlePointerEvent,pointermove:this.handlePointerEvent,pointerup:this.handlePointerEvent,pointercancel:this.handlePointerEvent},Object.keys(this.listeners).forEach((function(t){e.windowContext.addEventListener(t,e.listeners[t])})),document.addEventListener("wheel",this.handleWheel,{passive:!1}),this.loadAllImages()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this,n=!1,i={},a={};this.getSrcTypes().forEach((function(r){t.props[r.name]!==e[r.name]&&(n=!0,i[t.props[r.name]]=!0,a[e[r.name]]=!0)})),(n||this.moveRequested)&&(Object.keys(i).forEach((function(e){!(e in a)&&e in t.imageCache&&(t.imageCache[e].loaded=!1)})),this.moveRequested=!1,this.loadAllImages(e))}},{key:"shouldComponentUpdate",value:function(){return!this.moveRequested}},{key:"componentWillUnmount",value:function(){var e=this;this.didUnmount=!0,Object.keys(this.listeners).forEach((function(t){e.windowContext.removeEventListener(t,e.listeners[t])})),document.removeEventListener("wheel",this.handleWheel,{passive:!1}),this.timeouts.forEach((function(e){return clearTimeout(e)}))}},{key:"setTimeout",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var n=this,i=setTimeout((function(){n.timeouts=n.timeouts.filter((function(e){return e!==i})),e()}),t);return this.timeouts.push(i),i}))},{key:"setPreventInnerClose",value:function(){var e=this;this.preventInnerCloseTimeout&&this.clearTimeout(this.preventInnerCloseTimeout),this.preventInnerClose=!0,this.preventInnerCloseTimeout=this.setTimeout((function(){e.preventInnerClose=!1,e.preventInnerCloseTimeout=null}),100)}},{key:"getBestImageForType",value:function(e){var t=this.props[e],n={};if(this.isImageLoaded(t))n=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height);else{if(!this.isImageLoaded(this.props["".concat(e,"Thumbnail")]))return null;t=this.props["".concat(e,"Thumbnail")],n=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height,!0)}return{src:t,height:this.imageCache[t].height,width:this.imageCache[t].width,targetHeight:n.height,targetWidth:n.width}}},{key:"getFitSizes",value:function(e,t,n){var i=this.getLightboxRect(),a=i.height-2*this.props.imagePadding,r=i.width-2*this.props.imagePadding;return n||(a=Math.min(a,t),r=Math.min(r,e)),r/a>e/t?{width:e*a/t,height:a}:{width:r,height:t*r/e}}},{key:"getMaxOffsets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel,t=this.getBestImageForType("mainSrc");if(null===t)return{maxX:0,minX:0,maxY:0,minY:0};var n=this.getLightboxRect(),i=this.getZoomMultiplier(e),a=0,r=0;return{maxX:a=i*t.width-n.width<0?(n.width-i*t.width)/2:(i*t.width-n.width)/2,maxY:r=i*t.height-n.height<0?(n.height-i*t.height)/2:(i*t.height-n.height)/2,minX:-1*a,minY:-1*r}}},{key:"getSrcTypes",value:function(){return[{name:"mainSrc",keyEnding:"i".concat(this.keyCounter)},{name:"mainSrcThumbnail",keyEnding:"t".concat(this.keyCounter)},{name:"nextSrc",keyEnding:"i".concat(this.keyCounter+1)},{name:"nextSrcThumbnail",keyEnding:"t".concat(this.keyCounter+1)},{name:"prevSrc",keyEnding:"i".concat(this.keyCounter-1)},{name:"prevSrcThumbnail",keyEnding:"t".concat(this.keyCounter-1)}]}},{key:"getZoomMultiplier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel;return Math.pow(1.007,e)}},{key:"getLightboxRect",value:function(){return this.outerEl.current?this.outerEl.current.getBoundingClientRect():{width:y(),height:"undefined"!==typeof e.window?e.window.innerHeight:0,top:0,right:0,bottom:0,left:0}}},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){this.timeouts=this.timeouts.filter((function(t){return t!==e})),clearTimeout(e)}))},{key:"changeZoom",value:function(e,t,n){if(this.props.enableZoom){var i=Math.max(0,Math.min(S,e));if(i!==this.state.zoomLevel)if(0!==i){var a=this.getBestImageForType("mainSrc");if(null!==a){var r=this.getZoomMultiplier(),o=this.getZoomMultiplier(i),s=this.getLightboxRect(),l="undefined"!==typeof t?t-s.left:s.width/2,c="undefined"!==typeof n?n-s.top:s.height/2,d=(s.width-a.width*r)/2,h=(s.height-a.height*r)/2,u=l-(l-(d-this.state.offsetX))/r*o,p=c-(c-(h-this.state.offsetY))/r*o,m=(s.width-a.width*o)/2-u,f=(s.height-a.height*o)/2-p;if(3!==this.currentAction){var b=this.getMaxOffsets();this.state.zoomLevel>i&&(m=Math.max(b.minX,Math.min(b.maxX,m)),f=Math.max(b.minY,Math.min(b.maxY,f)))}this.setState({zoomLevel:i,offsetX:m,offsetY:f})}}else this.setState({zoomLevel:i,offsetX:0,offsetY:0})}}},{key:"closeIfClickInner",value:function(e){!this.preventInnerClose&&e.target.className.search(/\bril-inner\b/)>-1&&this.requestClose(e)}},{key:"handleKeyInput",value:function(e){if(e.stopPropagation(),!this.isAnimating())if("keyup"!==e.type){var t=e.which||e.keyCode,n=new Date;if(!(n.getTime()-this.lastKeyDownTime<this.props.keyRepeatLimit&&t!==w))switch(this.lastKeyDownTime=n.getTime(),t){case w:e.preventDefault(),this.requestClose(e);break;case k:if(!this.props.prevSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMovePrev(e);break;case C:if(!this.props.nextSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMoveNext(e)}}else this.lastKeyDownTime-=this.props.keyRepeatKeyupBonus}},{key:"handleOuterMousewheel",value:function(e){var t=this;e.stopPropagation(),this.clearTimeout(this.resetScrollTimeout),this.resetScrollTimeout=this.setTimeout((function(){t.scrollX=0,t.scrollY=0}),300)}},{key:"handleImageMouseWheel",value:function(e){if(parseInt(e.deltaY)!==parseFloat(e.deltaY)){if(Math.abs(e.deltaY)>=Math.abs(e.deltaX)){if(e.stopPropagation(),Math.abs(e.deltaY)<1)return;this.scrollX=0,this.scrollY+=e.deltaY,this.changeZoom(this.state.zoomLevel-e.deltaY,e.clientX,e.clientY)}}else if(Math.abs(e.deltaY)>Math.abs(e.deltaX)){var t=this.state.offsetY+e.deltaY;this.setState({offsetY:t})}else{var n=this.state.offsetX+e.deltaX;this.setState({offsetX:n})}}},{key:"handleImageDoubleClick",value:function(e){this.state.zoomLevel>0?this.changeZoom(0,e.clientX,e.clientY):this.changeZoom(this.state.zoomLevel+100,e.clientX,e.clientY)}},{key:"shouldHandleEvent",value:function(e){if(this.eventsSource===e)return!0;if(0===this.eventsSource)return this.eventsSource=e,!0;switch(e){case 1:default:return!1;case 2:return this.eventsSource=2,this.filterPointersBySource(),!0;case 3:return 1===this.eventsSource&&(this.eventsSource=3,this.filterPointersBySource(),!0)}}},{key:"addPointer",value:function(e){this.pointerList.push(e)}},{key:"removePointer",value:function(e){this.pointerList=this.pointerList.filter((function(t){return t.id!==e.id}))}},{key:"filterPointersBySource",value:function(){var e=this;this.pointerList=this.pointerList.filter((function(t){return t.source===e.eventsSource}))}},{key:"handleMouseDown",value:function(e){this.shouldHandleEvent(1)&&n.isTargetMatchImage(e.target)&&(this.addPointer(n.parseMouseEvent(e)),this.multiPointerStart(e))}},{key:"handleMouseMove",value:function(e){this.shouldHandleEvent(1)&&this.multiPointerMove(e,[n.parseMouseEvent(e)])}},{key:"handleMouseUp",value:function(e){this.shouldHandleEvent(1)&&(this.removePointer(n.parseMouseEvent(e)),this.multiPointerEnd(e))}},{key:"handlePointerEvent",value:function(e){if(this.shouldHandleEvent(3))switch(e.type){case"pointerdown":n.isTargetMatchImage(e.target)&&(this.addPointer(n.parsePointerEvent(e)),this.multiPointerStart(e));break;case"pointermove":this.multiPointerMove(e,[n.parsePointerEvent(e)]);break;case"pointerup":case"pointercancel":this.removePointer(n.parsePointerEvent(e)),this.multiPointerEnd(e)}}},{key:"handleTouchStart",value:function(e){var t=this;this.shouldHandleEvent(2)&&n.isTargetMatchImage(e.target)&&([].forEach.call(e.changedTouches,(function(e){return t.addPointer(n.parseTouchPointer(e))})),this.multiPointerStart(e))}},{key:"handleTouchMove",value:function(e){this.shouldHandleEvent(2)&&this.multiPointerMove(e,[].map.call(e.changedTouches,(function(e){return n.parseTouchPointer(e)})))}},{key:"handleTouchEnd",value:function(e){var t=this;this.shouldHandleEvent(2)&&([].map.call(e.changedTouches,(function(e){return t.removePointer(n.parseTouchPointer(e))})),this.multiPointerEnd(e))}},{key:"decideMoveOrSwipe",value:function(e){this.state.zoomLevel<=0?this.handleSwipeStart(e):this.handleMoveStart(e)}},{key:"multiPointerStart",value:function(e){switch(this.handleEnd(null),this.pointerList.length){case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"multiPointerMove",value:function(e,t){switch(this.currentAction){case 1:e.preventDefault(),this.handleMove(t[0]);break;case 2:e.preventDefault(),this.handleSwipe(t[0]);break;case 3:e.preventDefault(),this.handlePinch(t)}}},{key:"multiPointerEnd",value:function(e){switch(0!==this.currentAction&&(this.setPreventInnerClose(),this.handleEnd(e)),this.pointerList.length){case 0:this.eventsSource=0;break;case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"handleEnd",value:function(e){switch(this.currentAction){case 1:this.handleMoveEnd(e);break;case 2:this.handleSwipeEnd(e);break;case 3:this.handlePinchEnd(e)}}},{key:"handleMoveStart",value:function(e){var t=e.x,n=e.y;this.props.enableZoom&&(this.currentAction=1,this.moveStartX=t,this.moveStartY=n,this.moveStartOffsetX=this.state.offsetX,this.moveStartOffsetY=this.state.offsetY)}},{key:"handleMove",value:function(e){var t=e.x,n=e.y,i=this.moveStartX-t+this.moveStartOffsetX,a=this.moveStartY-n+this.moveStartOffsetY;this.state.offsetX===i&&this.state.offsetY===a||this.setState({offsetX:i,offsetY:a})}},{key:"handleMoveEnd",value:function(){var e=this;this.currentAction=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0;var t=this.getMaxOffsets(),n=Math.max(t.minX,Math.min(t.maxX,this.state.offsetX)),i=Math.max(t.minY,Math.min(t.maxY,this.state.offsetY));n===this.state.offsetX&&i===this.state.offsetY||(this.setState({offsetX:n,offsetY:i,shouldAnimate:!0}),this.setTimeout((function(){e.setState({shouldAnimate:!1})}),this.props.animationDuration))}},{key:"handleSwipeStart",value:function(e){var t=e.x,n=e.y;this.currentAction=2,this.swipeStartX=t,this.swipeStartY=n,this.swipeEndX=t,this.swipeEndY=n}},{key:"handleSwipe",value:function(e){var t=e.x,n=e.y;this.swipeEndX=t,this.swipeEndY=n}},{key:"handleSwipeEnd",value:function(e){var t=this.swipeEndX-this.swipeStartX,n=Math.abs(t),i=Math.abs(this.swipeEndY-this.swipeStartY);if(this.currentAction=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,!(!e||this.isAnimating()||n<1.5*i)){if(n<200)if(n<this.getLightboxRect().width/4)return;t>0&&this.props.prevSrc?(e.preventDefault(),this.requestMovePrev()):t<0&&this.props.nextSrc&&(e.preventDefault(),this.requestMoveNext())}}},{key:"calculatePinchDistance",value:function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,2),t=e[0],n=e[1];return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}},{key:"calculatePinchCenter",value:function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,2),t=e[0],n=e[1];return{x:t.x-(t.x-n.x)/2,y:t.y-(t.y-n.y)/2}}},{key:"handlePinchStart",value:function(e){this.props.enableZoom&&(this.currentAction=3,this.pinchTouchList=e.map((function(e){return{id:e.id,x:e.x,y:e.y}})),this.pinchDistance=this.calculatePinchDistance())}},{key:"handlePinch",value:function(e){this.pinchTouchList=this.pinchTouchList.map((function(t){for(var n=0;n<e.length;n+=1)if(e[n].id===t.id)return e[n];return t}));var t=this.calculatePinchDistance(),n=this.state.zoomLevel+t-this.pinchDistance;this.pinchDistance=t;var i=this.calculatePinchCenter(this.pinchTouchList),a=i.x,r=i.y;this.changeZoom(n,a,r)}},{key:"handlePinchEnd",value:function(){this.currentAction=0,this.pinchTouchList=null,this.pinchDistance=0}},{key:"handleWindowResize",value:function(){this.clearTimeout(this.resizeTimeout),this.resizeTimeout=this.setTimeout(this.forceUpdate.bind(this),100)}},{key:"handleZoomInButtonClick",value:function(){var e=this.state.zoomLevel+100;this.changeZoom(e),e===S&&this.zoomOutBtn.current.focus()}},{key:"handleZoomOutButtonClick",value:function(){var e=this.state.zoomLevel-100;this.changeZoom(e),0===e&&this.zoomInBtn.current.focus()}},{key:"handleCaptionMousewheel",value:function(e){if(e.stopPropagation(),this.caption.current){var t=this.caption.current.getBoundingClientRect().height,n=this.caption.current,i=n.scrollHeight,a=n.scrollTop;(e.deltaY>0&&t+a>=i||e.deltaY<0&&a<=0)&&e.preventDefault()}}},{key:"isAnimating",value:function(){return this.state.shouldAnimate||this.state.isClosing}},{key:"isImageLoaded",value:function(e){return e&&e in this.imageCache&&this.imageCache[e].loaded}},{key:"loadImage",value:function(t,n,i){var a=this;if(this.isImageLoaded(n))this.setTimeout((function(){i()}),1);else{var r=new e.Image;this.props.imageCrossOrigin&&(r.crossOrigin=this.props.imageCrossOrigin),r.onerror=function(e){a.props.onImageLoadError(n,t,e),a.setState((function(e){return{loadErrorStatus:m({},e.loadErrorStatus,h({},t,!0))}})),i(e)},r.onload=function(){a.props.onImageLoad(n,t,r),a.imageCache[n]={loaded:!0,width:r.width,height:r.height},i()},r.src=n}}},{key:"loadAllImages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;this.getSrcTypes().forEach((function(n){var i=n.name;t[i]&&e.state.loadErrorStatus[i]&&e.setState((function(e){return{loadErrorStatus:m({},e.loadErrorStatus,h({},i,!1))}})),t[i]&&!e.isImageLoaded(t[i])&&e.loadImage(i,t[i],function(t,n){return function(i){i||e.props[t]!==n||e.didUnmount||e.forceUpdate()}}(i,t[i]))}))}},{key:"requestClose",value:function(e){var t=this,n=function(){return t.props.onCloseRequest(e)};this.props.animationDisabled||"keydown"===e.type&&!this.props.animationOnKeyInput?n():(this.setState({isClosing:!0}),this.setTimeout(n,this.props.animationDuration))}},{key:"requestMove",value:function(e,t){var n=this,i={zoomLevel:0,offsetX:0,offsetY:0};this.props.animationDisabled||this.keyPressed&&!this.props.animationOnKeyInput||(i.shouldAnimate=!0,this.setTimeout((function(){return n.setState({shouldAnimate:!1})}),this.props.animationDuration)),this.keyPressed=!1,this.moveRequested=!0,"prev"===e?(this.keyCounter-=1,this.setState(i),this.props.onMovePrevRequest(t)):(this.keyCounter+=1,this.setState(i),this.props.onMoveNextRequest(t))}},{key:"requestMoveNext",value:function(e){this.requestMove("next",e)}},{key:"requestMovePrev",value:function(e){this.requestMove("prev",e)}},{key:"render",value:function(){var t=this,i=this.props,r=i.animationDisabled,o=i.animationDuration,s=i.clickOutsideToClose,c=i.discourageDownloads,d=i.enableZoom,h=i.imageTitle,p=i.nextSrc,f=i.prevSrc,b=i.toolbarButtons,g=i.reactModalStyle,v=i.onAfterOpen,y=i.imageCrossOrigin,x=i.reactModalProps,w=this.state,k=w.zoomLevel,C=w.offsetX,I=w.offsetY,D=w.isClosing,M=w.loadErrorStatus,_=this.getLightboxRect(),F={};!r&&this.isAnimating()&&(F=m({},F,{transition:"transform ".concat(o,"ms")}));var L={};this.getSrcTypes().forEach((function(e){var t=e.name,n=e.keyEnding;L[t]=n}));var P=[],N=function(e,i,r){if(t.props[e]){var o=t.getBestImageForType(e),s=m({},F,{},n.getTransform(m({},r,{},o)));k>0&&(s.cursor="move");var l;if(null===o&&(l=M,Object.keys(l).some((function(e){return l[e]}))))P.push(a.a.createElement("div",{className:"".concat(i," ril__image ril-errored"),style:s,key:t.props[e]+L[e]},a.a.createElement("div",{className:"ril__errorContainer"},t.props.imageLoadErrorMessage)));else if(null!==o){var d=o.src;c?(s.backgroundImage="url('".concat(d,"')"),P.push(a.a.createElement("div",{className:"".concat(i," ril__image ril__imageDiscourager"),onDoubleClick:t.handleImageDoubleClick,onWheel:t.handleImageMouseWheel,style:s,key:d+L[e]},a.a.createElement("div",{className:"ril-download-blocker ril__downloadBlocker"})))):P.push(a.a.createElement("img",u({},y?{crossOrigin:y}:{},{className:"".concat(i," ril__image"),onDoubleClick:t.handleImageDoubleClick,onWheel:t.handleImageMouseWheel,onDragStart:function(e){return e.preventDefault()},style:s,src:d,key:d+L[e],alt:"string"===typeof h?h:O("Image"),draggable:!1})))}else{var p=a.a.createElement("div",{className:"ril-loading-circle ril__loadingCircle ril__loadingContainer__icon"},j(new Array(12)).map((function(e,t){return a.a.createElement("div",{key:t,className:"ril-loading-circle-point ril__loadingCirclePoint"})})));P.push(a.a.createElement("div",{className:"".concat(i," ril__image ril-not-loaded"),style:s,key:t.props[e]+L[e]},a.a.createElement("div",{className:"ril__loadingContainer"},p)))}}},T=this.getZoomMultiplier();N("nextSrc","ril-image-next ril__imageNext",{x:_.width}),N("mainSrc","ril-image-current",{x:-1*C,y:-1*I,zoom:T}),N("prevSrc","ril-image-prev ril__imagePrev",{x:-1*_.width});var E={overlay:m({zIndex:1e3,backgroundColor:"transparent"},g.overlay),content:m({backgroundColor:"transparent",overflow:"hidden",border:"none",borderRadius:0,padding:0,top:0,left:0,right:0,bottom:0},g.content)};return a.a.createElement(l.a,u({isOpen:!0,onRequestClose:s?this.requestClose:void 0,onAfterOpen:function(){t.outerEl.current&&t.outerEl.current.focus(),v()},style:E,contentLabel:O("Lightbox"),appElement:"undefined"!==typeof e.window?e.window.document.body:void 0},x),a.a.createElement("div",{className:"ril-outer ril__outer ril__outerAnimating ".concat(this.props.wrapperClassName," ").concat(D?"ril-closing ril__outerClosing":""),style:{transition:"opacity ".concat(o,"ms"),animationDuration:"".concat(o,"ms"),animationDirection:D?"normal":"reverse"},ref:this.outerEl,onWheel:this.handleOuterMousewheel,onMouseMove:this.handleMouseMove,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,tabIndex:"-1",onKeyDown:this.handleKeyInput,onKeyUp:this.handleKeyInput},a.a.createElement("div",{className:"ril-inner ril__inner",onClick:s?this.closeIfClickInner:void 0},P),f&&a.a.createElement("button",{type:"button",className:"ril-prev-button ril__navButtons ril__navButtonPrev",key:"prev","aria-label":this.props.prevLabel,onClick:this.isAnimating()?void 0:this.requestMovePrev}),p&&a.a.createElement("button",{type:"button",className:"ril-next-button ril__navButtons ril__navButtonNext",key:"next","aria-label":this.props.nextLabel,onClick:this.isAnimating()?void 0:this.requestMoveNext}),a.a.createElement("div",{className:"ril-toolbar ril__toolbar"},a.a.createElement("ul",{className:"ril-toolbar-left ril__toolbarSide ril__toolbarLeftSide"},a.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},a.a.createElement("span",{className:"ril-toolbar__item__child ril__toolbarItemChild"},h))),a.a.createElement("ul",{className:"ril-toolbar-right ril__toolbarSide ril__toolbarRightSide"},b&&b.map((function(e,t){return a.a.createElement("li",{key:"button_".concat(t+1),className:"ril-toolbar__item ril__toolbarItem"},e)})),d&&a.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},a.a.createElement("button",{type:"button",key:"zoom-in","aria-label":this.props.zoomInLabel,className:["ril-zoom-in","ril__toolbarItemChild","ril__builtinButton","ril__zoomInButton"].concat(j(k===S?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomInBtn,disabled:this.isAnimating()||k===S,onClick:this.isAnimating()||k===S?void 0:this.handleZoomInButtonClick})),d&&a.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},a.a.createElement("button",{type:"button",key:"zoom-out","aria-label":this.props.zoomOutLabel,className:["ril-zoom-out","ril__toolbarItemChild","ril__builtinButton","ril__zoomOutButton"].concat(j(0===k?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomOutBtn,disabled:this.isAnimating()||0===k,onClick:this.isAnimating()||0===k?void 0:this.handleZoomOutButtonClick})),a.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},a.a.createElement("button",{type:"button",key:"close","aria-label":this.props.closeLabel,className:"ril-close ril-toolbar__item__child ril__toolbarItemChild ril__builtinButton ril__closeButton",onClick:this.isAnimating()?void 0:this.requestClose})))),this.props.imageCaption&&a.a.createElement("div",{onWheel:this.handleCaptionMousewheel,onMouseDown:function(e){return e.stopPropagation()},className:"ril-caption ril__caption",ref:this.caption},a.a.createElement("div",{className:"ril-caption-content ril__captionContent"},this.props.imageCaption))))}}]),n}(i.Component);I.propTypes={mainSrc:o.a.string.isRequired,prevSrc:o.a.string,nextSrc:o.a.string,mainSrcThumbnail:o.a.string,prevSrcThumbnail:o.a.string,nextSrcThumbnail:o.a.string,onCloseRequest:o.a.func.isRequired,onMovePrevRequest:o.a.func,onMoveNextRequest:o.a.func,onImageLoadError:o.a.func,onImageLoad:o.a.func,onAfterOpen:o.a.func,discourageDownloads:o.a.bool,animationDisabled:o.a.bool,animationOnKeyInput:o.a.bool,animationDuration:o.a.number,keyRepeatLimit:o.a.number,keyRepeatKeyupBonus:o.a.number,imageTitle:o.a.node,imageCaption:o.a.node,imageCrossOrigin:o.a.string,reactModalStyle:o.a.object,imagePadding:o.a.number,wrapperClassName:o.a.string,toolbarButtons:o.a.arrayOf(o.a.node),clickOutsideToClose:o.a.bool,enableZoom:o.a.bool,reactModalProps:o.a.shape({}),nextLabel:o.a.string,prevLabel:o.a.string,zoomInLabel:o.a.string,zoomOutLabel:o.a.string,closeLabel:o.a.string,imageLoadErrorMessage:o.a.node},I.defaultProps={imageTitle:null,imageCaption:null,toolbarButtons:null,reactModalProps:{},animationDisabled:!1,animationDuration:300,animationOnKeyInput:!1,clickOutsideToClose:!0,closeLabel:"Close lightbox",discourageDownloads:!1,enableZoom:!0,imagePadding:10,imageCrossOrigin:null,keyRepeatKeyupBonus:40,keyRepeatLimit:180,mainSrcThumbnail:null,nextLabel:"Next image",nextSrc:null,nextSrcThumbnail:null,onAfterOpen:function(){},onImageLoadError:function(){},onImageLoad:function(){},onMoveNextRequest:function(){},onMovePrevRequest:function(){},prevLabel:"Previous image",prevSrc:null,prevSrcThumbnail:null,reactModalStyle:{},wrapperClassName:"",zoomInLabel:"Zoom in",zoomOutLabel:"Zoom out",imageLoadErrorMessage:"This image failed to load"},t.a=I}).call(this,n(66))},350:function(e,t,n){"use strict";var i=n(6),a=n(7),r=n(9),o=n(8),s=n(2),l=n.n(s),c=n(4),d=n(1),h=n(0),u=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.asyncOperationProgress,i=e.asyncOperatedFilesLength,a="move"===t?Object(d.nb)("Move {num} items"):Object(d.nb)("Copy {num} items");a=a.replace("{num}",i);var r={width:n+"%",lineHeight:"40px",textAlign:"left"};return Object(h.jsxs)(c.u,{isOpen:!0,children:[Object(h.jsx)(c.x,{toggle:this.props.toggleDialog,children:a}),Object(h.jsx)(c.v,{style:{minHeight:"80px"},children:Object(h.jsx)("div",{className:"progress",style:{height:"40px"},children:Object(h.jsx)("div",{className:"progress-bar pl-2",role:"progressbar",style:r,"aria-valuenow":n,"aria-valuemin":"0","aria-valuemax":"100",children:n+"%"})})})]})}}]),n}(l.a.Component);t.a=u},527:function(e,t,n){},528:function(e,t,n){},529:function(e,t,n){}},[[1688,1,0]]]);
//# sourceMappingURL=sharedDirView.chunk.js.map