{"version":3,"sources":["components/dialog/edit-repo-commit-labels.js","repo-history.js","components/dialog/commit-details.js"],"names":["UpdateRepoCommitLabels","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","handleInputChange","value","setState","inputValue","formSubmit","labels","state","map","item","index","join","_this$props","repoID","commitID","submitBtnDisabled","seafileAPI","updateRepoCommitLabels","then","res","updateCommitLabels","data","revisionTags","tag","toggleDialog","toaster","success","gettext","catch","error","errorMsg","Utils","getErrorMsg","formErrorMsg","commitLabels","label","_createClass","key","this","_jsxs","Modal","isOpen","centered","toggle","children","_jsx","ModalHeader","ModalBody","React","Fragment","CreatableSelect","defaultValue","isMulti","onChange","placeholder","className","ModalFooter","disabled","onClick","Component","_window$app$pageOptio","window","app","pageOptions","repoName","userPerm","showLabel","RepoHistory","getItems","page","getRepoHistory","perPage","isLoading","currentPage","items","hasNextPage","more","resetPerPage","onSearchedClick","selectedItem","is_dir","url","siteRoot","repo_id","repo_name","path","navigate","repalce","encodePath","open","location","href","goBack","e","preventDefault","history","back","_this2","urlParams","URL","searchParams","_this$state","parseInt","get","src","mediaUrl","logoPath","height","logoHeight","width","logoWidth","title","siteTitle","alt","CommonToolbar","generateDialogTitle","role","Content","curPerPage","getListByPage","_React$Component2","_super2","_this3","getPreviousPage","getNextPage","theadData","text","concat","Loading","isFirstCommit","showDetails","length","Item","Paginator","gotoPreviousPage","gotoNextPage","_React$Component3","_super3","_this4","handleMouseOver","isIconShown","handleMouseOut","showCommitDetails","isCommitDetailsDialogOpen","toggleCommitDetailsDialog","editLabel","isCommitLabelUpdateDialogOpen","toggleLabelEditDialog","updateLabels","tags","_this$state2","name","email","second_parent_id","encodeURIComponent","onMouseOver","onMouseOut","onFocus","description","moment","time","format","client_version","device_name","commit_id","ModalPortal","CommitDetails","commitTime","ReactDom","render","document","getElementById","getCommitDetails","commitDetails","_this$props2","_len","arguments","args","Array","_key","apply","renderDetails","detailsData","type","showDesc","i","len","cmt_desc","dangerouslySetInnerHTML","__html","_this$props$data"],"mappings":"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","file":"static/js/repoHistory.chunk.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport CreatableSelect from 'react-select/creatable';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  commitID: PropTypes.string.isRequired,\n  commitLabels: PropTypes.array.isRequired,\n  updateCommitLabels: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass UpdateRepoCommitLabels extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      inputValue: this.props.commitLabels.map((item, index) => {\n        return {label: item, value: item};\n      }),\n      submitBtnDisabled: false\n    };\n  }\n\n  handleInputChange = (value) => {\n    this.setState({\n      inputValue: value\n    });\n  }\n\n  formSubmit = () => {\n    const inputValue = this.state.inputValue;\n    const labels = inputValue.map((item, index) => item.value).join(',');\n    const {repoID, commitID} = this.props;\n\n    this.setState({\n      submitBtnDisabled: true\n    });\n\n    seafileAPI.updateRepoCommitLabels(repoID, commitID, labels).then((res) => {\n      this.props.updateCommitLabels(res.data.revisionTags.map((item, index) => item.tag));\n      this.props.toggleDialog();\n      toaster.success(gettext('Successfully edited labels.'));\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        formErrorMsg: errorMsg,\n        submitBtnDisabled: false\n      });\n    });\n  }\n\n  render() {\n    const { formErrorMsg } = this.state;\n    return (\n      <Modal isOpen={true} centered={true} toggle={this.props.toggleDialog}>\n        <ModalHeader toggle={this.props.toggleDialog}>{gettext('Edit labels')}</ModalHeader>\n        <ModalBody>\n          <React.Fragment>\n            <CreatableSelect\n              defaultValue={this.props.commitLabels.map((item, index) => { return {label: item, value: item}; })}\n              isMulti={true}\n              onChange={this.handleInputChange}\n              placeholder=''\n            />\n            {formErrorMsg && <p className=\"error m-0 mt-2\">{formErrorMsg}</p>}\n          </React.Fragment>\n        </ModalBody>\n        <ModalFooter>\n          <button className=\"btn btn-primary\" disabled={this.state.submitBtnDisabled} onClick={this.formSubmit}>{gettext('Submit')}</button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nUpdateRepoCommitLabels.propTypes = propTypes;\n\nexport default UpdateRepoCommitLabels;\n","import React from 'react';\nimport ReactDom from 'react-dom';\nimport { navigate } from '@gatsbyjs/reach-router';\nimport moment from 'moment';\nimport { Utils } from './utils/utils';\nimport { gettext, siteRoot, mediaUrl, logoPath, logoWidth, logoHeight, siteTitle } from './utils/constants';\nimport { seafileAPI } from './utils/seafile-api';\nimport Loading from './components/loading';\nimport Paginator from './components/paginator';\nimport ModalPortal from './components/modal-portal';\nimport CommonToolbar from './components/toolbar/common-toolbar';\nimport CommitDetails from './components/dialog/commit-details';\nimport UpdateRepoCommitLabels from './components/dialog/edit-repo-commit-labels';\n\nimport './css/toolbar.css';\nimport './css/search.css';\n\nimport './css/repo-history.css';\n\nconst {\n  repoID,\n  repoName,\n  userPerm,\n  showLabel\n} = window.app.pageOptions;\n\nclass RepoHistory extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errorMsg: '',\n      currentPage: 1,\n      perPage: 25,\n      hasNextPage: false,\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    let urlParams = (new URL(window.location)).searchParams;\n    const {\n      currentPage, perPage\n    } = this.state;\n    this.setState({\n      perPage: parseInt(urlParams.get('per_page') || perPage),\n      currentPage: parseInt(urlParams.get('page') || currentPage)\n    }, () => {\n      this.getItems(this.state.currentPage);\n    });\n  }\n\n  getItems = (page) => {\n    seafileAPI.getRepoHistory(repoID, page, this.state.perPage).then((res) => {\n      this.setState({\n        isLoading: false,\n        currentPage: page,\n        items: res.data.data,\n        hasNextPage: res.data.more\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  resetPerPage = (perPage) => {\n    this.setState({\n      perPage: perPage\n    }, () => {\n      this.getItems(1);\n    });\n  }\n\n  onSearchedClick = (selectedItem) => {\n    if (selectedItem.is_dir === true) {\n      let url = siteRoot + 'library/' + selectedItem.repo_id + '/' + selectedItem.repo_name + selectedItem.path;\n      navigate(url, {repalce: true});\n    } else {\n      let url = siteRoot + 'lib/' + selectedItem.repo_id + '/file' + Utils.encodePath(selectedItem.path);\n      let newWindow = window.open('about:blank');\n      newWindow.location.href = url;\n    }\n  }\n\n  goBack = (e) => {\n    e.preventDefault();\n    window.history.back();\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        <div className=\"h-100 d-flex flex-column\">\n          <div className=\"top-header d-flex justify-content-between\">\n            <a href={siteRoot}>\n              <img src={mediaUrl + logoPath} height={logoHeight} width={logoWidth} title={siteTitle} alt=\"logo\" />\n            </a>\n            <CommonToolbar onSearchedClick={this.onSearchedClick} />\n          </div>\n          <div className=\"flex-auto container-fluid pt-4 pb-6 o-auto\">\n            <div className=\"row\">\n              <div className=\"col-md-10 offset-md-1\">\n                <h2>{Utils.generateDialogTitle(gettext('{placeholder} Modification History'), repoName)}</h2>\n                <a href=\"#\" className=\"go-back\" title={gettext('Back')} onClick={this.goBack} role=\"button\" aria-label={gettext('Back')}>\n                  <span className=\"fas fa-chevron-left\"></span>\n                </a>\n                {userPerm == 'rw' && <p className=\"tip\">{gettext('Tip: a snapshot will be generated after modification, which records the library state after the modification.')}</p>}\n                <Content\n                  isLoading={this.state.isLoading}\n                  errorMsg={this.state.errorMsg}\n                  items={this.state.items}\n                  currentPage={this.state.currentPage}\n                  hasNextPage={this.state.hasNextPage}\n                  curPerPage={this.state.perPage}\n                  resetPerPage={this.resetPerPage}\n                  getListByPage={this.getItems}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nclass Content extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.theadData = showLabel ? [\n      {width: '43%', text: gettext('Description')},\n      {width: '12%', text: gettext('Time')},\n      {width: '9%', text: gettext('Modifier')},\n      {width: '12%', text: `${gettext('Device')} / ${gettext('Version')}`},\n      {width: '12%', text: gettext('Labels')},\n      {width: '12%', text: ''}\n    ] : [\n      {width: '43%', text: gettext('Description')},\n      {width: '15%', text: gettext('Time')},\n      {width: '15%', text: gettext('Modifier')},\n      {width: '15%', text: `${gettext('Device')} / ${gettext('Version')}`},\n      {width: '12%', text: ''}\n    ];\n  }\n\n  getPreviousPage = () => {\n    this.props.getListByPage(this.props.currentPage - 1);\n  }\n\n  getNextPage = () => {\n    this.props.getListByPage(this.props.currentPage + 1);\n  }\n\n  render() {\n    const {\n      isLoading, errorMsg, items,\n      curPerPage, currentPage, hasNextPage\n    } = this.props;\n\n    if (isLoading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error mt-6 text-center\">{errorMsg}</p>;\n    }\n\n    return (\n      <React.Fragment>\n        <table className=\"table-hover\">\n          <thead>\n            <tr>\n              {this.theadData.map((item, index) => {\n                return <th key={index} width={item.width}>{item.text}</th>;\n              })}\n            </tr>\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              item.isFirstCommit = (currentPage == 1) && (index == 0);\n              item.showDetails = hasNextPage || (index != items.length - 1);\n              return <Item key={index} item={item} />;\n            })}\n          </tbody>\n        </table>\n        <Paginator\n          gotoPreviousPage={this.getPreviousPage}\n          gotoNextPage={this.getNextPage}\n          currentPage={currentPage}\n          hasNextPage={hasNextPage}\n          curPerPage={curPerPage}\n          resetPerPage={this.props.resetPerPage}\n        />\n      </React.Fragment>\n    );\n  }\n}\n\nclass Item extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      labels: this.props.item.tags,\n      isIconShown: false,\n      isCommitLabelUpdateDialogOpen: false,\n      isCommitDetailsDialogOpen: false\n    };\n  }\n\n  handleMouseOver = () => {\n    this.setState({isIconShown: true});\n  }\n\n  handleMouseOut = () => {\n    this.setState({isIconShown: false});\n  }\n\n  showCommitDetails = (e) => {\n    e.preventDefault();\n    this.setState({\n      isCommitDetailsDialogOpen: !this.state.isCommitDetailsDialogOpen\n    });\n  }\n\n  toggleCommitDetailsDialog = () => {\n    this.setState({\n      isCommitDetailsDialogOpen: !this.state.isCommitDetailsDialogOpen\n    });\n  }\n\n  editLabel = (e) => {\n    e.preventDefault();\n    this.setState({\n      isCommitLabelUpdateDialogOpen: !this.state.isCommitLabelUpdateDialogOpen\n    });\n  }\n\n  toggleLabelEditDialog = () => {\n    this.setState({\n      isCommitLabelUpdateDialogOpen: !this.state.isCommitLabelUpdateDialogOpen\n    });\n  }\n\n  updateLabels = (labels) => {\n    this.setState({\n      labels: labels\n    });\n  }\n\n  render() {\n    const item = this.props.item;\n    const { isIconShown, isCommitLabelUpdateDialogOpen, isCommitDetailsDialogOpen, labels } = this.state;\n\n    let name = '';\n    if (item.email) {\n      if (!item.second_parent_id) {\n        name = <a href={`${siteRoot}profile/${encodeURIComponent(item.email)}/`}>{item.name}</a>;\n      } else {\n        name = gettext('None');\n      }\n    } else {\n      name = gettext('Unknown');\n    }\n\n    return (\n      <React.Fragment>\n        <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n          <td>\n            {item.description}\n            {item.showDetails &&\n            <a href=\"#\" className=\"details\" onClick={this.showCommitDetails} role=\"button\">{gettext('Details')}</a>\n            }\n          </td>\n          <td title={moment(item.time).format('LLLL')}>{moment(item.time).format('YYYY-MM-DD')}</td>\n          <td>{name}</td>\n          <td>\n            {item.client_version ? `${item.device_name} / ${item.client_version}` : 'API / --'}\n          </td>\n          {showLabel &&\n          <td>\n            {labels.map((item, index) => {\n              return <span key={index} className=\"commit-label\">{item}</span>;\n            })}\n            {userPerm == 'rw' &&\n            <a href=\"#\" role=\"button\" className={`attr-action-icon fa fa-pencil-alt ${isIconShown ? '': 'invisible'}`} title={gettext('Edit')} aria-label={gettext('Edit')} onClick={this.editLabel}></a>\n            }\n          </td>\n          }\n          <td>\n            {userPerm == 'rw' && (\n              item.isFirstCommit ?\n                <span className={isIconShown ? '': 'invisible'}>{gettext('Current Version')}</span> :\n                <a href={`${siteRoot}repo/${repoID}/snapshot/?commit_id=${item.commit_id}`} className={isIconShown ? '': 'invisible'}>{gettext('View Snapshot')}</a>\n            )}\n          </td>\n        </tr>\n        {isCommitDetailsDialogOpen &&\n          <ModalPortal>\n            <CommitDetails\n              repoID={repoID}\n              commitID={item.commit_id}\n              commitTime={item.time}\n              toggleDialog={this.toggleCommitDetailsDialog}\n            />\n          </ModalPortal>\n        }\n        {isCommitLabelUpdateDialogOpen &&\n          <ModalPortal>\n            <UpdateRepoCommitLabels\n              repoID={repoID}\n              commitID={item.commit_id}\n              commitLabels={labels}\n              updateCommitLabels={this.updateLabels}\n              toggleDialog={this.toggleLabelEditDialog}\n            />\n          </ModalPortal>\n        }\n      </React.Fragment>\n    );\n  }\n}\n\nReactDom.render(<RepoHistory />, document.getElementById('wrapper'));\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody } from 'reactstrap';\nimport moment from 'moment';\nimport { gettext, fileServerRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../loading';\n\nimport '../../css/commit-details.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  commitID: PropTypes.string.isRequired,\n  commitTime: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass CommitDetails extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errorMsg: '',\n    };\n  }\n\n  componentDidMount() {\n    const {repoID, commitID} = this.props;\n    seafileAPI.getCommitDetails(repoID, commitID).then((res) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: '',\n        commitDetails: res.data\n      });\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errorMsg\n      });\n    });\n  }\n\n  render() {\n    const { toggleDialog, commitTime} = this.props;\n    return (\n      <Modal isOpen={true} centered={true} toggle={toggleDialog}>\n        <ModalHeader toggle={toggleDialog}>{gettext('Modification Details')}</ModalHeader>\n        <ModalBody>\n          <p className=\"small\">{moment(this.props.commitTime).format('YYYY-MM-DD HH:mm:ss')}</p>\n          <Content data={this.state} />\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nclass Content extends React.Component {\n\n  renderDetails = (data) => {\n    const detailsData = [\n      {type: 'new', title: gettext('New files')},\n      {type: 'removed', title: gettext('Deleted files')},\n      {type: 'renamed', title: gettext('Renamed or Moved files')},\n      {type: 'modified', title: gettext('Modified files')},\n      {type: 'newdir', title: gettext('New directories')},\n      {type: 'deldir', title: gettext('Deleted directories')}\n    ];\n\n    let showDesc = true;\n    for (let i = 0, len = detailsData.length; i < len; i++) {\n      if (data[detailsData[i].type].length) {\n        showDesc = false;\n        break;\n      }\n    }\n    if (showDesc) {\n      return <p>{data.cmt_desc}</p>;\n    }\n\n    return (\n      <React.Fragment>\n        {detailsData.map((item, index) => {\n          if (!data[item.type].length) {\n            return;\n          }\n          return (\n            <React.Fragment key={index}>\n              <h6>{item.title}</h6>\n              <ul>\n                {\n                  data[item.type].map((item, index) => {\n                    return <li key={index} dangerouslySetInnerHTML={{__html: item}} className=\"commit-detail-item\"></li>;\n                  })\n                }\n              </ul>\n            </React.Fragment>\n          );\n        })}\n      </React.Fragment>\n    );\n  }\n\n  render() {\n    const {isLoading, errorMsg, commitDetails} = this.props.data;\n\n    if (isLoading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error mt-4 text-center\">{errorMsg}</p>;\n    }\n\n    return this.renderDetails(commitDetails);\n  }\n}\n\nCommitDetails.propTypes = propTypes;\n\nexport default CommitDetails;\n"],"sourceRoot":""}